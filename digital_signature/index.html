<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>无处不在的数字签名 | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="无处不在的数字签名"><meta property="og:description" content="一、为什么需要数字签名？ 从上一篇文章里面我们知道，消息认证码可以识别篡改或者发送者身份是否被伪装，也就是验证消息的完整性，还可以对消息进行认证。但是消息认证码的缺陷就在于它的共享密钥上面。由于共享密钥的原因，导致无法防止抵赖。
数字签名就是为了解决抵赖的问题的。解决的方法就是让通信双方的共享密钥不同，从密钥上能区分出谁是谁。
二、什么是数字签名？ 数字签名相当于现实世界中的盖章、签名的功能在计算机世界中进行实现的技术。数字签名可以识别篡改、伪装、防止抵赖。
在数字签名中，有 2 种行为：
 生成消息签名的行为 验证消息签名的行为  生成消息签名的人是由消息发送者完成的，也称为“对消息签名”。生成签名就是根据消息内容计算数字签名的值。
验证数字签名的人是第三方。第三方验证消息的来源是否属于发送者。验证结果可以是成功，也可以是失败。
数字签名对签名密钥和验证密钥进行了区分，使用验证密钥是无法生成签名的。签名密钥只能由签名人持有，而验证密钥则是任何需要验证签名的人都可以持有。
    私钥 公钥     公钥密钥 接收者解密时使用 发送者加密时使用   数字签名 签名者生成签名时使用 验证者验证签名时使用   谁持有密钥？ 个人持有 只要需要，任何人都可以持有    严格的来说，RSA 算法中公钥加密和数字签名正好是完全相反的关系，但是在其他公钥算法中有可能和数字签名不是完全相反的关系。
在公钥算法中，公钥用来加密，私钥用来解密。
在数字签名中，公钥用来解密(验证签名)，私钥用来加密(生成签名)。
三、生成和验证数字签名 有两种生成和验证数字签名的方法：
 直接对消息签名的方法 对消息的散列值签名的方法  1. 直接对消息签名的方法 2. 对消息的散列值签名的方法 比较上面 2 种方法，一般都会使用第 2 种方法。原因是因为第 1 种方法要对整个消息进行加密，而且是公钥密钥算法，非常耗时。利用简短的单向散列函数来替代消息本身。再进行加密(对消息进行签名)，会快很多。
对上面的 2 种方法，有一些共性的问题进行解释：
  为什么加密以后的密文能够具备签名的意义？
 数字签名是利用了 “没有私钥的人就无法生成使用该私钥所生成的密文” 这一性质来实现的。生成的密文并非是用于保证机密性，而是用于代表一种只有持有该密钥的人才能生成的信息。所以私钥产生的密文是一种认证符号(authenticator)。    上面方法 2 中消息没有加密就直接发送了，这样不就没法保证消息的机密性了么？"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/digital_signature/"><meta property="article:published_time" content="2018-09-08T13:01:00+00:00"><meta property="article:modified_time" content="2018-09-08T13:01:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="无处不在的数字签名"><meta name=twitter:description content="一、为什么需要数字签名？ 从上一篇文章里面我们知道，消息认证码可以识别篡改或者发送者身份是否被伪装，也就是验证消息的完整性，还可以对消息进行认证。但是消息认证码的缺陷就在于它的共享密钥上面。由于共享密钥的原因，导致无法防止抵赖。
数字签名就是为了解决抵赖的问题的。解决的方法就是让通信双方的共享密钥不同，从密钥上能区分出谁是谁。
二、什么是数字签名？ 数字签名相当于现实世界中的盖章、签名的功能在计算机世界中进行实现的技术。数字签名可以识别篡改、伪装、防止抵赖。
在数字签名中，有 2 种行为：
 生成消息签名的行为 验证消息签名的行为  生成消息签名的人是由消息发送者完成的，也称为“对消息签名”。生成签名就是根据消息内容计算数字签名的值。
验证数字签名的人是第三方。第三方验证消息的来源是否属于发送者。验证结果可以是成功，也可以是失败。
数字签名对签名密钥和验证密钥进行了区分，使用验证密钥是无法生成签名的。签名密钥只能由签名人持有，而验证密钥则是任何需要验证签名的人都可以持有。
    私钥 公钥     公钥密钥 接收者解密时使用 发送者加密时使用   数字签名 签名者生成签名时使用 验证者验证签名时使用   谁持有密钥？ 个人持有 只要需要，任何人都可以持有    严格的来说，RSA 算法中公钥加密和数字签名正好是完全相反的关系，但是在其他公钥算法中有可能和数字签名不是完全相反的关系。
在公钥算法中，公钥用来加密，私钥用来解密。
在数字签名中，公钥用来解密(验证签名)，私钥用来加密(生成签名)。
三、生成和验证数字签名 有两种生成和验证数字签名的方法：
 直接对消息签名的方法 对消息的散列值签名的方法  1. 直接对消息签名的方法 2. 对消息的散列值签名的方法 比较上面 2 种方法，一般都会使用第 2 种方法。原因是因为第 1 种方法要对整个消息进行加密，而且是公钥密钥算法，非常耗时。利用简短的单向散列函数来替代消息本身。再进行加密(对消息进行签名)，会快很多。
对上面的 2 种方法，有一些共性的问题进行解释：
  为什么加密以后的密文能够具备签名的意义？
 数字签名是利用了 “没有私钥的人就无法生成使用该私钥所生成的密文” 这一性质来实现的。生成的密文并非是用于保证机密性，而是用于代表一种只有持有该密钥的人才能生成的信息。所以私钥产生的密文是一种认证符号(authenticator)。    上面方法 2 中消息没有加密就直接发送了，这样不就没法保证消息的机密性了么？"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/message_authentication_code/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/digital_certificate/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&text=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&is_video=false&description=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&name=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d&description=%e4%b8%80%e3%80%81%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%ef%bc%9f%20%e4%bb%8e%e4%b8%8a%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e9%87%8c%e9%9d%a2%e6%88%91%e4%bb%ac%e7%9f%a5%e9%81%93%ef%bc%8c%e6%b6%88%e6%81%af%e8%ae%a4%e8%af%81%e7%a0%81%e5%8f%af%e4%bb%a5%e8%af%86%e5%88%ab%e7%af%a1%e6%94%b9%e6%88%96%e8%80%85%e5%8f%91%e9%80%81%e8%80%85%e8%ba%ab%e4%bb%bd%e6%98%af%e5%90%a6%e8%a2%ab%e4%bc%aa%e8%a3%85%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e5%ae%8c%e6%95%b4%e6%80%a7%ef%bc%8c%e8%bf%98%e5%8f%af%e4%bb%a5%e5%af%b9%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e8%ae%a4%e8%af%81%e3%80%82%e4%bd%86%e6%98%af%e6%b6%88%e6%81%af%e8%ae%a4%e8%af%81%e7%a0%81%e7%9a%84%e7%bc%ba%e9%99%b7%e5%b0%b1%e5%9c%a8%e4%ba%8e%e5%ae%83%e7%9a%84%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e4%b8%8a%e9%9d%a2%e3%80%82%e7%94%b1%e4%ba%8e%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e7%9a%84%e5%8e%9f%e5%9b%a0%ef%bc%8c%e5%af%bc%e8%87%b4%e6%97%a0%e6%b3%95%e9%98%b2%e6%ad%a2%e6%8a%b5%e8%b5%96%e3%80%82%0a%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%b0%b1%e6%98%af%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e6%8a%b5%e8%b5%96%e7%9a%84%e9%97%ae%e9%a2%98%e7%9a%84%e3%80%82%e8%a7%a3%e5%86%b3%e7%9a%84%e6%96%b9%e6%b3%95%e5%b0%b1%e6%98%af%e8%ae%a9%e9%80%9a%e4%bf%a1%e5%8f%8c%e6%96%b9%e7%9a%84%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e4%b8%8d%e5%90%8c%ef%bc%8c%e4%bb%8e%e5%af%86%e9%92%a5%e4%b8%8a%e8%83%bd%e5%8c%ba%e5%88%86%e5%87%ba%e8%b0%81%e6%98%af%e8%b0%81%e3%80%82%0a%e4%ba%8c%e3%80%81%e4%bb%80%e4%b9%88%e6%98%af%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%ef%bc%9f%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9b%b8%e5%bd%93%e4%ba%8e%e7%8e%b0%e5%ae%9e%e4%b8%96%e7%95%8c%e4%b8%ad%e7%9a%84%e7%9b%96%e7%ab%a0%e3%80%81%e7%ad%be%e5%90%8d%e7%9a%84%e5%8a%9f%e8%83%bd%e5%9c%a8%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%96%e7%95%8c%e4%b8%ad%e8%bf%9b%e8%a1%8c%e5%ae%9e%e7%8e%b0%e7%9a%84%e6%8a%80%e6%9c%af%e3%80%82%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%8f%af%e4%bb%a5%e8%af%86%e5%88%ab%e7%af%a1%e6%94%b9%e3%80%81%e4%bc%aa%e8%a3%85%e3%80%81%e9%98%b2%e6%ad%a2%e6%8a%b5%e8%b5%96%e3%80%82%0a%e5%9c%a8%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%ad%ef%bc%8c%e6%9c%89%202%20%e7%a7%8d%e8%a1%8c%e4%b8%ba%ef%bc%9a%0a%20%e7%94%9f%e6%88%90%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e8%a1%8c%e4%b8%ba%20%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e8%a1%8c%e4%b8%ba%20%20%e7%94%9f%e6%88%90%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e6%98%af%e7%94%b1%e6%b6%88%e6%81%af%e5%8f%91%e9%80%81%e8%80%85%e5%ae%8c%e6%88%90%e7%9a%84%ef%bc%8c%e4%b9%9f%e7%a7%b0%e4%b8%ba%e2%80%9c%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e2%80%9d%e3%80%82%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e5%b0%b1%e6%98%af%e6%a0%b9%e6%8d%ae%e6%b6%88%e6%81%af%e5%86%85%e5%ae%b9%e8%ae%a1%e7%ae%97%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e5%80%bc%e3%80%82%0a%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e6%98%af%e7%ac%ac%e4%b8%89%e6%96%b9%e3%80%82%e7%ac%ac%e4%b8%89%e6%96%b9%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e6%9d%a5%e6%ba%90%e6%98%af%e5%90%a6%e5%b1%9e%e4%ba%8e%e5%8f%91%e9%80%81%e8%80%85%e3%80%82%e9%aa%8c%e8%af%81%e7%bb%93%e6%9e%9c%e5%8f%af%e4%bb%a5%e6%98%af%e6%88%90%e5%8a%9f%ef%bc%8c%e4%b9%9f%e5%8f%af%e4%bb%a5%e6%98%af%e5%a4%b1%e8%b4%a5%e3%80%82%0a%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%af%b9%e7%ad%be%e5%90%8d%e5%af%86%e9%92%a5%e5%92%8c%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e8%bf%9b%e8%a1%8c%e4%ba%86%e5%8c%ba%e5%88%86%ef%bc%8c%e4%bd%bf%e7%94%a8%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e6%98%af%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e7%9a%84%e3%80%82%e7%ad%be%e5%90%8d%e5%af%86%e9%92%a5%e5%8f%aa%e8%83%bd%e7%94%b1%e7%ad%be%e5%90%8d%e4%ba%ba%e6%8c%81%e6%9c%89%ef%bc%8c%e8%80%8c%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e5%88%99%e6%98%af%e4%bb%bb%e4%bd%95%e9%9c%80%e8%a6%81%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e6%8c%81%e6%9c%89%e3%80%82%0a%20%20%20%20%e7%a7%81%e9%92%a5%20%e5%85%ac%e9%92%a5%20%20%20%20%20%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%20%e6%8e%a5%e6%94%b6%e8%80%85%e8%a7%a3%e5%af%86%e6%97%b6%e4%bd%bf%e7%94%a8%20%e5%8f%91%e9%80%81%e8%80%85%e5%8a%a0%e5%af%86%e6%97%b6%e4%bd%bf%e7%94%a8%20%20%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%20%e7%ad%be%e5%90%8d%e8%80%85%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e6%97%b6%e4%bd%bf%e7%94%a8%20%e9%aa%8c%e8%af%81%e8%80%85%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%e6%97%b6%e4%bd%bf%e7%94%a8%20%20%20%e8%b0%81%e6%8c%81%e6%9c%89%e5%af%86%e9%92%a5%ef%bc%9f%20%e4%b8%aa%e4%ba%ba%e6%8c%81%e6%9c%89%20%e5%8f%aa%e8%a6%81%e9%9c%80%e8%a6%81%ef%bc%8c%e4%bb%bb%e4%bd%95%e4%ba%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e6%8c%81%e6%9c%89%20%20%20%20%e4%b8%a5%e6%a0%bc%e7%9a%84%e6%9d%a5%e8%af%b4%ef%bc%8cRSA%20%e7%ae%97%e6%b3%95%e4%b8%ad%e5%85%ac%e9%92%a5%e5%8a%a0%e5%af%86%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e6%ad%a3%e5%a5%bd%e6%98%af%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%8f%8d%e7%9a%84%e5%85%b3%e7%b3%bb%ef%bc%8c%e4%bd%86%e6%98%af%e5%9c%a8%e5%85%b6%e4%bb%96%e5%85%ac%e9%92%a5%e7%ae%97%e6%b3%95%e4%b8%ad%e6%9c%89%e5%8f%af%e8%83%bd%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%8d%e6%98%af%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%8f%8d%e7%9a%84%e5%85%b3%e7%b3%bb%e3%80%82%0a%e5%9c%a8%e5%85%ac%e9%92%a5%e7%ae%97%e6%b3%95%e4%b8%ad%ef%bc%8c%e5%85%ac%e9%92%a5%e7%94%a8%e6%9d%a5%e5%8a%a0%e5%af%86%ef%bc%8c%e7%a7%81%e9%92%a5%e7%94%a8%e6%9d%a5%e8%a7%a3%e5%af%86%e3%80%82%0a%e5%9c%a8%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%ad%ef%bc%8c%e5%85%ac%e9%92%a5%e7%94%a8%e6%9d%a5%e8%a7%a3%e5%af%86%28%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%29%ef%bc%8c%e7%a7%81%e9%92%a5%e7%94%a8%e6%9d%a5%e5%8a%a0%e5%af%86%28%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%29%e3%80%82%0a%e4%b8%89%e3%80%81%e7%94%9f%e6%88%90%e5%92%8c%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%20%e6%9c%89%e4%b8%a4%e7%a7%8d%e7%94%9f%e6%88%90%e5%92%8c%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%ef%bc%9a%0a%20%e7%9b%b4%e6%8e%a5%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%e5%af%b9%e6%b6%88%e6%81%af%e7%9a%84%e6%95%a3%e5%88%97%e5%80%bc%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%201.%20%e7%9b%b4%e6%8e%a5%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%202.%20%e5%af%b9%e6%b6%88%e6%81%af%e7%9a%84%e6%95%a3%e5%88%97%e5%80%bc%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%e6%af%94%e8%be%83%e4%b8%8a%e9%9d%a2%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%ef%bc%8c%e4%b8%80%e8%88%ac%e9%83%bd%e4%bc%9a%e4%bd%bf%e7%94%a8%e7%ac%ac%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%e3%80%82%e5%8e%9f%e5%9b%a0%e6%98%af%e5%9b%a0%e4%b8%ba%e7%ac%ac%201%20%e7%a7%8d%e6%96%b9%e6%b3%95%e8%a6%81%e5%af%b9%e6%95%b4%e4%b8%aa%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%80%8c%e4%b8%94%e6%98%af%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%e7%ae%97%e6%b3%95%ef%bc%8c%e9%9d%9e%e5%b8%b8%e8%80%97%e6%97%b6%e3%80%82%e5%88%a9%e7%94%a8%e7%ae%80%e7%9f%ad%e7%9a%84%e5%8d%95%e5%90%91%e6%95%a3%e5%88%97%e5%87%bd%e6%95%b0%e6%9d%a5%e6%9b%bf%e4%bb%a3%e6%b6%88%e6%81%af%e6%9c%ac%e8%ba%ab%e3%80%82%e5%86%8d%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%28%e5%af%b9%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e7%ad%be%e5%90%8d%29%ef%bc%8c%e4%bc%9a%e5%bf%ab%e5%be%88%e5%a4%9a%e3%80%82%0a%e5%af%b9%e4%b8%8a%e9%9d%a2%e7%9a%84%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%ef%bc%8c%e6%9c%89%e4%b8%80%e4%ba%9b%e5%85%b1%e6%80%a7%e7%9a%84%e9%97%ae%e9%a2%98%e8%bf%9b%e8%a1%8c%e8%a7%a3%e9%87%8a%ef%bc%9a%0a%20%20%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8a%a0%e5%af%86%e4%bb%a5%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e8%83%bd%e5%a4%9f%e5%85%b7%e5%a4%87%e7%ad%be%e5%90%8d%e7%9a%84%e6%84%8f%e4%b9%89%ef%bc%9f%0a%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e6%98%af%e5%88%a9%e7%94%a8%e4%ba%86%20%e2%80%9c%e6%b2%a1%e6%9c%89%e7%a7%81%e9%92%a5%e7%9a%84%e4%ba%ba%e5%b0%b1%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e4%bd%bf%e7%94%a8%e8%af%a5%e7%a7%81%e9%92%a5%e6%89%80%e7%94%9f%e6%88%90%e7%9a%84%e5%af%86%e6%96%87%e2%80%9d%20%e8%bf%99%e4%b8%80%e6%80%a7%e8%b4%a8%e6%9d%a5%e5%ae%9e%e7%8e%b0%e7%9a%84%e3%80%82%e7%94%9f%e6%88%90%e7%9a%84%e5%af%86%e6%96%87%e5%b9%b6%e9%9d%9e%e6%98%af%e7%94%a8%e4%ba%8e%e4%bf%9d%e8%af%81%e6%9c%ba%e5%af%86%e6%80%a7%ef%bc%8c%e8%80%8c%e6%98%af%e7%94%a8%e4%ba%8e%e4%bb%a3%e8%a1%a8%e4%b8%80%e7%a7%8d%e5%8f%aa%e6%9c%89%e6%8c%81%e6%9c%89%e8%af%a5%e5%af%86%e9%92%a5%e7%9a%84%e4%ba%ba%e6%89%8d%e8%83%bd%e7%94%9f%e6%88%90%e7%9a%84%e4%bf%a1%e6%81%af%e3%80%82%e6%89%80%e4%bb%a5%e7%a7%81%e9%92%a5%e4%ba%a7%e7%94%9f%e7%9a%84%e5%af%86%e6%96%87%e6%98%af%e4%b8%80%e7%a7%8d%e8%ae%a4%e8%af%81%e7%ac%a6%e5%8f%b7%28authenticator%29%e3%80%82%20%20%20%20%e4%b8%8a%e9%9d%a2%e6%96%b9%e6%b3%95%202%20%e4%b8%ad%e6%b6%88%e6%81%af%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%e5%b0%b1%e7%9b%b4%e6%8e%a5%e5%8f%91%e9%80%81%e4%ba%86%ef%bc%8c%e8%bf%99%e6%a0%b7%e4%b8%8d%e5%b0%b1%e6%b2%a1%e6%b3%95%e4%bf%9d%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e6%9c%ba%e5%af%86%e6%80%a7%e4%ba%86%e4%b9%88%ef%bc%9f"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&t=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一为什么需要数字签名>一、为什么需要数字签名？</a></li><li><a href=#二什么是数字签名>二、什么是数字签名？</a></li><li><a href=#三生成和验证数字签名>三、生成和验证数字签名</a><ul><li><a href=#1-直接对消息签名的方法>1. 直接对消息签名的方法</a></li><li><a href=#2-对消息的散列值签名的方法>2. 对消息的散列值签名的方法</a></li></ul></li><li><a href=#四数字签名应用实例>四、数字签名应用实例</a><ul><li><a href=#1-安全信息公告>1. 安全信息公告</a></li><li><a href=#2-软件下载>2. 软件下载</a></li><li><a href=#3-公钥证书>3. 公钥证书</a></li><li><a href=#4-ssltls>4. SSL/TLS</a></li></ul></li><li><a href=#五数字签名的实现方式>五、数字签名的实现方式</a><ul><li><a href=#1-用-rsa-生成签名>1. 用 RSA 生成签名</a></li><li><a href=#2-用-rsa-验证签名>2. 用 RSA 验证签名</a></li></ul></li><li><a href=#六其他几种数字签名>六、其他几种数字签名</a><ul><li><a href=#1-elgamal-方式>1. ElGamal 方式</a></li><li><a href=#2-dsa>2. DSA</a></li><li><a href=#生成-dsa-密钥对>生成 DSA 密钥对</a></li><li><a href=#签名生成>签名生成</a></li><li><a href=#签名验证>签名验证</a></li><li><a href=#3-ecdsa>3. ECDSA</a></li><li><a href=#生成-ecdsa-密钥对>生成 ECDSA 密钥对</a></li><li><a href=#签名生成-1>签名生成</a></li><li><a href=#验证签名>验证签名</a></li><li><a href=#4-rabin-方式>4. Rabin 方式</a></li></ul></li><li><a href=#七对数字签名的攻击>七、对数字签名的攻击</a><ul><li><a href=#1-中间人攻击公钥>1. 中间人攻击公钥</a></li><li><a href=#2-对单向散列函数的攻击>2. 对单向散列函数的攻击</a></li><li><a href=#3-利用数字签名攻击公钥密码>3. 利用数字签名攻击公钥密码</a></li><li><a href=#4-潜在伪造>4. 潜在伪造</a></li><li><a href=#5-其他攻击>5. 其他攻击</a></li></ul></li><li><a href=#八数字签名无法解决的问题>八、数字签名无法解决的问题</a></li><li><a href=#九openssl-中的-rsa-数字签名>九、OpenSSL 中的 RSA 数字签名</a></li><li><a href=#十openssl-中的-dsa-数字签名>十、OpenSSL 中的 DSA 数字签名</a></li><li><a href=#十openssl-中的-ecdsa-数字签名>十、OpenSSL 中的 ECDSA 数字签名</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">无处不在的数字签名</h1><div class=meta><div class=postdate><time datetime="2018-09-08 13:01:00 +0000 UTC" itemprop=datePublished>Sep 08</time></div></div></header><div class=content itemprop=articleBody><h2 id=一为什么需要数字签名>一、为什么需要数字签名？</h2><p>从上一篇文章里面我们知道，消息认证码可以识别篡改或者发送者身份是否被伪装，也就是验证消息的完整性，还可以对消息进行认证。但是消息认证码的缺陷就在于它的共享密钥上面。由于共享密钥的原因，导致无法防止抵赖。</p><p>数字签名就是为了解决抵赖的问题的。解决的方法就是让通信双方的共享密钥不同，从密钥上能区分出谁是谁。</p><h2 id=二什么是数字签名>二、什么是数字签名？</h2><p>数字签名相当于现实世界中的盖章、签名的功能在计算机世界中进行实现的技术。数字签名可以识别篡改、伪装、防止抵赖。</p><p>在数字签名中，有 2 种行为：</p><ul><li>生成消息签名的行为</li><li>验证消息签名的行为</li></ul><p><strong>生成消息签名</strong>的人是由消息发送者完成的，也称为“对消息签名”。生成签名就是根据消息内容计算数字签名的值。</p><p><strong>验证数字签名</strong>的人是第三方。第三方验证消息的来源是否属于发送者。验证结果可以是成功，也可以是失败。</p><p><strong>数字签名对签名密钥和验证密钥进行了区分，使用验证密钥是无法生成签名的</strong>。签名密钥只能由签名人持有，而验证密钥则是任何需要验证签名的人都可以持有。</p><table><thead><tr><th align=center></th><th align=center>私钥</th><th align=center>公钥</th></tr></thead><tbody><tr><td align=center>公钥密钥</td><td align=center>接收者解密时使用</td><td align=center>发送者加密时使用</td></tr><tr><td align=center>数字签名</td><td align=center>签名者生成签名时使用</td><td align=center>验证者验证签名时使用</td></tr><tr><td align=center>谁持有密钥？</td><td align=center>个人持有</td><td align=center>只要需要，任何人都可以持有</td></tr></tbody></table><p>严格的来说，RSA 算法中公钥加密和数字签名正好是完全相反的关系，但是在其他公钥算法中有可能和数字签名不是完全相反的关系。</p><p>在公钥算法中，公钥用来加密，私钥用来解密。</p><p>在数字签名中，公钥用来解密(验证签名)，私钥用来加密(生成签名)。</p><h2 id=三生成和验证数字签名>三、生成和验证数字签名</h2><p>有两种生成和验证数字签名的方法：</p><ul><li>直接对消息签名的方法</li><li>对消息的散列值签名的方法</li></ul><h3 id=1-直接对消息签名的方法>1. 直接对消息签名的方法</h3><h3 id=2-对消息的散列值签名的方法>2. 对消息的散列值签名的方法</h3><p>比较上面 2 种方法，一般都会使用第 2 种方法。原因是因为第 1 种方法要对整个消息进行加密，而且是公钥密钥算法，非常耗时。利用简短的单向散列函数来替代消息本身。再进行加密(对消息进行签名)，会快很多。</p><p>对上面的 2 种方法，有一些共性的问题进行解释：</p><ul><li><p>为什么加密以后的密文能够具备签名的意义？</p><ul><li>数字签名是利用了 “没有私钥的人就无法生成使用该私钥所生成的密文” 这一性质来实现的。生成的密文并非是用于保证机密性，而是用于代表一种<strong>只有持有该密钥的人才能生成的信息</strong>。所以私钥产生的密文是一种<strong>认证符号(authenticator)</strong>。</li></ul></li><li><p>上面方法 2 中消息没有加密就直接发送了，这样不就没法保证消息的机密性了么？</p><ul><li>数字签名本来就不保证消息的机密性。如果需要保证机密性，可以考虑加密和数字签名结合起来使用。</li></ul></li><li><p>签名可以随意复制么？</p><ul><li>数字签名代表的意义是<strong>特定的签名者与特定的消息绑定在一起</strong>，数字签名虽然可以任意复制，但是它的代表的意义始终不变。</li></ul></li><li><p>提取出签名，组合任意消息和该签名，这样不就可以伪造签名者的意图了吗？</p><ul><li>数字签名会识别修改，验证者验证的时候会发现消息和签名的散列值不同，验证失败从而丢弃这条消息。</li></ul></li><li><p>能否碰撞攻击，同时修改消息和签名，达到骗过验证者的目的？</p><ul><li>实际上这种方式做不到。首先修改了消息以后，散列值会发生变化。再想拼凑合法的签名，其实是做不到的。因为没有私钥是无法对新的散列值进行加密的。</li></ul></li><li><p>数字签名签订了以后能反悔么？</p><ul><li>数字签名本来就是用来防止抵赖的，一旦签署以后，无法抵赖，不能撕毁合同。只能再创建一个声明消息，声明该公钥已经作废的消息并另外加上数字签名。</li></ul></li></ul><h2 id=四数字签名应用实例>四、数字签名应用实例</h2><h3 id=1-安全信息公告>1. 安全信息公告</h3><p>信息安全组织会在网站上发布一些关于安全漏洞的警告。由于这些信息需要被更多的人知道，所以没有必要对消息进行加密。但是需要防止有人伪装该组织发布虚假信息，这个时候只需要加上数字签名即可。这种对明文消息所施加的签名，一般称为<strong>明文签名(clearsign)</strong>。</p><h3 id=2-软件下载>2. 软件下载</h3><p>为了保证下载软件的安全，不是恶意的病毒，软件作者会对软件加上数字签名。用户在下载完成以后，验证数字签名就能识别出下载的是不是被篡改过的软件。</p><h3 id=3-公钥证书>3. 公钥证书</h3><p>验证数字签名的时候需要合法的公钥，但是如何才能知道自己拿到的公钥是合法的呢？这个时候就需要把公钥作为信息，对它加上数字签名，得到公钥证书。关于证书的问题再下一篇文章里面详细分析。</p><h3 id=4-ssltls>4. SSL/TLS</h3><p>SSL/TLS 在认证服务器身份的时候会使用服务器证书，服务器证书就是加上了数字签名的服务器公钥。</p><h2 id=五数字签名的实现方式>五、数字签名的实现方式</h2><p>这一章节简单的讲讲用 RSA 公钥算法和单向散列函数生成签名。</p><h3 id=1-用-rsa-生成签名>1. 用 RSA 生成签名</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>签名</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>消息</span><span style=color:#f92672>^</span>D mod N (<span style=color:#960050;background-color:#1e0010>用</span> RSA <span style=color:#960050;background-color:#1e0010>生成签名</span>)
</code></pre></div><p>上面的 D 和 N 就是签名者的私钥。签名就是对消息的 D 次方求 mod N 的结果。</p><h3 id=2-用-rsa-验证签名>2. 用 RSA 验证签名</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>由签名求得的消息</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>签名</span><span style=color:#f92672>^</span>E mod N (<span style=color:#960050;background-color:#1e0010>用</span> RSA <span style=color:#960050;background-color:#1e0010>验证签名</span>)
</code></pre></div><p>上面的 E 和 N 就是签名者的公钥。验证者计算签名的 E 次方并求 mod N，得到“由签名求得的消息”。将这个消息和发送者直接发过来的消息进行对比，如果一致就验证成功，不一致就验证失败。</p><h2 id=六其他几种数字签名>六、其他几种数字签名</h2><h3 id=1-elgamal-方式>1. ElGamal 方式</h3><p>EIGamal 方式是由 Taher ElGamal 设计的公钥算法，利用了在 mod N 中求离散对数的困难度。ElGamal 方式可以被用于公钥密码和数字签名。</p><h3 id=2-dsa>2. DSA</h3><p>DSA(Digital Signature Algorithm)是一种数字签名的算法。是由 NIST(National Institute of Standards and Technology，美国国家标准技术研究所)于 1991 年制定的数字签名规范(Digital Signature Standard，DSS)。DSA 是 Schnorr 算法和 ElGamal 方式的变体，只能用于数字签名，不能进行加密解密。</p><p>和 DH 算法类似，DSA 算法主要了解的也是其参数。通过参数文件生成密钥对。p、q、g 是公共参数，通过参数会生成密钥对，DSA 的公共参数和 DH 的公共参数很像，通过公共参数能够生成无数个密钥对，这是一个很重要的特性。</p><p>p 是一个很大的质数，这个值的长度建议大于等于 1024 比特(必须是 64 比特的倍数)，p-1 必须是 q 的倍数，q 的长度必须是 160 比特。而 g 是一个数学表达式的结果，数值来自 p 和 q。</p><p>DSA算法中应用了下述参数：</p><p>p：L 比特长的素数。L 是 64 的倍数，范围是 512 到 1024；<br>q：p – 1 的 160 比特的素因子；<br>g：g = h^((p-1)/q) mod p，h 满足 h &lt; p – 1, h^((p-1)/q) mod p > 1；<br>x：x &lt; q，x 为私钥；<br>y：y = g^x mod p ，( p, q, g, y )为公钥；<br>H( x )：One-Way Hash函数。DSS 中 选用 SHA( Secure Hash Algorithm )。</p><p>DSA 的密钥对生成就取决于这三个公共参数 p、q、g。计算签名和验证签名也依赖参数文件。</p><h3 id=生成-dsa-密钥对>生成 DSA 密钥对</h3><ol><li>选取一个随机数作为私钥 x ，0 &lt; x &lt; q。</li><li>基于私钥生成公钥，g^x mod p</li></ol><blockquote><p>RSA 算法，DH 算法，DSA 算法都是基于离散数学。</p></blockquote><h3 id=签名生成>签名生成</h3><ol start=3><li>生成一个随机数 k，1 &lt; k &lt; q。</li><li>计算 r = (g^k mod p) mod q。</li><li>计算 s = (k^(-1)(H(m)+xr)) mod q，H 是特定的摘要算法。</li><li>签名值就是(r，s)，随同原始消息 m 一起发送。</li></ol><h3 id=签名验证>签名验证</h3><ol start=7><li>假如 r 和 s 大于 q 或者小于 0，则验证直接失败</li><li>计算 w = s^(-1) mod q</li><li>计算 u1 = H(m).w mod q</li><li>计算 u2 = r.w mod q</li><li>计算 v = (g^u1 * y^u2 mod p) mod q</li><li>如果 v 等于 r，则签名验证成功，否则失败</li></ol><h3 id=3-ecdsa>3. ECDSA</h3><p>ECDSA(Elliptic Curve Digital Signature Algorithm)是一种利用椭圆曲线密码来实现的数字签名算法。</p><p>就像 DH 算法结合 ECC 一样，DSA 算法也能结合 ECC，称为 ECDSA 数字签名算法。相比 DSA 算法，ECDSA 算法安全性更高。</p><p>在 ECDSA 中，有三个参数很重要：</p><ul><li>ECDSA 算法选择的命名曲线。</li><li>G，椭圆曲线的基点</li><li>n，相当于 G 基点的打点操作，n * G = 0</li></ul><h3 id=生成-ecdsa-密钥对>生成 ECDSA 密钥对</h3><ol><li>选择一个随机数作为私钥 d_{a}，1&lt; d_{a} &lt; n -1</li><li>基于私钥生成公钥，Q_{a} = d_{a} * G</li></ol><h3 id=签名生成-1>签名生成</h3><ol start=3><li>计算摘要值 e = HASH(m)</li><li>获取 z = e 最左边的 L_{n} 位字符，L_{n} 是 n 的长度</li><li>生成一个随机数 k，1 &lt; k &lt; n - 1</li><li>计算 (x,y) = k * G</li><li>计算 r = x mod n</li><li>计算 s = k_{-1} (z + r * d_{-1}) mod n</li><li>签名值(r，s)</li></ol><h3 id=验证签名>验证签名</h3><ol start=10><li>假如 r 和 s 小于 1 或者大于 n-1，验证直接失败</li><li>获取 z = e 最左边的 L_{n} 位字符</li><li>计算 w = s^{-1} mod n</li><li>计算 u_{1} = zw mod n</li><li>计算 u_{2} = rw mod n</li><li>计算 (x,y) = u_{1} * G + u_{2} * Q_{a}</li><li>如果 r == x_{1} mod n，则签名验证成功，否则失败</li></ol><h3 id=4-rabin-方式>4. Rabin 方式</h3><p>Rabin 方式是由 M.O.Rabin 设计的公钥算法，利用了在 mod N 中求平方根的困难度。Rabin 方式可以被用于公钥密码和数字签名。</p><h2 id=七对数字签名的攻击>七、对数字签名的攻击</h2><h3 id=1-中间人攻击公钥>1. 中间人攻击公钥</h3><p>这里的攻击主要是攻击公钥。如何进行公钥之间的认证，还是需要使用公钥证书。</p><h3 id=2-对单向散列函数的攻击>2. 对单向散列函数的攻击</h3><p>对单向散列函数进行碰撞攻击，生成另外一条不同的消息，使其与签名所绑定的消息具有相同的散列值。</p><h3 id=3-利用数字签名攻击公钥密码>3. 利用数字签名攻击公钥密码</h3><p>由于 RSA 和数字签名互为逆向操作。于是可以利用这一性质，对 RSA 进行攻击。让发送者对 RSA 密文进行签名(用私钥加密)，就相当于是 RSA 中的解密操作。</p><p>防止这种攻击有几种方法：</p><ul><li>不要直接对任何消息进行签名，对散列值进行签名比较安全</li><li>公钥密码和数字签名使用不同的密钥对</li><li>绝对不要对意思不清楚的消息进行签名，就像在看不懂的合同上任意盖章</li></ul><h3 id=4-潜在伪造>4. 潜在伪造</h3><p>即使签名的对象是无任何意义的消息，例如随机比特序列，如果攻击者能够生成合法的数字签名(即攻击者生成的签名能够正常通过校验)，这也算是对这种签名算法的一种潜在威胁。在用 RSA 来解密消息的数字签名算法中，潜在伪造是可能的。只要将随机比特序列 S 用 RSA 的公钥加密生成密文 M，那么，S 就是 M 的合法数字签名，由于攻击者是可以获取公钥的，因此对数字签名的潜在伪造就实现了。</p><p>为了防止这种情况，人们改良了 RSA ，开发出了新的签名算法，RSA-PSS(Probabilistic Signature Scheme)。RSA-PSS 并不是对消息本身进行签名，而是对其散列值进行签名，为了提高安全性，在计算散列值的时候还对消息加盐(salt)。</p><h3 id=5-其他攻击>5. 其他攻击</h3><p>对公钥密码的攻击都可以用于对数字签名的攻击，例如暴力破解私钥，尝试对 RSA 的 N 进行质因数分解等等</p><h2 id=八数字签名无法解决的问题>八、数字签名无法解决的问题</h2><p>数字签名所用到的公钥密码中的公钥需要另外认证，防止中间人攻击。认证用于验证签名的公钥必须属于真正的发送者。</p><p>似乎陷入了一个死循环。数字签名用来识别消息篡改，伪装以及防止抵赖。但是我们又必须从没有被伪装的发送者得到没有被篡改的公钥才行。</p><p>为了验证得到的公钥是否合法，必须使用<strong>证书</strong>。证书是将公钥当做一条消息，由一个可信的第三方对其签名后所得到的公钥。</p><p>关于证书的话题，下一篇文章再继续展开。</p><h2 id=九openssl-中的-rsa-数字签名>九、OpenSSL 中的 RSA 数字签名</h2><p>和 RSA 公钥加密不一样，RSA 实现的数字签名技术需要涉及到摘要计算，所以需要指定 一个 Hash 算法。下面这个例子用 sha256 Hash 算法。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成一个 RSA 密钥对，密钥长度 1024 长度
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl genrsa <span style=color:#f92672>-</span>out rsaprivatekey.pem <span style=color:#ae81ff>1024</span>
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>
Generating RSA private key, <span style=color:#ae81ff>1024</span> bit <span style=color:#66d9ef>long</span> modulus (<span style=color:#ae81ff>2</span> primes)
......<span style=color:#f92672>++++++</span>
.............................................<span style=color:#f92672>++++++</span>
e is <span style=color:#ae81ff>65537</span> (<span style=color:#ae81ff>0x010001</span>)

<span style=color:#f92672>-----</span>BEGIN RSA PRIVATE KEY<span style=color:#f92672>-----</span>
MIICXgIBAAKBgQDbaFOaGiDqwRe<span style=color:#f92672>+</span>nye9lmLy6mnQT33GGjV<span style=color:#f92672>+</span>vEDtTP<span style=color:#f92672>/</span>kog3W5jou
LKduc7Qy<span style=color:#f92672>/</span>iMDXxVyAddaUjRwkuX6mdVOtDzgbBY<span style=color:#f92672>/</span>nwOSwvTe9jCD89AM7z0il6iG
<span style=color:#ae81ff>7</span>m1JgEEq9zYzmRxO<span style=color:#f92672>/</span>yfkv8OrlZpfZ6<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span>jzUKVnjXlGdhkipJqBX19M9<span style=color:#f92672>/</span>kQIDAQAB
AoGBAM2st6oe0jqeNd8InR1ZK3qhif2vdqzNBta<span style=color:#f92672>+</span>LHMHGl4<span style=color:#f92672>+</span>F5EbEvEUBQRCTGr8
<span style=color:#ae81ff>1</span>t<span style=color:#f92672>+</span>jM5xC45iUtPnOiu3nZRE5XlIaGbsklPM3chu0<span style=color:#f92672>/</span>onBdbXsP5aRSZuIobHP01GV
LFqUsFmVOIAKPONRR8Zn5Ji9FQ5bs6meYBmawC23EWcB<span style=color:#f92672>/</span>cHRAkEA9AwOFZrIN3XG
<span style=color:#ae81ff>0</span>YXkoLTm0eGOWg6zRBUxt9ZwCjhciz<span style=color:#f92672>/</span>riDWnBqIwHxqourN4ss<span style=color:#f92672>/</span>XwyPJxmvYXMoW
<span style=color:#ae81ff>2</span>dl1KmjYBQJBAOYnVRWMraQSdbeSwTo27tGVME3I6RqJHrs0<span style=color:#f92672>+</span><span style=color:#ae81ff>4</span>EDH<span style=color:#f92672>/</span>W79bL778fJ
VMRyTjKhZxbzb7xU0bl9it8rbxN<span style=color:#f92672>+</span><span style=color:#ae81ff>4</span>yjUmx0CQQC31zDw83Vp2e4Yve05Zq0OZASR
MMu4OOMIIqCqAkUsnM04AXq<span style=color:#f92672>+</span>E4V<span style=color:#f92672>+</span>mN2ML1B4GvvlQ1tnfqwxUgceuqJ5fRtlAkAN
ouj0pOgo33sgDE7sjxKpUkiRY0UEcHlkqCf6pd<span style=color:#f92672>+/</span><span style=color:#ae81ff>5</span>IoTN8AmOzSNiyQ89bkw7<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>
<span style=color:#ae81ff>4</span>Bqo<span style=color:#f92672>/</span>do7jMxBAHSfF7G1AkEAsAx6<span style=color:#f92672>+</span>LSQHRN8iD1Uno9<span style=color:#f92672>/</span>VJXkoXV5CMicZIO4OXYT
<span style=color:#f92672>+</span>z95tcREHgHRX4TmtF4Z9fTX5uQsk8oLgHqG9p4Y<span style=color:#f92672>+</span>RfJXw<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END RSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>提取公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 从密钥对中分离出公钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>in rsaprivatekey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out rsapublickey.pem  
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDbaFOaGiDqwRe<span style=color:#f92672>+</span>nye9lmLy6mnQ
T33GGjV<span style=color:#f92672>+</span>vEDtTP<span style=color:#f92672>/</span>kog3W5jouLKduc7Qy<span style=color:#f92672>/</span>iMDXxVyAddaUjRwkuX6mdVOtDzgbBY<span style=color:#f92672>/</span>
nwOSwvTe9jCD89AM7z0il6iG7m1JgEEq9zYzmRxO<span style=color:#f92672>/</span>yfkv8OrlZpfZ6<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span>jzUKVnjX
lGdhkipJqBX19M9<span style=color:#f92672>/</span>kQIDAQAB
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>生成签名文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 对 plain.txt 文件使用 sha256 Hash 算法和签名算法生成签名文件 signature.txt 
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>$</span> echo <span style=color:#e6db74>&#34;hello&#34;</span> <span style=color:#f92672>&gt;&gt;</span> plain.txt
<span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>sign rsaprivatekey.pem <span style=color:#f92672>-</span>out signature.txt plain.txt

</code></pre></div><p>打开 signature.txt 文件，里面存储的就是签名之后的结果。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>l<span style=color:#f92672>^</span>CãîE<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>c<span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#ae81ff>3</span><span style=color:#f92672>^</span>M<span style=color:#f92672>^?&amp;</span>v{<span style=color:#ae81ff>7</span>P<span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>91</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>c<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>55</span>g<span style=color:#f92672>^</span>E<span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>@Ç¦È</span>Yþ _Ïc<span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>ÓçÖÄ</span><span style=color:#f92672>^</span>[<span style=color:#f92672>^</span>C<span style=color:#960050;background-color:#1e0010>¢</span><span style=color:#f92672>^</span>MgOÕÂ<span style=color:#f92672>|^^</span><span style=color:#960050;background-color:#1e0010>»ÿ</span><span style=color:#f92672>%</span><span style=color:#960050;background-color:#1e0010>ä</span><span style=color:#f92672>:&lt;</span><span style=color:#ae81ff>92</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>8</span>a<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>÷</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>87</span><span style=color:#f92672>&gt;</span>f<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>89</span><span style=color:#f92672>&gt;^</span>M.
<span style=color:#960050;background-color:#1e0010>¢</span>aO<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>93</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ÕÇÝ</span><span style=color:#f92672>&amp;</span>xå[<span style=color:#960050;background-color:#1e0010>áÜ±ã</span><span style=color:#f92672>=</span>.<span style=color:#960050;background-color:#1e0010>À</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>82</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Ùè</span>Ez<span style=color:#f92672>^</span>E(_<span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>@</span>spøZ9<span style=color:#960050;background-color:#1e0010>×</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>93</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>\©É</span><span style=color:#f92672>^</span>]<span style=color:#960050;background-color:#1e0010>Ë</span>Io<span style=color:#f92672>^</span>Z<span style=color:#f92672>?</span>(<span style=color:#f92672>^^</span><span style=color:#ae81ff>1</span><span style=color:#f92672>*</span><span style=color:#960050;background-color:#1e0010>á¶</span><span style=color:#f92672>%</span><span style=color:#960050;background-color:#1e0010>¯²©</span><span style=color:#f92672>^</span>Wñ<span style=color:#960050;background-color:#1e0010>¶</span>f7iQKäC<span style=color:#960050;background-color:#1e0010>`</span>
</code></pre></div><p>校验签名文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 用相同的摘要算法和签名算法校验签名文件，需要对比签名文件和原始文件
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify rsapublickey.pem <span style=color:#f92672>-</span>signature signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verified OK
</code></pre></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 更换一个 txt 文件再次验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify rsapublickey.pem <span style=color:#f92672>-</span>signature signature.txt signature.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verification Failure
</code></pre></div><p>除去用 sha256 Hash 算法以外，还可以指定 RSASSA-PSS 标准</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成 RSA 密钥对
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl genrsa <span style=color:#f92672>-</span>out rsaprivatekey.pem <span style=color:#ae81ff>2048</span>
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating RSA private key, <span style=color:#ae81ff>2048</span> bit <span style=color:#66d9ef>long</span> modulus (<span style=color:#ae81ff>2</span> primes)
..........................<span style=color:#f92672>+++</span>
............................<span style=color:#f92672>+++</span>
e is <span style=color:#ae81ff>65537</span> (<span style=color:#ae81ff>0x010001</span>)

<span style=color:#f92672>-----</span>BEGIN RSA PRIVATE KEY<span style=color:#f92672>-----</span>
MIIEpAIBAAKCAQEAuvYWXiZ7esG<span style=color:#f92672>+</span>Vv<span style=color:#f92672>/</span>aiOSwoXV1bURTUimwUumQm1N0lOsy0BC4
yxxjhPxz5UNHCUIGFp39Ux6BRRKxAeD<span style=color:#f92672>+</span>J13AAte6Ge<span style=color:#f92672>+</span>hU3hS<span style=color:#f92672>+</span>b1TN55oVpdTX6Er
<span style=color:#ae81ff>1</span>GzpnL6bn<span style=color:#f92672>/</span>ZCGR7Rd4ml9H58<span style=color:#f92672>+</span>n6SKowDRecBYQkuOgMkInLl36dHCuvG65h3KYdT
Emhkb8IjUQAMGjGcbJpkAnjmP5k6RxY<span style=color:#75715e>//sx9/o/kyPKiYSIJDRVJBShg+ADfkuyT
</span><span style=color:#75715e></span>qD1jAYl7LSsN4w27KQIV0r606WZbTYcWzM4wPU30XFvTLDzp7frueSF8hprJiOA<span style=color:#f92672>/</span>
D6TDaCPbEx9QXeUCvsGCXhTUl7sKkNSSA9jW<span style=color:#f92672>/</span>wIDAQABAoIBAGVoMyuwHcuwqKgR
sJwNxsxcpGu24qavHAdszlWhh5t6kx4N492vMT<span style=color:#f92672>+</span>hms8glbgsypab7RqXcjBf<span style=color:#f92672>+</span>gh1
<span style=color:#ae81ff>3</span>ATIMeyYzEVjF5Lpsb<span style=color:#f92672>/</span>p8<span style=color:#f92672>+</span>g4EInfHIbDKb3XsUKmlEzISoPLlnwK<span style=color:#f92672>+</span>ivKK8nGu0s<span style=color:#f92672>+</span>
lEvnB3V1gFBRAdl5jrunxL3kswl3xAOTPUG7HN8SzhKbW2q15iXeIYdsrGDdNmCW
r4ijcW2xuaCAwRIDG9wMsaU<span style=color:#f92672>+</span>J0kVBoxqrFcN1t73HdhauDCdHqH7oBYYxCliMvmQ
MainlIcF3hfhS8fPbUm52mepIKjUAw<span style=color:#f92672>+</span>mpzlNnhPz6tuk5T1dUu<span style=color:#f92672>/</span>hafdIoBZ9yfK1
n6yw14ECgYEA7igQq<span style=color:#f92672>/</span>di<span style=color:#f92672>+</span>YE7XdV3jgqKCOlWFx68M14NRdNcYZhjPHw2F4waqur<span style=color:#f92672>+</span>
K0FDMLVP<span style=color:#f92672>/</span>lPfoI3BWIvjp3qSiMbplKVPokMAdJ0kkwiw<span style=color:#f92672>/</span>zSHaz8NYANTET5RQvs1
akhD<span style=color:#f92672>/</span>oHiktY<span style=color:#f92672>/</span>NKEWlpofKj09dzeALWzhvIz7q7b6sjXXTJVQL6DouMECgYEAyPgT
<span style=color:#ae81ff>6</span>w<span style=color:#f92672>+</span>yh1Orf8utnCgd2e7YInl<span style=color:#f92672>+</span><span style=color:#ae81ff>5</span>RhIZqE4DKeJXjFUhxktimv2d7QJXP7KjAcdjel4
KzQ<span style=color:#f92672>+</span>nIDody59GZtibLRMU1p7tAHOFKpV7k7D3ZiDqzn9BsRs<span style=color:#f92672>+</span>GemKAjoY5BroL9b
<span style=color:#f92672>+</span>Cdc05ksRRSyd37A1C6sbLepbKyzvUmbzTUfv78CgYAqvRPo2HdxkSiHOVTAL9H<span style=color:#f92672>/</span>
sWgatBBQI5O8MScF<span style=color:#f92672>+</span>KPuadgHN8RdYdiFCKw3JIKbgI<span style=color:#f92672>/</span>EL0xASLJtDskXNKMcYuI8
m0uModq7bDbfRZz7uQ<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>Z<span style=color:#f92672>/</span>xTPty0aYJ3dUqGdOalNT<span style=color:#f92672>+</span>YgUQdeMEZAm5yY4pkHIMS
JDbR5P9uVc0yWCVQts6swQKBgQC1QfKNDtJhddh3YdfKwO<span style=color:#f92672>/</span>zkJVFurj1nconLn9k
AnNGDk4Dr3TApRFd83aCdpduZjiEty8YIH3cH<span style=color:#f92672>/</span>QLElXok5nZG2C<span style=color:#f92672>/</span>yRtLRll9kAgC
<span style=color:#ae81ff>8</span>O19XsJa2<span style=color:#f92672>+</span>lXgjAadzmIYEhhDG<span style=color:#f92672>/</span>WQuGLVs1FV6BzCfDRD<span style=color:#f92672>/</span>SRKyt<span style=color:#f92672>+</span>vsPDbZyLO<span style=color:#f92672>+</span>mW
<span style=color:#ae81ff>0</span>rQ49wKBgQDhWlAtmZKN12tfvHWpnbhj4rfBaSFpYRh4AimgQJyPvjzy<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>Edw7i5
YAJosFtocanOpnKbYaZCng5wFra9e9<span style=color:#f92672>+</span>vwd66Ab80o<span style=color:#f92672>/</span>ZzAtuNtyxh1<span style=color:#f92672>+</span>LP2c<span style=color:#f92672>+</span>XCl8W
dgF4cl4wkopwQ6f8dauG7dKGsP4NunUoXjJO<span style=color:#f92672>/</span>Ky<span style=color:#f92672>+</span>PcFgzrAeJ3Z8xA<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END RSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>分离出公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>in rsaprivatekey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out rsapublickey.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuvYWXiZ7esG<span style=color:#f92672>+</span>Vv<span style=color:#f92672>/</span>aiOSw
oXV1bURTUimwUumQm1N0lOsy0BC4yxxjhPxz5UNHCUIGFp39Ux6BRRKxAeD<span style=color:#f92672>+</span>J13A
Ate6Ge<span style=color:#f92672>+</span>hU3hS<span style=color:#f92672>+</span>b1TN55oVpdTX6Er1GzpnL6bn<span style=color:#f92672>/</span>ZCGR7Rd4ml9H58<span style=color:#f92672>+</span>n6SKowDRecB
YQkuOgMkInLl36dHCuvG65h3KYdTEmhkb8IjUQAMGjGcbJpkAnjmP5k6RxY<span style=color:#75715e>//sx9
</span><span style=color:#75715e></span><span style=color:#f92672>/</span>o<span style=color:#f92672>/</span>kyPKiYSIJDRVJBShg<span style=color:#f92672>+</span>ADfkuyTqD1jAYl7LSsN4w27KQIV0r606WZbTYcWzM4w
PU30XFvTLDzp7frueSF8hprJiOA<span style=color:#f92672>/</span>D6TDaCPbEx9QXeUCvsGCXhTUl7sKkNSSA9jW
<span style=color:#f92672>/</span>wIDAQAB
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>指定 RSASSA-PSS 标准</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 指定 RSASSA-PSS 标准
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>sign rsaprivatekey.pem <span style=color:#f92672>-</span>sigopt rsa_padding_mode:pss <span style=color:#f92672>-</span>out signature.txt plain.txt
</code></pre></div><p>打开 signature.txt 文件，里面存储的就是签名之后的结果。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>¡°</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>&gt;^</span>W<span style=color:#f92672>-</span><span style=color:#960050;background-color:#1e0010>ý</span><span style=color:#ae81ff>0</span>]<span style=color:#960050;background-color:#1e0010>ê</span><span style=color:#f92672>^</span>Qnà<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>90</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>97</span><span style=color:#f92672>&gt;</span>N<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>e<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>8</span><span style=color:#f92672>^</span>T<span style=color:#960050;background-color:#1e0010>²»</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>97</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¢</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>d<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¤¯</span><span style=color:#f92672>*</span>S<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>98</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ò</span>.C<span style=color:#960050;background-color:#1e0010>·</span><span style=color:#f92672>=^</span>BñM<span style=color:#960050;background-color:#1e0010>¸</span>bõ<span style=color:#f92672>^</span>[<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>99</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Øã­</span>p<span style=color:#960050;background-color:#1e0010>×</span>V<span style=color:#960050;background-color:#1e0010>²Ð</span><span style=color:#ae81ff>8</span>vz<span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>^</span>Z}<span style=color:#960050;background-color:#1e0010>¹Ô</span>O<span style=color:#960050;background-color:#1e0010>¨õò¬</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>85</span><span style=color:#f92672>&gt;^</span>D<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>c<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¦</span>C<span style=color:#f92672>^</span>W<span style=color:#f92672>^</span>K<span style=color:#960050;background-color:#1e0010>²$</span><span style=color:#f92672>^</span>P<span style=color:#f92672>&amp;</span>BCô<span style=color:#960050;background-color:#1e0010>$</span>Z4<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>b<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¢</span>w<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>c<span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>91</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>þ</span>z<span style=color:#960050;background-color:#1e0010>@×</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>82</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ùáÇ¶µ</span><span style=color:#f92672>&amp;</span><span style=color:#ae81ff>8</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>97</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Í</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>a<span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>95</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>4</span><span style=color:#960050;background-color:#1e0010>ºû</span><span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>É¿#</span><span style=color:#f92672>^</span>X<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>95</span><span style=color:#f92672>&gt;</span>SÜ_s<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>98</span><span style=color:#f92672>&gt;</span>g<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>a<span style=color:#f92672>&gt;</span>lï<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>91</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>92</span><span style=color:#f92672>&gt;</span>gý<span style=color:#f92672>^</span>Bm<span style=color:#f92672>^</span>Yw<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#ae81ff>1L</span>J7<span style=color:#960050;background-color:#1e0010>¹</span>m3<span style=color:#f92672>+&lt;</span><span style=color:#ae81ff>81</span><span style=color:#f92672>&gt;</span>m<span style=color:#960050;background-color:#1e0010>©¥ë\</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>96</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¼</span>BÄØ<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>d<span style=color:#f92672>&gt;</span>vO<span style=color:#960050;background-color:#1e0010>»Ü</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>82</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>98</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¨</span><span style=color:#f92672>^</span>K]<span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>ØÖö</span>P<span style=color:#960050;background-color:#1e0010>¿</span><span style=color:#f92672>^</span>F<span style=color:#f92672>^</span>_[<span style=color:#960050;background-color:#1e0010>Ñã÷Þ</span><span style=color:#ae81ff>3</span><span style=color:#f92672>^^</span>}<span style=color:#f92672>-</span><span style=color:#960050;background-color:#1e0010>´ý</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>84</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>&gt;^</span>E<span style=color:#f92672>^</span>[<span style=color:#960050;background-color:#1e0010>Ö</span>A<span style=color:#f92672>&gt;^</span>NF<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>É</span><span style=color:#f92672>!&lt;</span><span style=color:#ae81ff>8</span>c<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>¿ÿÆ</span>,<span style=color:#960050;background-color:#1e0010>º«õ</span>tãäV8ÿ<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>91</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>8</span>b<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Ã</span>_Å<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ï</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>88</span><span style=color:#f92672>&gt;</span>Q<span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>õ</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>99</span><span style=color:#f92672>&gt;^</span>Uê<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>c<span style=color:#f92672>&gt;&lt;</span><span style=color:#ae81ff>91</span><span style=color:#f92672>&gt;^</span>E)<span style=color:#960050;background-color:#1e0010>Õ$</span>H<span style=color:#960050;background-color:#1e0010>¶</span><span style=color:#e6db74>&#34;ç:hDôU*_FÙ&lt;8a&gt;^LÝU&lt;8f&gt;^H©9%uè^_^C¨V&lt;8d&gt;+yB¨^ZR</span>
</code></pre></div><p>验证签名</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify rsapublickey.pem <span style=color:#f92672>-</span>sigopt rsa_padding_mode:pss <span style=color:#f92672>-</span>signature signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verified OK
</code></pre></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt，或者不用 PSS 模式去校验，以上两种方法都会校验失败。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 更换一个 txt 文件再次验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify rsapublickey.pem <span style=color:#f92672>-</span>sigopt rsa_padding_mode:pss <span style=color:#f92672>-</span>signature signature.txt signature.txt

<span style=color:#75715e>// 不用 PSS 模式验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify rsapublickey.pem <span style=color:#f92672>-</span>signature signature.txt plain.txt
</code></pre></div><p>上面两种方式都会校验失败。</p><h2 id=十openssl-中的-dsa-数字签名>十、OpenSSL 中的 DSA 数字签名</h2><p>使用 OpenSSL 命令了解 DSA 算法。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成参数文件，类似于 DH 参数文件
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dsaparam <span style=color:#f92672>-</span>out dsaparam.pem <span style=color:#ae81ff>1024</span>
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating DSA parameters, <span style=color:#ae81ff>1024</span> bit <span style=color:#66d9ef>long</span> prime
This could take some time
..........<span style=color:#f92672>+</span>..<span style=color:#f92672>+</span>.............................<span style=color:#f92672>+++++++++++++++++++++++++++++++++++++++++++++++++++*</span>
..<span style=color:#f92672>+</span>..<span style=color:#f92672>+</span>....<span style=color:#f92672>+</span>....<span style=color:#f92672>+</span>.<span style=color:#f92672>+</span>....<span style=color:#f92672>+</span>..............<span style=color:#f92672>+</span>.....<span style=color:#f92672>+</span>...<span style=color:#f92672>+</span>.<span style=color:#f92672>+</span>...................<span style=color:#f92672>+</span>.<span style=color:#f92672>+</span>...........<span style=color:#f92672>+</span>.<span style=color:#f92672>+</span>..<span style=color:#f92672>+</span>...<span style=color:#f92672>+++++++++++++++++++++++++++++++++++++++++++++++++++*</span>

<span style=color:#f92672>-----</span>BEGIN DSA PARAMETERS<span style=color:#f92672>-----</span>
MIIBHgKBgQDbXt<span style=color:#f92672>+</span>UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG<span style=color:#f92672>/</span>ukuRkBrg0p7y
Whhd8s<span style=color:#f92672>+</span>As<span style=color:#f92672>+</span>Q0erzE9mQfyKrqnQjAAxBOT<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>rjH4hvYcgg0H<span style=color:#f92672>/</span>uSzWrkRIgZx7<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>dF
dnOEH<span style=color:#f92672>+</span>ORwgQlbxZ<span style=color:#f92672>+</span>p1k<span style=color:#f92672>/</span>Le4rJh<span style=color:#f92672>/</span>dTARRbAjCa<span style=color:#f92672>+</span>YkAU9ZL8cGnsQvWQIVAJ8v<span style=color:#f92672>+</span>YVH
YjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al<span style=color:#f92672>/</span>P<span style=color:#f92672>+</span>W<span style=color:#f92672>/</span>KfxTrp3TmMFwImWG<span style=color:#f92672>+</span>Fqd
GVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3dexWY
ejEeWDa1nCERqAL9r<span style=color:#f92672>/</span>eO5QldwSgw6muCjNA<span style=color:#f92672>/</span>A7eghz1E5KQxjYkRQGLdYx<span style=color:#f92672>+</span>fbC1N
ge4<span style=color:#f92672>=</span>
<span style=color:#f92672>-----</span>END DSA PARAMETERS<span style=color:#f92672>-----</span>
</code></pre></div><p>生成密钥对</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 通过参数文件生成密钥对 dsaprivatekey.pem
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl gendsa <span style=color:#f92672>-</span>out dsaprivatekey.pem dsaparam.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating DSA key, <span style=color:#ae81ff>1024</span> bits

<span style=color:#f92672>-----</span>BEGIN DSA PRIVATE KEY<span style=color:#f92672>-----</span>
MIIBuwIBAAKBgQDbXt<span style=color:#f92672>+</span>UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG<span style=color:#f92672>/</span>ukuRkBrg
<span style=color:#ae81ff>0</span>p7yWhhd8s<span style=color:#f92672>+</span>As<span style=color:#f92672>+</span>Q0erzE9mQfyKrqnQjAAxBOT<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>rjH4hvYcgg0H<span style=color:#f92672>/</span>uSzWrkRIgZx7
<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>dFdnOEH<span style=color:#f92672>+</span>ORwgQlbxZ<span style=color:#f92672>+</span>p1k<span style=color:#f92672>/</span>Le4rJh<span style=color:#f92672>/</span>dTARRbAjCa<span style=color:#f92672>+</span>YkAU9ZL8cGnsQvWQIVAJ8v
<span style=color:#f92672>+</span>YVHYjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al<span style=color:#f92672>/</span>P<span style=color:#f92672>+</span>W<span style=color:#f92672>/</span>KfxTrp3TmMFwImWG
<span style=color:#f92672>+</span>FqdGVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3d
exWYejEeWDa1nCERqAL9r<span style=color:#f92672>/</span>eO5QldwSgw6muCjNA<span style=color:#f92672>/</span>A7eghz1E5KQxjYkRQGLdYx<span style=color:#f92672>+</span>f
bC1Nge4CgYB6o8lSB4HkznXMyVkByLeRo5IE<span style=color:#f92672>+</span>IQqKcFtM4kD6d4ZukcI2IUHp7bI
jYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz<span style=color:#f92672>/</span>P2<span style=color:#f92672>+</span>pWiyCzhJ1CXHlQzwpOIAKuOq
ojwlykrYBZuPuD0Bpo2kUJKyua<span style=color:#f92672>/</span>Te1b8cfElVMyr7OrCN0HIBIHovQIVAJbryCYW
<span style=color:#ae81ff>7</span>s9I2PGsiuz758FMjZ9Z
<span style=color:#f92672>-----</span>END DSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>对私钥文件进行加密</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 对私钥对文件使用 des3 算法进行加密
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl gendsa <span style=color:#f92672>-</span>out dsaprivatekey2.pem <span style=color:#f92672>-</span>des3 dsaparam.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating DSA key, <span style=color:#ae81ff>1024</span> bits
Enter PEM pass phrase:
Verifying <span style=color:#f92672>-</span> Enter PEM pass phrase:

<span style=color:#f92672>----</span>BEGIN DSA PRIVATE KEY<span style=color:#f92672>-----</span>
Proc<span style=color:#f92672>-</span>Type: <span style=color:#ae81ff>4</span>,ENCRYPTED
DEK<span style=color:#f92672>-</span>Info: DES<span style=color:#f92672>-</span>EDE3<span style=color:#f92672>-</span>CBC,E06226CA00C80472

xTbh4VYy44X<span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>sZMmUfuPua9VtunXtcdJ3soFHvjpjBaCgn64<span style=color:#f92672>/</span>nVbGQYBV1t6TY0
Poic5LmZ<span style=color:#f92672>+</span>ooVCAxC9EkUid<span style=color:#f92672>+</span>TzZ3qCWwI3Pdagj8YoNWrak6ayj6j00EZ2HQNs3eI
j2lyIpyetpJCziGvohveEnmFEU6k7DSKdgpJtZv2yayK4L19r8AIcGlgO<span style=color:#f92672>/</span>o125qH
VP4vJvoEAuFMrxXJP3NgJ0ZcF9fffAZz6sV<span style=color:#f92672>+</span>lHGVb6B8rWptWwP9QRNGNfdqa5T9
RJAbZrYpvyBlewljDXscB34eYo6PrlItlTWImvJ<span style=color:#f92672>+</span>KrVA8QLpYditIcjjdlNDYvRq
eC7sgyDGaKNBSk<span style=color:#f92672>+</span>DDQ5ZKQaI9MEPi34kAqp<span style=color:#f92672>+</span>esv083WbnXhCkkSzcu5sacxPJJQN
XK0nxP3YSWY7w0L<span style=color:#f92672>/</span>cDzxnsaT0gl<span style=color:#f92672>+</span>l3AFvUxDge97iq3hmDGt6BSqLzAQAcn4VDnx
Hc0OQKm3hZalej6iLNenf84SWxC7dc0cRgfReMOXhjik<span style=color:#f92672>+</span>PsN4eturhDkGzapiHW2
YLVG15f<span style=color:#f92672>+/</span>XEknnvW5RQ8ttTPB47O7UFxxt4JLw4KE3nsDkGYFweEOwffVWFo3MH8
<span style=color:#f92672>+</span>uYhp<span style=color:#f92672>/</span>Inu8Z0bTVUCm5bSA<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END DSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>提取公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 通过密钥对文件拆分出公钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dsa <span style=color:#f92672>-</span>in dsaprivatekey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out dsapublickey.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>read DSA key
writing DSA key

<span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBtjCCASsGByqGSM44BAEwggEeAoGBANte35Q3GwzYokZHmrvq6pYOCZkpJXe<span style=color:#f92672>+</span>
it2Op3CKsb<span style=color:#f92672>+</span><span style=color:#ae81ff>6</span>S5GQGuDSnvJaGF3yz4Cz5DR6vMT2ZB<span style=color:#f92672>/</span>IquqdCMADEE5P<span style=color:#f92672>/</span><span style=color:#ae81ff>2u</span>MfiG9
hyCDQf<span style=color:#f92672>+</span><span style=color:#ae81ff>5L</span>NauREiBnHv<span style=color:#f92672>/</span>x0V2c4Qf45HCBCVvFn6nWT8t7ismH91MBFFsCMJr5iQB
T1kvxwaexC9ZAhUAny<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span>hUdiMICk2cuMQFVFMXiS9KkCgYB5qunlaLwG0LvtqX8<span style=color:#f92672>/</span>
<span style=color:#ae81ff>5</span>b8p<span style=color:#f92672>/</span>FOundOYwXAiZYb4Wp0ZVrimiqFgRwUZJpmyucVkY7BPQ<span style=color:#f92672>+</span>AUu8ULOTPSx<span style=color:#f92672>+</span>fQ
<span style=color:#ae81ff>55</span>PuFpIjCvyVVydcvd17FZh6MR5YNrWcIRGoAv2v947lCV3BKDDqa4KM0D8Dt6CH
PUTkpDGNiRFAYt1jH59sLU2B7gOBhAACgYB6o8lSB4HkznXMyVkByLeRo5IE<span style=color:#f92672>+</span>IQq
KcFtM4kD6d4ZukcI2IUHp7bIjYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz<span style=color:#f92672>/</span>P2<span style=color:#f92672>+</span>
pWiyCzhJ1CXHlQzwpOIAKuOqojwlykrYBZuPuD0Bpo2kUJKyua<span style=color:#f92672>/</span>Te1b8cfElVMyr
<span style=color:#ae81ff>7</span>OrCN0HIBIHovQ<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>查看私钥文件的信息</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 查看三个公共参数、公钥、私钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dsa <span style=color:#f92672>-</span>in dsaprivatekey.pem <span style=color:#f92672>-</span>text
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>read DSA key
Private<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>1024</span> bit)
priv:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>96</span><span style=color:#f92672>:</span>eb:c8:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span>ee:cf:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span>d8:f1:ac:<span style=color:#ae81ff>8</span>a:ec:fb:
    e7:c1:<span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>59</span>
pub:
    <span style=color:#ae81ff>7</span>a:a3:c9:<span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>e4:ce:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>cc:c9:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>c8:b7:
    <span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>04</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>84</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>e9:de:
    <span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>ba:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>d8:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span>a7:b6:c8:<span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span>dc:
    <span style=color:#ae81ff>9</span>a:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>f0:<span style=color:#ae81ff>3</span>d:c0:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span>e9:<span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>f7:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>df:d4:b3:fc:fd:be:a5:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>b2:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>38</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>49</span><span style=color:#f92672>:</span>d4:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>c:f0:a4:e2:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:e3:aa:a2:<span style=color:#ae81ff>3</span>c:
    <span style=color:#ae81ff>25</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>4</span>a:d8:<span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span>b8:<span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>a6:<span style=color:#ae81ff>8</span>d:a4:<span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
    b2:b9:af:d3:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>56</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span>f1:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>cc:ab:ec:ea:
    c2:<span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>c8:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>e8:bd
P:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>db:<span style=color:#ae81ff>5</span>e:df:<span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>0</span>c:d8:a2:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:bb:ea:
    ea:<span style=color:#ae81ff>96</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>be:<span style=color:#ae81ff>8</span>a:dd:<span style=color:#ae81ff>8</span>e:a7:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>a:
    b1:bf:ba:<span style=color:#ae81ff>4</span>b:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:e0:d2:<span style=color:#ae81ff>9</span>e:f2:<span style=color:#ae81ff>5</span>a:<span style=color:#ae81ff>18</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:f2:
    cf:<span style=color:#ae81ff>80</span><span style=color:#f92672>:</span>b3:e4:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:bc:c4:f6:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>c8:aa:ea:<span style=color:#ae81ff>9</span>d:
    <span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>c0:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>e:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>ff:<span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span>bd:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>83</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>ff:b9:<span style=color:#ae81ff>2</span>c:d6:ae:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>7</span>b:ff:c7:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>e3:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:a7:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:
    ee:<span style=color:#ae81ff>2</span>b:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>dd:<span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>51</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>6</span>b:e6:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>e:c4:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>59</span>
Q:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span>f9:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span><span style=color:#ae81ff>80</span><span style=color:#f92672>:</span>a4:d9:cb:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>f4:a9
G:
    <span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>aa:e9:e5:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>bc:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span>d0:bb:ed:a9:<span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>e5:bf:
    <span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>53</span><span style=color:#f92672>:</span>ae:<span style=color:#ae81ff>9</span>d:d3:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>86</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>5</span>a:<span style=color:#ae81ff>9</span>d:
    <span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span>b8:a6:<span style=color:#ae81ff>8</span>a:a1:<span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span>b2:b9:c5:
    <span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span>b0:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>e0:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span>bb:c5:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>d2:c7:e7:
    d0:e7:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span>ee:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:fc:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:bd:dd:
    <span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span>b5:<span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>a8:<span style=color:#ae81ff>02</span><span style=color:#f92672>:</span>fd:
    af:f7:<span style=color:#ae81ff>8</span>e:e5:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:c1:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>ea:<span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:d0:<span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>b7:a0:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span>e4:a4:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span><span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span>dd:
    <span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>4</span>d:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>ee
writing DSA key
<span style=color:#f92672>-----</span>BEGIN DSA PRIVATE KEY<span style=color:#f92672>-----</span>
MIIBuwIBAAKBgQDbXt<span style=color:#f92672>+</span>UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG<span style=color:#f92672>/</span>ukuRkBrg
<span style=color:#ae81ff>0</span>p7yWhhd8s<span style=color:#f92672>+</span>As<span style=color:#f92672>+</span>Q0erzE9mQfyKrqnQjAAxBOT<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>rjH4hvYcgg0H<span style=color:#f92672>/</span>uSzWrkRIgZx7
<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>dFdnOEH<span style=color:#f92672>+</span>ORwgQlbxZ<span style=color:#f92672>+</span>p1k<span style=color:#f92672>/</span>Le4rJh<span style=color:#f92672>/</span>dTARRbAjCa<span style=color:#f92672>+</span>YkAU9ZL8cGnsQvWQIVAJ8v
<span style=color:#f92672>+</span>YVHYjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al<span style=color:#f92672>/</span>P<span style=color:#f92672>+</span>W<span style=color:#f92672>/</span>KfxTrp3TmMFwImWG
<span style=color:#f92672>+</span>FqdGVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3d
exWYejEeWDa1nCERqAL9r<span style=color:#f92672>/</span>eO5QldwSgw6muCjNA<span style=color:#f92672>/</span>A7eghz1E5KQxjYkRQGLdYx<span style=color:#f92672>+</span>f
bC1Nge4CgYB6o8lSB4HkznXMyVkByLeRo5IE<span style=color:#f92672>+</span>IQqKcFtM4kD6d4ZukcI2IUHp7bI
jYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz<span style=color:#f92672>/</span>P2<span style=color:#f92672>+</span>pWiyCzhJ1CXHlQzwpOIAKuOq
ojwlykrYBZuPuD0Bpo2kUJKyua<span style=color:#f92672>/</span>Te1b8cfElVMyr7OrCN0HIBIHovQIVAJbryCYW
<span style=color:#ae81ff>7</span>s9I2PGsiuz758FMjZ9Z
<span style=color:#f92672>-----</span>END DSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>priv 和 pub 相当于密钥对中的私钥和公钥，P、Q、G 都是参数文件中的三个关键参数，这是 DSA 算法的关键。</p><p>既然可以查看私钥文件的信息，同理可以查看公钥文件的信息。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 查看公钥和文件的信息
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dsa <span style=color:#f92672>-</span>pubin <span style=color:#f92672>-</span>in dsapublickey.pem <span style=color:#f92672>-</span>text
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>read DSA key
pub:
    <span style=color:#ae81ff>7</span>a:a3:c9:<span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>e4:ce:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>cc:c9:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>c8:b7:
    <span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>04</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>84</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>e9:de:
    <span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>ba:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>d8:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span>a7:b6:c8:<span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span>dc:
    <span style=color:#ae81ff>9</span>a:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>f0:<span style=color:#ae81ff>3</span>d:c0:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span>e9:<span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>f7:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>df:d4:b3:fc:fd:be:a5:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>b2:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>38</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>49</span><span style=color:#f92672>:</span>d4:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>c:f0:a4:e2:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:e3:aa:a2:<span style=color:#ae81ff>3</span>c:
    <span style=color:#ae81ff>25</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>4</span>a:d8:<span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span>b8:<span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>a6:<span style=color:#ae81ff>8</span>d:a4:<span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
    b2:b9:af:d3:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>56</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span>f1:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>cc:ab:ec:ea:
    c2:<span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>c8:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>e8:bd
P:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>db:<span style=color:#ae81ff>5</span>e:df:<span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>0</span>c:d8:a2:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:bb:ea:
    ea:<span style=color:#ae81ff>96</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>be:<span style=color:#ae81ff>8</span>a:dd:<span style=color:#ae81ff>8</span>e:a7:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>a:
    b1:bf:ba:<span style=color:#ae81ff>4</span>b:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:e0:d2:<span style=color:#ae81ff>9</span>e:f2:<span style=color:#ae81ff>5</span>a:<span style=color:#ae81ff>18</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:f2:
    cf:<span style=color:#ae81ff>80</span><span style=color:#f92672>:</span>b3:e4:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:bc:c4:f6:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>c8:aa:ea:<span style=color:#ae81ff>9</span>d:
    <span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>c0:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>e:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>ff:<span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span>bd:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>83</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>ff:b9:<span style=color:#ae81ff>2</span>c:d6:ae:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>7</span>b:ff:c7:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>e3:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:a7:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:
    ee:<span style=color:#ae81ff>2</span>b:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>dd:<span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>51</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>6</span>b:e6:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>e:c4:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>59</span>
Q:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span>f9:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span><span style=color:#ae81ff>80</span><span style=color:#f92672>:</span>a4:d9:cb:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>f4:a9
G:
    <span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>aa:e9:e5:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>bc:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span>d0:bb:ed:a9:<span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>e5:bf:
    <span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>53</span><span style=color:#f92672>:</span>ae:<span style=color:#ae81ff>9</span>d:d3:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>86</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>5</span>a:<span style=color:#ae81ff>9</span>d:
    <span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span>b8:a6:<span style=color:#ae81ff>8</span>a:a1:<span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span>b2:b9:c5:
    <span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span>b0:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>e0:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span>bb:c5:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>d2:c7:e7:
    d0:e7:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span>ee:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:fc:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:bd:dd:
    <span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span>b5:<span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>a8:<span style=color:#ae81ff>02</span><span style=color:#f92672>:</span>fd:
    af:f7:<span style=color:#ae81ff>8</span>e:e5:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:c1:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>ea:<span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:d0:<span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>b7:a0:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span>e4:a4:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span><span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span>dd:
    <span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>4</span>d:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>ee
writing DSA key
<span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBtjCCASsGByqGSM44BAEwggEeAoGBANte35Q3GwzYokZHmrvq6pYOCZkpJXe<span style=color:#f92672>+</span>
it2Op3CKsb<span style=color:#f92672>+</span><span style=color:#ae81ff>6</span>S5GQGuDSnvJaGF3yz4Cz5DR6vMT2ZB<span style=color:#f92672>/</span>IquqdCMADEE5P<span style=color:#f92672>/</span><span style=color:#ae81ff>2u</span>MfiG9
hyCDQf<span style=color:#f92672>+</span><span style=color:#ae81ff>5L</span>NauREiBnHv<span style=color:#f92672>/</span>x0V2c4Qf45HCBCVvFn6nWT8t7ismH91MBFFsCMJr5iQB
T1kvxwaexC9ZAhUAny<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span>hUdiMICk2cuMQFVFMXiS9KkCgYB5qunlaLwG0LvtqX8<span style=color:#f92672>/</span>
<span style=color:#ae81ff>5</span>b8p<span style=color:#f92672>/</span>FOundOYwXAiZYb4Wp0ZVrimiqFgRwUZJpmyucVkY7BPQ<span style=color:#f92672>+</span>AUu8ULOTPSx<span style=color:#f92672>+</span>fQ
<span style=color:#ae81ff>55</span>PuFpIjCvyVVydcvd17FZh6MR5YNrWcIRGoAv2v947lCV3BKDDqa4KM0D8Dt6CH
PUTkpDGNiRFAYt1jH59sLU2B7gOBhAACgYB6o8lSB4HkznXMyVkByLeRo5IE<span style=color:#f92672>+</span>IQq
KcFtM4kD6d4ZukcI2IUHp7bIjYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz<span style=color:#f92672>/</span>P2<span style=color:#f92672>+</span>
pWiyCzhJ1CXHlQzwpOIAKuOqojwlykrYBZuPuD0Bpo2kUJKyua<span style=color:#f92672>/</span>Te1b8cfElVMyr
<span style=color:#ae81ff>7</span>OrCN0HIBIHovQ<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>输出的内容中，pub、P、Q、G 四个参数和私钥输出的内容是一致的。</p><p>最后验证 DSA 签名算法。这里和 RSA 是差不多的</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// DSA 进行签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>sign dsaprivatekey.pem <span style=color:#f92672>-</span>out signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#ae81ff>0</span><span style=color:#f92672>-^</span>B<span style=color:#f92672>^</span>T<span style=color:#f92672>^</span>QÉ:wÇ<span style=color:#f92672>^</span>K<span style=color:#f92672>^</span>F<span style=color:#f92672>^</span>AÆ<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>88</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Ê</span><span style=color:#f92672>^</span>C<span style=color:#f92672>!</span><span style=color:#ae81ff>0</span>Hø<span style=color:#f92672>&gt;</span>,<span style=color:#960050;background-color:#1e0010>$</span><span style=color:#f92672>^</span>W<span style=color:#f92672>^</span>B<span style=color:#f92672>^</span>U<span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>d<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Ù</span>y
<span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>@</span>H<span style=color:#f92672>^</span>W<span style=color:#f92672>^</span>W<span style=color:#f92672>^</span>Dàø<span style=color:#960050;background-color:#1e0010>&#39;</span>mqî_}<span style=color:#f92672>^</span>Y<span style=color:#960050;background-color:#1e0010>¹</span>m
</code></pre></div><p>校验签名</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify dsapublickey.pem <span style=color:#f92672>-</span>signature signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verified OK
</code></pre></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 更换一个 txt 文件再次验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify dsapublickey.pem <span style=color:#f92672>-</span>signature signature.txt signature.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verification Failure
</code></pre></div><h2 id=十openssl-中的-ecdsa-数字签名>十、OpenSSL 中的 ECDSA 数字签名</h2><p>生成 ECDSA 私钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 直接生成 ECDSA 私钥，不用预先生成 ECC 参数文件
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>name secp256k1 <span style=color:#f92672>-</span>genkey <span style=color:#f92672>-</span>out ecdsa_priv.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// secp256k1.pem
</span><span style=color:#75715e></span><span style=color:#f92672>-----</span>BEGIN EC PARAMETERS<span style=color:#f92672>-----</span>
BgUrgQQACg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END EC PARAMETERS<span style=color:#f92672>-----</span>

<span style=color:#75715e>// ecdsa_priv.pem
</span><span style=color:#75715e></span><span style=color:#f92672>-----</span>BEGIN EC PARAMETERS<span style=color:#f92672>-----</span>
BgUrgQQACg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END EC PARAMETERS<span style=color:#f92672>-----</span>
<span style=color:#f92672>-----</span>BEGIN EC PRIVATE KEY<span style=color:#f92672>-----</span>
MHQCAQEEIAU0ftIIbLdCROYOZcGcc<span style=color:#f92672>+</span><span style=color:#ae81ff>4</span>JjAsTvYI1pH9Ejbx57k1UoAcGBSuBBAAK
oUQDQgAEKNlv9Lyu406<span style=color:#f92672>/</span>hmj4r3ZfmtisJUvPThCasMGySrR4mST8LxLeO6NpsmKL
OVSNQgleZw6fu2ktLGFtObKTeu6z9w<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END EC PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>显示私钥信息</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 显示私钥信息
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ec <span style=color:#f92672>-</span>in ecdsa_priv.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>read EC key
Private<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>256</span> bit)
priv:
    <span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>34</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:d2:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:b7:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span>e6:<span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span>
    ee:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span>bd:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>35</span><span style=color:#f92672>:</span>a4:<span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>d:bc:<span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>ee:
    <span style=color:#ae81ff>4</span>d:<span style=color:#ae81ff>54</span>
pub:
    <span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>d9:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span>f4:bc:ae:e3:<span style=color:#ae81ff>4</span>e:bf:<span style=color:#ae81ff>86</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>f8:af:<span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:d8:ac:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>b:cf:<span style=color:#ae81ff>4</span>e:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:b0:c1:b2:<span style=color:#ae81ff>4</span>a:b4:
    <span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>24</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>de:<span style=color:#ae81ff>3</span>b:a3:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span>b2:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>e:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>bb:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span>b2:
    <span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:ee:b3:f7
ASN1 OID: secp256k1
</code></pre></div><p>从输出信息里面可以看到私钥信息和命名曲线的信息，密钥长度是 256 比特。</p><p>接下来获取公钥。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 提取公钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ec <span style=color:#f92672>-</span>in ecdsa_priv.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out ecdsa_pub.pem

<span style=color:#75715e>// 显示公钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ec <span style=color:#f92672>-</span>in ecdsa_pub.pem <span style=color:#f92672>-</span>pubin <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// ecdsa_pub.pem
</span><span style=color:#75715e></span><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MFYwEAYHKoZIzj0CAQYFK4EEAAoDQgAEKNlv9Lyu406<span style=color:#f92672>/</span>hmj4r3ZfmtisJUvPThCa
sMGySrR4mST8LxLeO6NpsmKLOVSNQgleZw6fu2ktLGFtObKTeu6z9w<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>


read EC key
Public<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>256</span> bit)
pub:
    <span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>d9:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span>f4:bc:ae:e3:<span style=color:#ae81ff>4</span>e:bf:<span style=color:#ae81ff>86</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>f8:af:<span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:d8:ac:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>b:cf:<span style=color:#ae81ff>4</span>e:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:b0:c1:b2:<span style=color:#ae81ff>4</span>a:b4:
    <span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>24</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>de:<span style=color:#ae81ff>3</span>b:a3:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span>b2:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>e:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>bb:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span>b2:
    <span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:ee:b3:f7
ASN1 OID: secp256k1
</code></pre></div><p>生成签名</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 选择 sha256 作为 HASH 算法
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>sign ecdsa_priv.pem <span style=color:#f92672>-</span>out signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// signature.txt
</span><span style=color:#75715e></span><span style=color:#ae81ff>0</span>E<span style=color:#f92672>^</span>B JTH}Xi<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>88</span><span style=color:#f92672>&gt;</span>)<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>d<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>&#39;È</span>;<span style=color:#960050;background-color:#1e0010>þÆß</span>e<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>93</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>»Õ¦</span><span style=color:#f92672>|?</span><span style=color:#ae81ff>8</span><span style=color:#f92672>^</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>84</span><span style=color:#f92672>&gt;=</span>gªA)F<span style=color:#f92672>^</span>K<span style=color:#f92672>^</span>B<span style=color:#f92672>!^</span><span style=color:#960050;background-color:#1e0010>@°</span><span style=color:#f92672>^</span>U<span style=color:#960050;background-color:#1e0010>³</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>d<span style=color:#f92672>&gt;</span>F <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>83</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ÐÄµ</span>b<span style=color:#f92672>^^&lt;</span><span style=color:#ae81ff>81</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>ÿ</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>b<span style=color:#f92672>&gt;</span>b<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>92</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>Âæ½</span>M0,<span style=color:#e6db74>&#34;W$G,øÑRW</span>
</code></pre></div><p>校验签名</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 校验签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify ecdsa_pub.pem <span style=color:#f92672>-</span>signature signature.txt plain.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verified OK
</code></pre></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 更换一个 txt 文件再次验证签名
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dgst <span style=color:#f92672>-</span>sha256 <span style=color:#f92672>-</span>verify ecdsa_pub.pem <span style=color:#f92672>-</span>signature signature.txt signature.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Verification Failure
</code></pre></div><p><strong>DSA 签名算法运算比 RSA 签名运算慢很多，但是 ECDSA 签名算法比 RSA 签名生成快的多，ECDSA 签名验证却比 RSA 签名验证相对慢一些</strong>。</p><p>从安全和速度综合考虑，在 DSA 和 ECDSA 中选一个，优先选择 ECDSA。</p><hr><p>Reference：</p><p>《图解密码技术》</p><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://halfrost.com/digital_signature/>https://halfrost.com/digital_signature/</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一为什么需要数字签名>一、为什么需要数字签名？</a></li><li><a href=#二什么是数字签名>二、什么是数字签名？</a></li><li><a href=#三生成和验证数字签名>三、生成和验证数字签名</a><ul><li><a href=#1-直接对消息签名的方法>1. 直接对消息签名的方法</a></li><li><a href=#2-对消息的散列值签名的方法>2. 对消息的散列值签名的方法</a></li></ul></li><li><a href=#四数字签名应用实例>四、数字签名应用实例</a><ul><li><a href=#1-安全信息公告>1. 安全信息公告</a></li><li><a href=#2-软件下载>2. 软件下载</a></li><li><a href=#3-公钥证书>3. 公钥证书</a></li><li><a href=#4-ssltls>4. SSL/TLS</a></li></ul></li><li><a href=#五数字签名的实现方式>五、数字签名的实现方式</a><ul><li><a href=#1-用-rsa-生成签名>1. 用 RSA 生成签名</a></li><li><a href=#2-用-rsa-验证签名>2. 用 RSA 验证签名</a></li></ul></li><li><a href=#六其他几种数字签名>六、其他几种数字签名</a><ul><li><a href=#1-elgamal-方式>1. ElGamal 方式</a></li><li><a href=#2-dsa>2. DSA</a></li><li><a href=#生成-dsa-密钥对>生成 DSA 密钥对</a></li><li><a href=#签名生成>签名生成</a></li><li><a href=#签名验证>签名验证</a></li><li><a href=#3-ecdsa>3. ECDSA</a></li><li><a href=#生成-ecdsa-密钥对>生成 ECDSA 密钥对</a></li><li><a href=#签名生成-1>签名生成</a></li><li><a href=#验证签名>验证签名</a></li><li><a href=#4-rabin-方式>4. Rabin 方式</a></li></ul></li><li><a href=#七对数字签名的攻击>七、对数字签名的攻击</a><ul><li><a href=#1-中间人攻击公钥>1. 中间人攻击公钥</a></li><li><a href=#2-对单向散列函数的攻击>2. 对单向散列函数的攻击</a></li><li><a href=#3-利用数字签名攻击公钥密码>3. 利用数字签名攻击公钥密码</a></li><li><a href=#4-潜在伪造>4. 潜在伪造</a></li><li><a href=#5-其他攻击>5. 其他攻击</a></li></ul></li><li><a href=#八数字签名无法解决的问题>八、数字签名无法解决的问题</a></li><li><a href=#九openssl-中的-rsa-数字签名>九、OpenSSL 中的 RSA 数字签名</a></li><li><a href=#十openssl-中的-dsa-数字签名>十、OpenSSL 中的 DSA 数字签名</a></li><li><a href=#十openssl-中的-ecdsa-数字签名>十、OpenSSL 中的 ECDSA 数字签名</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&text=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&is_video=false&description=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&title=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&name=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d&description=%e4%b8%80%e3%80%81%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%ef%bc%9f%20%e4%bb%8e%e4%b8%8a%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e9%87%8c%e9%9d%a2%e6%88%91%e4%bb%ac%e7%9f%a5%e9%81%93%ef%bc%8c%e6%b6%88%e6%81%af%e8%ae%a4%e8%af%81%e7%a0%81%e5%8f%af%e4%bb%a5%e8%af%86%e5%88%ab%e7%af%a1%e6%94%b9%e6%88%96%e8%80%85%e5%8f%91%e9%80%81%e8%80%85%e8%ba%ab%e4%bb%bd%e6%98%af%e5%90%a6%e8%a2%ab%e4%bc%aa%e8%a3%85%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e5%ae%8c%e6%95%b4%e6%80%a7%ef%bc%8c%e8%bf%98%e5%8f%af%e4%bb%a5%e5%af%b9%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e8%ae%a4%e8%af%81%e3%80%82%e4%bd%86%e6%98%af%e6%b6%88%e6%81%af%e8%ae%a4%e8%af%81%e7%a0%81%e7%9a%84%e7%bc%ba%e9%99%b7%e5%b0%b1%e5%9c%a8%e4%ba%8e%e5%ae%83%e7%9a%84%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e4%b8%8a%e9%9d%a2%e3%80%82%e7%94%b1%e4%ba%8e%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e7%9a%84%e5%8e%9f%e5%9b%a0%ef%bc%8c%e5%af%bc%e8%87%b4%e6%97%a0%e6%b3%95%e9%98%b2%e6%ad%a2%e6%8a%b5%e8%b5%96%e3%80%82%0a%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%b0%b1%e6%98%af%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e6%8a%b5%e8%b5%96%e7%9a%84%e9%97%ae%e9%a2%98%e7%9a%84%e3%80%82%e8%a7%a3%e5%86%b3%e7%9a%84%e6%96%b9%e6%b3%95%e5%b0%b1%e6%98%af%e8%ae%a9%e9%80%9a%e4%bf%a1%e5%8f%8c%e6%96%b9%e7%9a%84%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e4%b8%8d%e5%90%8c%ef%bc%8c%e4%bb%8e%e5%af%86%e9%92%a5%e4%b8%8a%e8%83%bd%e5%8c%ba%e5%88%86%e5%87%ba%e8%b0%81%e6%98%af%e8%b0%81%e3%80%82%0a%e4%ba%8c%e3%80%81%e4%bb%80%e4%b9%88%e6%98%af%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%ef%bc%9f%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9b%b8%e5%bd%93%e4%ba%8e%e7%8e%b0%e5%ae%9e%e4%b8%96%e7%95%8c%e4%b8%ad%e7%9a%84%e7%9b%96%e7%ab%a0%e3%80%81%e7%ad%be%e5%90%8d%e7%9a%84%e5%8a%9f%e8%83%bd%e5%9c%a8%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%96%e7%95%8c%e4%b8%ad%e8%bf%9b%e8%a1%8c%e5%ae%9e%e7%8e%b0%e7%9a%84%e6%8a%80%e6%9c%af%e3%80%82%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%8f%af%e4%bb%a5%e8%af%86%e5%88%ab%e7%af%a1%e6%94%b9%e3%80%81%e4%bc%aa%e8%a3%85%e3%80%81%e9%98%b2%e6%ad%a2%e6%8a%b5%e8%b5%96%e3%80%82%0a%e5%9c%a8%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%ad%ef%bc%8c%e6%9c%89%202%20%e7%a7%8d%e8%a1%8c%e4%b8%ba%ef%bc%9a%0a%20%e7%94%9f%e6%88%90%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e8%a1%8c%e4%b8%ba%20%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e8%a1%8c%e4%b8%ba%20%20%e7%94%9f%e6%88%90%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e6%98%af%e7%94%b1%e6%b6%88%e6%81%af%e5%8f%91%e9%80%81%e8%80%85%e5%ae%8c%e6%88%90%e7%9a%84%ef%bc%8c%e4%b9%9f%e7%a7%b0%e4%b8%ba%e2%80%9c%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e2%80%9d%e3%80%82%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e5%b0%b1%e6%98%af%e6%a0%b9%e6%8d%ae%e6%b6%88%e6%81%af%e5%86%85%e5%ae%b9%e8%ae%a1%e7%ae%97%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e5%80%bc%e3%80%82%0a%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e6%98%af%e7%ac%ac%e4%b8%89%e6%96%b9%e3%80%82%e7%ac%ac%e4%b8%89%e6%96%b9%e9%aa%8c%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e6%9d%a5%e6%ba%90%e6%98%af%e5%90%a6%e5%b1%9e%e4%ba%8e%e5%8f%91%e9%80%81%e8%80%85%e3%80%82%e9%aa%8c%e8%af%81%e7%bb%93%e6%9e%9c%e5%8f%af%e4%bb%a5%e6%98%af%e6%88%90%e5%8a%9f%ef%bc%8c%e4%b9%9f%e5%8f%af%e4%bb%a5%e6%98%af%e5%a4%b1%e8%b4%a5%e3%80%82%0a%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e5%af%b9%e7%ad%be%e5%90%8d%e5%af%86%e9%92%a5%e5%92%8c%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e8%bf%9b%e8%a1%8c%e4%ba%86%e5%8c%ba%e5%88%86%ef%bc%8c%e4%bd%bf%e7%94%a8%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e6%98%af%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e7%9a%84%e3%80%82%e7%ad%be%e5%90%8d%e5%af%86%e9%92%a5%e5%8f%aa%e8%83%bd%e7%94%b1%e7%ad%be%e5%90%8d%e4%ba%ba%e6%8c%81%e6%9c%89%ef%bc%8c%e8%80%8c%e9%aa%8c%e8%af%81%e5%af%86%e9%92%a5%e5%88%99%e6%98%af%e4%bb%bb%e4%bd%95%e9%9c%80%e8%a6%81%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%e7%9a%84%e4%ba%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e6%8c%81%e6%9c%89%e3%80%82%0a%20%20%20%20%e7%a7%81%e9%92%a5%20%e5%85%ac%e9%92%a5%20%20%20%20%20%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%20%e6%8e%a5%e6%94%b6%e8%80%85%e8%a7%a3%e5%af%86%e6%97%b6%e4%bd%bf%e7%94%a8%20%e5%8f%91%e9%80%81%e8%80%85%e5%8a%a0%e5%af%86%e6%97%b6%e4%bd%bf%e7%94%a8%20%20%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%20%e7%ad%be%e5%90%8d%e8%80%85%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%e6%97%b6%e4%bd%bf%e7%94%a8%20%e9%aa%8c%e8%af%81%e8%80%85%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%e6%97%b6%e4%bd%bf%e7%94%a8%20%20%20%e8%b0%81%e6%8c%81%e6%9c%89%e5%af%86%e9%92%a5%ef%bc%9f%20%e4%b8%aa%e4%ba%ba%e6%8c%81%e6%9c%89%20%e5%8f%aa%e8%a6%81%e9%9c%80%e8%a6%81%ef%bc%8c%e4%bb%bb%e4%bd%95%e4%ba%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e6%8c%81%e6%9c%89%20%20%20%20%e4%b8%a5%e6%a0%bc%e7%9a%84%e6%9d%a5%e8%af%b4%ef%bc%8cRSA%20%e7%ae%97%e6%b3%95%e4%b8%ad%e5%85%ac%e9%92%a5%e5%8a%a0%e5%af%86%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e6%ad%a3%e5%a5%bd%e6%98%af%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%8f%8d%e7%9a%84%e5%85%b3%e7%b3%bb%ef%bc%8c%e4%bd%86%e6%98%af%e5%9c%a8%e5%85%b6%e4%bb%96%e5%85%ac%e9%92%a5%e7%ae%97%e6%b3%95%e4%b8%ad%e6%9c%89%e5%8f%af%e8%83%bd%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%8d%e6%98%af%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%8f%8d%e7%9a%84%e5%85%b3%e7%b3%bb%e3%80%82%0a%e5%9c%a8%e5%85%ac%e9%92%a5%e7%ae%97%e6%b3%95%e4%b8%ad%ef%bc%8c%e5%85%ac%e9%92%a5%e7%94%a8%e6%9d%a5%e5%8a%a0%e5%af%86%ef%bc%8c%e7%a7%81%e9%92%a5%e7%94%a8%e6%9d%a5%e8%a7%a3%e5%af%86%e3%80%82%0a%e5%9c%a8%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e4%b8%ad%ef%bc%8c%e5%85%ac%e9%92%a5%e7%94%a8%e6%9d%a5%e8%a7%a3%e5%af%86%28%e9%aa%8c%e8%af%81%e7%ad%be%e5%90%8d%29%ef%bc%8c%e7%a7%81%e9%92%a5%e7%94%a8%e6%9d%a5%e5%8a%a0%e5%af%86%28%e7%94%9f%e6%88%90%e7%ad%be%e5%90%8d%29%e3%80%82%0a%e4%b8%89%e3%80%81%e7%94%9f%e6%88%90%e5%92%8c%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%20%e6%9c%89%e4%b8%a4%e7%a7%8d%e7%94%9f%e6%88%90%e5%92%8c%e9%aa%8c%e8%af%81%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%ef%bc%9a%0a%20%e7%9b%b4%e6%8e%a5%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%e5%af%b9%e6%b6%88%e6%81%af%e7%9a%84%e6%95%a3%e5%88%97%e5%80%bc%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%201.%20%e7%9b%b4%e6%8e%a5%e5%af%b9%e6%b6%88%e6%81%af%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%202.%20%e5%af%b9%e6%b6%88%e6%81%af%e7%9a%84%e6%95%a3%e5%88%97%e5%80%bc%e7%ad%be%e5%90%8d%e7%9a%84%e6%96%b9%e6%b3%95%20%e6%af%94%e8%be%83%e4%b8%8a%e9%9d%a2%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%ef%bc%8c%e4%b8%80%e8%88%ac%e9%83%bd%e4%bc%9a%e4%bd%bf%e7%94%a8%e7%ac%ac%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%e3%80%82%e5%8e%9f%e5%9b%a0%e6%98%af%e5%9b%a0%e4%b8%ba%e7%ac%ac%201%20%e7%a7%8d%e6%96%b9%e6%b3%95%e8%a6%81%e5%af%b9%e6%95%b4%e4%b8%aa%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%80%8c%e4%b8%94%e6%98%af%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%e7%ae%97%e6%b3%95%ef%bc%8c%e9%9d%9e%e5%b8%b8%e8%80%97%e6%97%b6%e3%80%82%e5%88%a9%e7%94%a8%e7%ae%80%e7%9f%ad%e7%9a%84%e5%8d%95%e5%90%91%e6%95%a3%e5%88%97%e5%87%bd%e6%95%b0%e6%9d%a5%e6%9b%bf%e4%bb%a3%e6%b6%88%e6%81%af%e6%9c%ac%e8%ba%ab%e3%80%82%e5%86%8d%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%28%e5%af%b9%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e7%ad%be%e5%90%8d%29%ef%bc%8c%e4%bc%9a%e5%bf%ab%e5%be%88%e5%a4%9a%e3%80%82%0a%e5%af%b9%e4%b8%8a%e9%9d%a2%e7%9a%84%202%20%e7%a7%8d%e6%96%b9%e6%b3%95%ef%bc%8c%e6%9c%89%e4%b8%80%e4%ba%9b%e5%85%b1%e6%80%a7%e7%9a%84%e9%97%ae%e9%a2%98%e8%bf%9b%e8%a1%8c%e8%a7%a3%e9%87%8a%ef%bc%9a%0a%20%20%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8a%a0%e5%af%86%e4%bb%a5%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e8%83%bd%e5%a4%9f%e5%85%b7%e5%a4%87%e7%ad%be%e5%90%8d%e7%9a%84%e6%84%8f%e4%b9%89%ef%bc%9f%0a%20%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e6%98%af%e5%88%a9%e7%94%a8%e4%ba%86%20%e2%80%9c%e6%b2%a1%e6%9c%89%e7%a7%81%e9%92%a5%e7%9a%84%e4%ba%ba%e5%b0%b1%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e4%bd%bf%e7%94%a8%e8%af%a5%e7%a7%81%e9%92%a5%e6%89%80%e7%94%9f%e6%88%90%e7%9a%84%e5%af%86%e6%96%87%e2%80%9d%20%e8%bf%99%e4%b8%80%e6%80%a7%e8%b4%a8%e6%9d%a5%e5%ae%9e%e7%8e%b0%e7%9a%84%e3%80%82%e7%94%9f%e6%88%90%e7%9a%84%e5%af%86%e6%96%87%e5%b9%b6%e9%9d%9e%e6%98%af%e7%94%a8%e4%ba%8e%e4%bf%9d%e8%af%81%e6%9c%ba%e5%af%86%e6%80%a7%ef%bc%8c%e8%80%8c%e6%98%af%e7%94%a8%e4%ba%8e%e4%bb%a3%e8%a1%a8%e4%b8%80%e7%a7%8d%e5%8f%aa%e6%9c%89%e6%8c%81%e6%9c%89%e8%af%a5%e5%af%86%e9%92%a5%e7%9a%84%e4%ba%ba%e6%89%8d%e8%83%bd%e7%94%9f%e6%88%90%e7%9a%84%e4%bf%a1%e6%81%af%e3%80%82%e6%89%80%e4%bb%a5%e7%a7%81%e9%92%a5%e4%ba%a7%e7%94%9f%e7%9a%84%e5%af%86%e6%96%87%e6%98%af%e4%b8%80%e7%a7%8d%e8%ae%a4%e8%af%81%e7%ac%a6%e5%8f%b7%28authenticator%29%e3%80%82%20%20%20%20%e4%b8%8a%e9%9d%a2%e6%96%b9%e6%b3%95%202%20%e4%b8%ad%e6%b6%88%e6%81%af%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%e5%b0%b1%e7%9b%b4%e6%8e%a5%e5%8f%91%e9%80%81%e4%ba%86%ef%bc%8c%e8%bf%99%e6%a0%b7%e4%b8%8d%e5%b0%b1%e6%b2%a1%e6%b3%95%e4%bf%9d%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e6%9c%ba%e5%af%86%e6%80%a7%e4%ba%86%e4%b9%88%ef%bc%9f"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fdigital_signature%2f&t=%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8%e7%9a%84%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>