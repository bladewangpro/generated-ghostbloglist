<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>TLS & DTLS Heartbeat Extension | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="TLS & DTLS Heartbeat Extension"><meta property="og:description" content="这篇文章我们主要来讨论讨论 Transport Layer Security (TLS) 和 Datagram Transport Layer Security (DTLS) 中的 Heartbeat 扩展。
Heartbeat 扩展为 TLS/DTLS 提供了一种新的协议，允许在不需要重协商的情况下，使用 keep-alive 功能。Heartbeat 扩展也为 path MTU (PMTU) 发现提供了基础。
一. Introduction 这篇文章描述了 [RFC5246] 和 [RFC6347] 中定义的传输层安全性 (TLS) 和数据报传输层安全性 (DTLS) 协议的心跳扩展，以及它们对 [RFC3436]，[RFC5238] 和 [RFC6083] 中描述的特定传输协议的适应性。
DTLS 协议设计的目的是，保护在不可靠的传输协议之上运行的流量数据。通常，此类协议没有会话管理。DTLS 层可用于确定对等方是否仍然 alive 的唯一机制是昂贵的重新协商机制，尤其是当应用程序使用单向流量时。此外，DTLS 需要执行路径 MTU (PMTU) 发现，但在不影响用户消息的传输的情况下，没有特定的消息类型来实现 PMTU 发现。
TLS 是基于可靠的协议，但没有必要的功能可以在没有连续数据传输的情况下保持连接存活。
本文中描述的心跳扩展克服了这些限制。用户可以使用新的 HeartbeatRequest 消息，该消息必须由具有 HeartbeartResponse 的对端立即应答。要执行 PMTU 发现，如 RFC4821 中所述，可以将包含填充的 HeartbeatRequest 消息用作探测包。
二. Heartbeat Hello Extension Hello Extensions 表示支持 Heartbeats。对端不仅可以表明其实现支持Heartbeats，还可以选择是否愿意接收 HeartbeatRequest 消息并使用 HeartbeatResponse 消息进行响应或仅发送 HeartbeatRequest 消息。前者通过使用 peer_allowed_to_send 作为 HeartbeatMode 来表示;后者通过使用 peer_not_allowed_to_send 作为心跳模式来表示。每次重新谈判都可以改变这一决定。HeartbeatRequest 消息禁止发送到已经表明了 peer_not_allowed_to_send 的对端。如果已经表明了 peer_not_allowed_to_send 的端点收到 HeartbeatRequest 消息，则端点应该以静默方式丢弃该消息，并且可以发送 unexpected_message Alert 消息。"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/tls_heartbeat/"><meta property="article:published_time" content="2019-01-06T05:14:00+00:00"><meta property="article:modified_time" content="2019-01-06T05:14:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="TLS & DTLS Heartbeat Extension"><meta name=twitter:description content="这篇文章我们主要来讨论讨论 Transport Layer Security (TLS) 和 Datagram Transport Layer Security (DTLS) 中的 Heartbeat 扩展。
Heartbeat 扩展为 TLS/DTLS 提供了一种新的协议，允许在不需要重协商的情况下，使用 keep-alive 功能。Heartbeat 扩展也为 path MTU (PMTU) 发现提供了基础。
一. Introduction 这篇文章描述了 [RFC5246] 和 [RFC6347] 中定义的传输层安全性 (TLS) 和数据报传输层安全性 (DTLS) 协议的心跳扩展，以及它们对 [RFC3436]，[RFC5238] 和 [RFC6083] 中描述的特定传输协议的适应性。
DTLS 协议设计的目的是，保护在不可靠的传输协议之上运行的流量数据。通常，此类协议没有会话管理。DTLS 层可用于确定对等方是否仍然 alive 的唯一机制是昂贵的重新协商机制，尤其是当应用程序使用单向流量时。此外，DTLS 需要执行路径 MTU (PMTU) 发现，但在不影响用户消息的传输的情况下，没有特定的消息类型来实现 PMTU 发现。
TLS 是基于可靠的协议，但没有必要的功能可以在没有连续数据传输的情况下保持连接存活。
本文中描述的心跳扩展克服了这些限制。用户可以使用新的 HeartbeatRequest 消息，该消息必须由具有 HeartbeartResponse 的对端立即应答。要执行 PMTU 发现，如 RFC4821 中所述，可以将包含填充的 HeartbeatRequest 消息用作探测包。
二. Heartbeat Hello Extension Hello Extensions 表示支持 Heartbeats。对端不仅可以表明其实现支持Heartbeats，还可以选择是否愿意接收 HeartbeatRequest 消息并使用 HeartbeatResponse 消息进行响应或仅发送 HeartbeatRequest 消息。前者通过使用 peer_allowed_to_send 作为 HeartbeatMode 来表示;后者通过使用 peer_not_allowed_to_send 作为心跳模式来表示。每次重新谈判都可以改变这一决定。HeartbeatRequest 消息禁止发送到已经表明了 peer_not_allowed_to_send 的对端。如果已经表明了 peer_not_allowed_to_send 的端点收到 HeartbeatRequest 消息，则端点应该以静默方式丢弃该消息，并且可以发送 unexpected_message Alert 消息。"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/tls_1-3_rfc8446/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/https-begin/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&text=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&is_video=false&description=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TLS%20%26%20DTLS%20Heartbeat%20Extension&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&name=TLS%20%26%20DTLS%20Heartbeat%20Extension&description=%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%88%91%e4%bb%ac%e4%b8%bb%e8%a6%81%e6%9d%a5%e8%ae%a8%e8%ae%ba%e8%ae%a8%e8%ae%ba%20Transport%20Layer%20Security%20%28TLS%29%20%e5%92%8c%20Datagram%20Transport%20Layer%20Security%20%28DTLS%29%20%e4%b8%ad%e7%9a%84%20Heartbeat%20%e6%89%a9%e5%b1%95%e3%80%82%0aHeartbeat%20%e6%89%a9%e5%b1%95%e4%b8%ba%20TLS%2fDTLS%20%e6%8f%90%e4%be%9b%e4%ba%86%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84%e5%8d%8f%e8%ae%ae%ef%bc%8c%e5%85%81%e8%ae%b8%e5%9c%a8%e4%b8%8d%e9%9c%80%e8%a6%81%e9%87%8d%e5%8d%8f%e5%95%86%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e4%bd%bf%e7%94%a8%20keep-alive%20%e5%8a%9f%e8%83%bd%e3%80%82Heartbeat%20%e6%89%a9%e5%b1%95%e4%b9%9f%e4%b8%ba%20path%20MTU%20%28PMTU%29%20%e5%8f%91%e7%8e%b0%e6%8f%90%e4%be%9b%e4%ba%86%e5%9f%ba%e7%a1%80%e3%80%82%0a%e4%b8%80.%20Introduction%20%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%8f%8f%e8%bf%b0%e4%ba%86%20%5bRFC5246%5d%20%e5%92%8c%20%5bRFC6347%5d%20%e4%b8%ad%e5%ae%9a%e4%b9%89%e7%9a%84%e4%bc%a0%e8%be%93%e5%b1%82%e5%ae%89%e5%85%a8%e6%80%a7%20%28TLS%29%20%e5%92%8c%e6%95%b0%e6%8d%ae%e6%8a%a5%e4%bc%a0%e8%be%93%e5%b1%82%e5%ae%89%e5%85%a8%e6%80%a7%20%28DTLS%29%20%e5%8d%8f%e8%ae%ae%e7%9a%84%e5%bf%83%e8%b7%b3%e6%89%a9%e5%b1%95%ef%bc%8c%e4%bb%a5%e5%8f%8a%e5%ae%83%e4%bb%ac%e5%af%b9%20%5bRFC3436%5d%ef%bc%8c%5bRFC5238%5d%20%e5%92%8c%20%5bRFC6083%5d%20%e4%b8%ad%e6%8f%8f%e8%bf%b0%e7%9a%84%e7%89%b9%e5%ae%9a%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%e7%9a%84%e9%80%82%e5%ba%94%e6%80%a7%e3%80%82%0aDTLS%20%e5%8d%8f%e8%ae%ae%e8%ae%be%e8%ae%a1%e7%9a%84%e7%9b%ae%e7%9a%84%e6%98%af%ef%bc%8c%e4%bf%9d%e6%8a%a4%e5%9c%a8%e4%b8%8d%e5%8f%af%e9%9d%a0%e7%9a%84%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%e4%b9%8b%e4%b8%8a%e8%bf%90%e8%a1%8c%e7%9a%84%e6%b5%81%e9%87%8f%e6%95%b0%e6%8d%ae%e3%80%82%e9%80%9a%e5%b8%b8%ef%bc%8c%e6%ad%a4%e7%b1%bb%e5%8d%8f%e8%ae%ae%e6%b2%a1%e6%9c%89%e4%bc%9a%e8%af%9d%e7%ae%a1%e7%90%86%e3%80%82DTLS%20%e5%b1%82%e5%8f%af%e7%94%a8%e4%ba%8e%e7%a1%ae%e5%ae%9a%e5%af%b9%e7%ad%89%e6%96%b9%e6%98%af%e5%90%a6%e4%bb%8d%e7%84%b6%20alive%20%e7%9a%84%e5%94%af%e4%b8%80%e6%9c%ba%e5%88%b6%e6%98%af%e6%98%82%e8%b4%b5%e7%9a%84%e9%87%8d%e6%96%b0%e5%8d%8f%e5%95%86%e6%9c%ba%e5%88%b6%ef%bc%8c%e5%b0%a4%e5%85%b6%e6%98%af%e5%bd%93%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e4%bd%bf%e7%94%a8%e5%8d%95%e5%90%91%e6%b5%81%e9%87%8f%e6%97%b6%e3%80%82%e6%ad%a4%e5%a4%96%ef%bc%8cDTLS%20%e9%9c%80%e8%a6%81%e6%89%a7%e8%a1%8c%e8%b7%af%e5%be%84%20MTU%20%28PMTU%29%20%e5%8f%91%e7%8e%b0%ef%bc%8c%e4%bd%86%e5%9c%a8%e4%b8%8d%e5%bd%b1%e5%93%8d%e7%94%a8%e6%88%b7%e6%b6%88%e6%81%af%e7%9a%84%e4%bc%a0%e8%be%93%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e6%b2%a1%e6%9c%89%e7%89%b9%e5%ae%9a%e7%9a%84%e6%b6%88%e6%81%af%e7%b1%bb%e5%9e%8b%e6%9d%a5%e5%ae%9e%e7%8e%b0%20PMTU%20%e5%8f%91%e7%8e%b0%e3%80%82%0aTLS%20%e6%98%af%e5%9f%ba%e4%ba%8e%e5%8f%af%e9%9d%a0%e7%9a%84%e5%8d%8f%e8%ae%ae%ef%bc%8c%e4%bd%86%e6%b2%a1%e6%9c%89%e5%bf%85%e8%a6%81%e7%9a%84%e5%8a%9f%e8%83%bd%e5%8f%af%e4%bb%a5%e5%9c%a8%e6%b2%a1%e6%9c%89%e8%bf%9e%e7%bb%ad%e6%95%b0%e6%8d%ae%e4%bc%a0%e8%be%93%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e4%bf%9d%e6%8c%81%e8%bf%9e%e6%8e%a5%e5%ad%98%e6%b4%bb%e3%80%82%0a%e6%9c%ac%e6%96%87%e4%b8%ad%e6%8f%8f%e8%bf%b0%e7%9a%84%e5%bf%83%e8%b7%b3%e6%89%a9%e5%b1%95%e5%85%8b%e6%9c%8d%e4%ba%86%e8%bf%99%e4%ba%9b%e9%99%90%e5%88%b6%e3%80%82%e7%94%a8%e6%88%b7%e5%8f%af%e4%bb%a5%e4%bd%bf%e7%94%a8%e6%96%b0%e7%9a%84%20HeartbeatRequest%20%e6%b6%88%e6%81%af%ef%bc%8c%e8%af%a5%e6%b6%88%e6%81%af%e5%bf%85%e9%a1%bb%e7%94%b1%e5%85%b7%e6%9c%89%20HeartbeartResponse%20%e7%9a%84%e5%af%b9%e7%ab%af%e7%ab%8b%e5%8d%b3%e5%ba%94%e7%ad%94%e3%80%82%e8%a6%81%e6%89%a7%e8%a1%8c%20PMTU%20%e5%8f%91%e7%8e%b0%ef%bc%8c%e5%a6%82%20RFC4821%20%e4%b8%ad%e6%89%80%e8%bf%b0%ef%bc%8c%e5%8f%af%e4%bb%a5%e5%b0%86%e5%8c%85%e5%90%ab%e5%a1%ab%e5%85%85%e7%9a%84%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e7%94%a8%e4%bd%9c%e6%8e%a2%e6%b5%8b%e5%8c%85%e3%80%82%0a%e4%ba%8c.%20Heartbeat%20Hello%20Extension%20Hello%20Extensions%20%e8%a1%a8%e7%a4%ba%e6%94%af%e6%8c%81%20Heartbeats%e3%80%82%e5%af%b9%e7%ab%af%e4%b8%8d%e4%bb%85%e5%8f%af%e4%bb%a5%e8%a1%a8%e6%98%8e%e5%85%b6%e5%ae%9e%e7%8e%b0%e6%94%af%e6%8c%81Heartbeats%ef%bc%8c%e8%bf%98%e5%8f%af%e4%bb%a5%e9%80%89%e6%8b%a9%e6%98%af%e5%90%a6%e6%84%bf%e6%84%8f%e6%8e%a5%e6%94%b6%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e5%b9%b6%e4%bd%bf%e7%94%a8%20HeartbeatResponse%20%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e5%93%8d%e5%ba%94%e6%88%96%e4%bb%85%e5%8f%91%e9%80%81%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e3%80%82%e5%89%8d%e8%80%85%e9%80%9a%e8%bf%87%e4%bd%bf%e7%94%a8%20peer_allowed_to_send%20%e4%bd%9c%e4%b8%ba%20HeartbeatMode%20%e6%9d%a5%e8%a1%a8%e7%a4%ba%3b%e5%90%8e%e8%80%85%e9%80%9a%e8%bf%87%e4%bd%bf%e7%94%a8%20peer_not_allowed_to_send%20%e4%bd%9c%e4%b8%ba%e5%bf%83%e8%b7%b3%e6%a8%a1%e5%bc%8f%e6%9d%a5%e8%a1%a8%e7%a4%ba%e3%80%82%e6%af%8f%e6%ac%a1%e9%87%8d%e6%96%b0%e8%b0%88%e5%88%a4%e9%83%bd%e5%8f%af%e4%bb%a5%e6%94%b9%e5%8f%98%e8%bf%99%e4%b8%80%e5%86%b3%e5%ae%9a%e3%80%82HeartbeatRequest%20%e6%b6%88%e6%81%af%e7%a6%81%e6%ad%a2%e5%8f%91%e9%80%81%e5%88%b0%e5%b7%b2%e7%bb%8f%e8%a1%a8%e6%98%8e%e4%ba%86%20peer_not_allowed_to_send%20%e7%9a%84%e5%af%b9%e7%ab%af%e3%80%82%e5%a6%82%e6%9e%9c%e5%b7%b2%e7%bb%8f%e8%a1%a8%e6%98%8e%e4%ba%86%20peer_not_allowed_to_send%20%e7%9a%84%e7%ab%af%e7%82%b9%e6%94%b6%e5%88%b0%20HeartbeatRequest%20%e6%b6%88%e6%81%af%ef%bc%8c%e5%88%99%e7%ab%af%e7%82%b9%e5%ba%94%e8%af%a5%e4%bb%a5%e9%9d%99%e9%bb%98%e6%96%b9%e5%bc%8f%e4%b8%a2%e5%bc%83%e8%af%a5%e6%b6%88%e6%81%af%ef%bc%8c%e5%b9%b6%e4%b8%94%e5%8f%af%e4%bb%a5%e5%8f%91%e9%80%81%20unexpected_message%20Alert%20%e6%b6%88%e6%81%af%e3%80%82"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&t=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一-introduction>一. Introduction</a></li><li><a href=#二-heartbeat-hello-extension>二. Heartbeat Hello Extension</a></li><li><a href=#三-heartbeat-protocol>三. Heartbeat Protocol</a></li><li><a href=#四-heartbeat-request-and-response-messages>四. Heartbeat Request and Response Messages</a></li><li><a href=#五-use-cases>五. Use Cases</a><ul><li><a href=#1-path-mtu-discovery>1. Path MTU Discovery</a></li><li><a href=#2-liveliness-check>2. Liveliness Check</a></li></ul></li><li><a href=#六-iana-considerations>六. IANA Considerations</a></li><li><a href=#七-security-considerations>七. Security Considerations</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">TLS & DTLS Heartbeat Extension</h1><div class=meta><div class=postdate><time datetime="2019-01-06 05:14:00 +0000 UTC" itemprop=datePublished>Jan 06</time></div><div class=article-category><i class="fas fa-archive"></i><a class=category-link href=/categories/protocol>Protocol</a>
,
<a class=category-link href=/categories/https>HTTPS</a></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/protocol rel=tag>Protocol</a>
,
<a class=tag-link href=/tags/https rel=tag>HTTPS</a></div></div></header><div class=content itemprop=articleBody><p>这篇文章我们主要来讨论讨论 Transport Layer Security (TLS) 和 Datagram Transport Layer Security (DTLS) 中的 Heartbeat 扩展。</p><p>Heartbeat 扩展为 TLS/DTLS 提供了一种新的协议，允许在不需要重协商的情况下，使用 keep-alive 功能。Heartbeat 扩展也为 path MTU (PMTU) 发现提供了基础。</p><h2 id=一-introduction>一. Introduction</h2><p>这篇文章描述了 <a href=https://tools.ietf.org/html/rfc5246>[RFC5246]</a> 和 <a href=https://tools.ietf.org/html/rfc6347>[RFC6347]</a> 中定义的传输层安全性 (TLS) 和数据报传输层安全性 (DTLS) 协议的心跳扩展，以及它们对 <a href=https://tools.ietf.org/html/rfc3436>[RFC3436]</a>，<a href=https://tools.ietf.org/html/rfc5238>[RFC5238]</a> 和 <a href=https://tools.ietf.org/html/rfc6083>[RFC6083]</a> 中描述的特定传输协议的适应性。</p><p>DTLS 协议设计的目的是，保护在不可靠的传输协议之上运行的流量数据。通常，此类协议没有会话管理。DTLS 层可用于确定对等方是否仍然 alive 的唯一机制是昂贵的重新协商机制，尤其是当应用程序使用单向流量时。此外，DTLS 需要执行路径 MTU (PMTU) 发现，但在不影响用户消息的传输的情况下，没有特定的消息类型来实现 PMTU 发现。</p><p>TLS 是基于可靠的协议，但没有必要的功能可以在没有连续数据传输的情况下保持连接存活。</p><p>本文中描述的心跳扩展克服了这些限制。用户可以使用新的 HeartbeatRequest 消息，该消息必须由具有 HeartbeartResponse 的对端立即应答。要执行 PMTU 发现，如 <a href=https://tools.ietf.org/html/rfc4821>RFC4821</a> 中所述，可以将包含填充的 HeartbeatRequest 消息用作探测包。</p><h2 id=二-heartbeat-hello-extension>二. Heartbeat Hello Extension</h2><p>Hello Extensions 表示支持 Heartbeats。对端不仅可以表明其实现支持Heartbeats，还可以选择是否愿意接收 HeartbeatRequest 消息并使用 HeartbeatResponse 消息进行响应或仅发送 HeartbeatRequest 消息。前者通过使用 peer_allowed_to_send 作为 HeartbeatMode 来表示;后者通过使用 peer_not_allowed_to_send 作为心跳模式来表示。每次重新谈判都可以改变这一决定。HeartbeatRequest 消息禁止发送到已经表明了 peer_not_allowed_to_send 的对端。如果已经表明了 peer_not_allowed_to_send 的端点收到 HeartbeatRequest 消息，则端点应该以静默方式丢弃该消息，并且可以发送 unexpected_message Alert 消息。</p><p>Heartbeat Hello 扩展的格式定义如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>enum</span> {
      peer_allowed_to_send(<span style=color:#ae81ff>1</span>),
      peer_not_allowed_to_send(<span style=color:#ae81ff>2</span>),
      (<span style=color:#ae81ff>255</span>)
   } HeartbeatMode;

   <span style=color:#66d9ef>struct</span> {
      HeartbeatMode mode;
   } HeartbeatExtension;
</code></pre></div><p>收到未知模式后，必须发送使用 illegal_parameter 作为其 AlertDescription 的错误警报消息作为响应。</p><h2 id=三-heartbeat-protocol>三. Heartbeat Protocol</h2><p>Heartbeat 协议是在记录层之上运行的新协议。协议本身由两种消息类型组成：HeartbeatRequest 和 HeartbeatResponse。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>enum</span> {
      heartbeat_request(<span style=color:#ae81ff>1</span>),
      heartbeat_response(<span style=color:#ae81ff>2</span>),
      (<span style=color:#ae81ff>255</span>)
   } HeartbeatMessageType;
</code></pre></div><p>HeartbeatRequest 消息几乎可以在连接的生命周期内的任何时间到达。每当收到 HeartbeatRequest 消息时，应该使用相应的 HeartbeatResponse 消息回答它。</p><p>但是，在握手期间不应发送 HeartbeatRequest 消息。如果在 HeartbeatRequest 仍处于传输的途中状态中时启动握手，则发送对等方必须为其停止 DTLS 重传计时器。如果在握手期间到达，接收对等方应该默默地丢弃该消息。在 DTLS 的情况下，应该丢弃来自较旧时期的 HeartbeatRequest 消息。</p><p>一次消息传输途中不得有多个 HeartbeatRequest 消息。在收到相应的 HeartbeatResponse 消息之前，或者直到重新传输计时器到期为止，在此之间，HeartbeatRequest 消息被认为是在传输途中。</p><p>当使用不可靠的传输协议(如数据报拥塞控制协议 (DCCP) 或 UDP)时，处理方法要如 <a href=https://tools.ietf.org/html/rfc6347#section-4.2.4>[RFC6347] 第4.2.4节</a> 中所述，必须使用 DTLS 用于传输途中的简单超时和重传方案进行重新传输 HeartbeatRequest 消息。特别是，在没有接收到相应的具有预期有效 payload 的 HeartbeatResponse 消息并尝试多次重传之后，应该终止 DTLS 连接。用于此的阈值应该与用于 DTLS 握手消息的阈值相同。请注意，在监督 HeartbeatRequest 消息的计时器到期后，此消息不再考虑在传输的途中。因此，HeartbeatRequest 消息有资格重新传输。重传方案需要结合仅允许一个 HeartbeatRequest 在传输的途中的限制，确保在传输协议不提供一个 HeartbeatRequest 的情况下适当地处理拥塞控制，如在 DTLS over UDP 的情况下。</p><p>当使用可靠的传输协议(如流控制传输协议 (SCTP)或 TCP)时，HeartbeatRequest 消息只需要发送一次。传输层将处理重传。如果在一段时间后没有收到相应的 HeartbeatResponse 消息，则 DTLS/TLS 连接可以由发起 HeartbeatRequest 消息的应用程序终止。</p><h2 id=四-heartbeat-request-and-response-messages>四. Heartbeat Request and Response Messages</h2><p>Heartbeat 协议消息由它们的类型和任意有效 payload 和填充 padding 组成。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>struct</span> {
      HeartbeatMessageType type;
      uint16 payload_length;
      opaque payload[HeartbeatMessage.payload_length];
      opaque padding[padding_length];
   } HeartbeatMessage;
</code></pre></div><p>根据 <a href=https://tools.ietf.org/html/rfc6066>[RFC6066]</a> 中的定义，在协商的时候，HeartbeatMessage 的总长度不得超过 2 ^ 14 或 max_fragment_length。</p><ul><li><p>type:<br>消息类型，heartbeat_request 或 heartbeat_response。</p></li><li><p>payload_length:<br>payload 的长度。</p></li><li><p>payload:<br>payload 有效载荷由任意内容组成。</p></li><li><p>padding:<br>padding 填充是随机内容，接收方必须忽略。HeartbeatMessage 的长度为 TLS 的 TLSPlaintext.length 和 DTLS 的 DTLSPlaintext.length。此外，类型 type 字段的长度是 1 个字节，并且 payload_length 的长度是 2 个字节。因此，padding_length 是TLSPlaintext.length - payload_length - 3 用于 TLS，DTLSPlaintext.length - payload_length - 3 用于 DTLS。padding_length 必须至少为 16。</p></li></ul><p>HeartbeatMessage 的发送方必须使用至少 16 个字节的随机填充。必须忽略收到的HeartbeatMessage 消息的填充。</p><p>如果收到的 HeartbeatMessage 的 payload_length 太大，则必须静默丢弃收到的HeartbeatMessage。</p><p>当收到 HeartbeatRequest 消息并且发送 HeartbeatResponse 时不被禁止，如本文档中其他地方所述，接收方必须发送相应的 HeartbeatResponse 消息，该消息携带接收到的 HeartbeatRequest 的有效载荷的副本。</p><p>如果收到的 HeartbeatResponse 消息不包含预期的有效负载 payload，则必须以静默方式丢弃该消息。如果它确实包含预期的有效载荷 payload，则必须停止重传定时器。</p><h2 id=五-use-cases>五. Use Cases</h2><p>每个端点以一定的速率发送 HeartbeatRequest 消息，并使用特定用例所需的填充。端点不应期望其对等方发送 HeartbeatRequests。方向是独立的。</p><h3 id=1-path-mtu-discovery>1. Path MTU Discovery</h3><p>DTLS 执行路径 MTU 发现，如 <a href=https://tools.ietf.org/html/rfc6347#section-4.1.1.1>[RFC6347]的第4.1.1.1节</a> 所述。<a href=https://tools.ietf.org/html/rfc4821>[RFC4821]</a> 中给出了如何执行路径 MTU 发现的详细描述。必要的探测包是 HeartbeatRequest 消息。</p><p>对于 DTLS 使用 HeartbeatRequest 消息的这种方法类似于使用 <a href=https://tools.ietf.org/html/rfc4820>[RFC4820]</a> 中定义的填充块 (PAD-chunk) 的流控制传输协议(SCTP)的方法。</p><h3 id=2-liveliness-check>2. Liveliness Check</h3><p>发送 HeartbeatRequest 消息允许发送方确保它可以到达对等方并且对端是活动的。即使在 TLS/TCP 的情况下，这也允许以比 TCP keep-alive 特征允许的更高的速率进行检查。</p><p>除了确保对等方仍可访问外，发送 HeartbeatRequest 消息还会刷新所有相关 NAT 的 NAT 状态。</p><p>HeartbeatRequest 消息应该仅在至少多个往返时间长的空闲时段之后发送。该空闲时段应该可以配置多达几分钟的时间段并且可以下降到一秒的时间段。空闲时段的默认值应该是可配置的，但它也应该在每个对等的基础上可调。</p><h2 id=六-iana-considerations>六. IANA Considerations</h2><p>IANA 已根据 <a href=https://tools.ietf.org/html/rfc5246>[RFC5246]</a> 中指定的 &ldquo;TLS ContentType Registry&rdquo; 分配了心跳内容类型(24)。参考是 <a href=https://tools.ietf.org/html/rfc6520>[RFC 6520]</a>。</p><p>IANA 已创建并现在维护心跳消息类型的新注册表。消息类型是 0 到 255(十进制)范围内的数字。IANA 已分配 heartbeat_request(1) 和 heartbeat_response(2) 消息类型。应保留值 0 和 255。此注册表使用 <a href=https://tools.ietf.org/html/rfc5226>[RFC5226]</a> 中所述的专家审阅策略。参考是 <a href=https://tools.ietf.org/html/rfc6520>RFC 6520</a>。</p><p>IANA 已根据 <a href=https://tools.ietf.org/html/rfc5246>RFC5246</a> 中指定的 TLS &ldquo;ExtensionType Values&rdquo; 注册表分配了心跳扩展类型(15)。参考是 <a href=https://tools.ietf.org/html/rfc6520>RFC 6520</a>。</p><p>IANA 已创建并现在维护心跳模式的新注册表。模式的数字范围为 0 到 255(十进制)。 IANA 已分配 peer_allowed_to_send(1) 和 peer_not_allowed_to_send(2) 模式。应保留值 0 和 255。此注册表使用 <a href=https://tools.ietf.org/html/rfc5226>[RFC5226]</a> 中所述的专家审阅策略。参考是 <a href=https://tools.ietf.org/html/rfc6520>RFC 6520</a>。</p><h2 id=七-security-considerations>七. Security Considerations</h2><p><a href=https://tools.ietf.org/html/rfc5246>[RFC5246]</a> 和 <a href=https://tools.ietf.org/html/rfc6347>[RFC6347]</a> 的安全注意事项适用于本文档。本文档未介绍任何新的安全注意事项。</p><hr><p>Reference：</p><p><a href=https://tools.ietf.org/html/rfc6520>RFC 6520</a></p><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://halfrost.com/tls_heartbeat/>https://halfrost.com/TLS_Heartbeat/</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一-introduction>一. Introduction</a></li><li><a href=#二-heartbeat-hello-extension>二. Heartbeat Hello Extension</a></li><li><a href=#三-heartbeat-protocol>三. Heartbeat Protocol</a></li><li><a href=#四-heartbeat-request-and-response-messages>四. Heartbeat Request and Response Messages</a></li><li><a href=#五-use-cases>五. Use Cases</a><ul><li><a href=#1-path-mtu-discovery>1. Path MTU Discovery</a></li><li><a href=#2-liveliness-check>2. Liveliness Check</a></li></ul></li><li><a href=#六-iana-considerations>六. IANA Considerations</a></li><li><a href=#七-security-considerations>七. Security Considerations</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&text=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&is_video=false&description=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TLS%20%26%20DTLS%20Heartbeat%20Extension&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&title=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&name=TLS%20%26%20DTLS%20Heartbeat%20Extension&description=%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%88%91%e4%bb%ac%e4%b8%bb%e8%a6%81%e6%9d%a5%e8%ae%a8%e8%ae%ba%e8%ae%a8%e8%ae%ba%20Transport%20Layer%20Security%20%28TLS%29%20%e5%92%8c%20Datagram%20Transport%20Layer%20Security%20%28DTLS%29%20%e4%b8%ad%e7%9a%84%20Heartbeat%20%e6%89%a9%e5%b1%95%e3%80%82%0aHeartbeat%20%e6%89%a9%e5%b1%95%e4%b8%ba%20TLS%2fDTLS%20%e6%8f%90%e4%be%9b%e4%ba%86%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84%e5%8d%8f%e8%ae%ae%ef%bc%8c%e5%85%81%e8%ae%b8%e5%9c%a8%e4%b8%8d%e9%9c%80%e8%a6%81%e9%87%8d%e5%8d%8f%e5%95%86%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e4%bd%bf%e7%94%a8%20keep-alive%20%e5%8a%9f%e8%83%bd%e3%80%82Heartbeat%20%e6%89%a9%e5%b1%95%e4%b9%9f%e4%b8%ba%20path%20MTU%20%28PMTU%29%20%e5%8f%91%e7%8e%b0%e6%8f%90%e4%be%9b%e4%ba%86%e5%9f%ba%e7%a1%80%e3%80%82%0a%e4%b8%80.%20Introduction%20%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%8f%8f%e8%bf%b0%e4%ba%86%20%5bRFC5246%5d%20%e5%92%8c%20%5bRFC6347%5d%20%e4%b8%ad%e5%ae%9a%e4%b9%89%e7%9a%84%e4%bc%a0%e8%be%93%e5%b1%82%e5%ae%89%e5%85%a8%e6%80%a7%20%28TLS%29%20%e5%92%8c%e6%95%b0%e6%8d%ae%e6%8a%a5%e4%bc%a0%e8%be%93%e5%b1%82%e5%ae%89%e5%85%a8%e6%80%a7%20%28DTLS%29%20%e5%8d%8f%e8%ae%ae%e7%9a%84%e5%bf%83%e8%b7%b3%e6%89%a9%e5%b1%95%ef%bc%8c%e4%bb%a5%e5%8f%8a%e5%ae%83%e4%bb%ac%e5%af%b9%20%5bRFC3436%5d%ef%bc%8c%5bRFC5238%5d%20%e5%92%8c%20%5bRFC6083%5d%20%e4%b8%ad%e6%8f%8f%e8%bf%b0%e7%9a%84%e7%89%b9%e5%ae%9a%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%e7%9a%84%e9%80%82%e5%ba%94%e6%80%a7%e3%80%82%0aDTLS%20%e5%8d%8f%e8%ae%ae%e8%ae%be%e8%ae%a1%e7%9a%84%e7%9b%ae%e7%9a%84%e6%98%af%ef%bc%8c%e4%bf%9d%e6%8a%a4%e5%9c%a8%e4%b8%8d%e5%8f%af%e9%9d%a0%e7%9a%84%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%e4%b9%8b%e4%b8%8a%e8%bf%90%e8%a1%8c%e7%9a%84%e6%b5%81%e9%87%8f%e6%95%b0%e6%8d%ae%e3%80%82%e9%80%9a%e5%b8%b8%ef%bc%8c%e6%ad%a4%e7%b1%bb%e5%8d%8f%e8%ae%ae%e6%b2%a1%e6%9c%89%e4%bc%9a%e8%af%9d%e7%ae%a1%e7%90%86%e3%80%82DTLS%20%e5%b1%82%e5%8f%af%e7%94%a8%e4%ba%8e%e7%a1%ae%e5%ae%9a%e5%af%b9%e7%ad%89%e6%96%b9%e6%98%af%e5%90%a6%e4%bb%8d%e7%84%b6%20alive%20%e7%9a%84%e5%94%af%e4%b8%80%e6%9c%ba%e5%88%b6%e6%98%af%e6%98%82%e8%b4%b5%e7%9a%84%e9%87%8d%e6%96%b0%e5%8d%8f%e5%95%86%e6%9c%ba%e5%88%b6%ef%bc%8c%e5%b0%a4%e5%85%b6%e6%98%af%e5%bd%93%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e4%bd%bf%e7%94%a8%e5%8d%95%e5%90%91%e6%b5%81%e9%87%8f%e6%97%b6%e3%80%82%e6%ad%a4%e5%a4%96%ef%bc%8cDTLS%20%e9%9c%80%e8%a6%81%e6%89%a7%e8%a1%8c%e8%b7%af%e5%be%84%20MTU%20%28PMTU%29%20%e5%8f%91%e7%8e%b0%ef%bc%8c%e4%bd%86%e5%9c%a8%e4%b8%8d%e5%bd%b1%e5%93%8d%e7%94%a8%e6%88%b7%e6%b6%88%e6%81%af%e7%9a%84%e4%bc%a0%e8%be%93%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e6%b2%a1%e6%9c%89%e7%89%b9%e5%ae%9a%e7%9a%84%e6%b6%88%e6%81%af%e7%b1%bb%e5%9e%8b%e6%9d%a5%e5%ae%9e%e7%8e%b0%20PMTU%20%e5%8f%91%e7%8e%b0%e3%80%82%0aTLS%20%e6%98%af%e5%9f%ba%e4%ba%8e%e5%8f%af%e9%9d%a0%e7%9a%84%e5%8d%8f%e8%ae%ae%ef%bc%8c%e4%bd%86%e6%b2%a1%e6%9c%89%e5%bf%85%e8%a6%81%e7%9a%84%e5%8a%9f%e8%83%bd%e5%8f%af%e4%bb%a5%e5%9c%a8%e6%b2%a1%e6%9c%89%e8%bf%9e%e7%bb%ad%e6%95%b0%e6%8d%ae%e4%bc%a0%e8%be%93%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e4%bf%9d%e6%8c%81%e8%bf%9e%e6%8e%a5%e5%ad%98%e6%b4%bb%e3%80%82%0a%e6%9c%ac%e6%96%87%e4%b8%ad%e6%8f%8f%e8%bf%b0%e7%9a%84%e5%bf%83%e8%b7%b3%e6%89%a9%e5%b1%95%e5%85%8b%e6%9c%8d%e4%ba%86%e8%bf%99%e4%ba%9b%e9%99%90%e5%88%b6%e3%80%82%e7%94%a8%e6%88%b7%e5%8f%af%e4%bb%a5%e4%bd%bf%e7%94%a8%e6%96%b0%e7%9a%84%20HeartbeatRequest%20%e6%b6%88%e6%81%af%ef%bc%8c%e8%af%a5%e6%b6%88%e6%81%af%e5%bf%85%e9%a1%bb%e7%94%b1%e5%85%b7%e6%9c%89%20HeartbeartResponse%20%e7%9a%84%e5%af%b9%e7%ab%af%e7%ab%8b%e5%8d%b3%e5%ba%94%e7%ad%94%e3%80%82%e8%a6%81%e6%89%a7%e8%a1%8c%20PMTU%20%e5%8f%91%e7%8e%b0%ef%bc%8c%e5%a6%82%20RFC4821%20%e4%b8%ad%e6%89%80%e8%bf%b0%ef%bc%8c%e5%8f%af%e4%bb%a5%e5%b0%86%e5%8c%85%e5%90%ab%e5%a1%ab%e5%85%85%e7%9a%84%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e7%94%a8%e4%bd%9c%e6%8e%a2%e6%b5%8b%e5%8c%85%e3%80%82%0a%e4%ba%8c.%20Heartbeat%20Hello%20Extension%20Hello%20Extensions%20%e8%a1%a8%e7%a4%ba%e6%94%af%e6%8c%81%20Heartbeats%e3%80%82%e5%af%b9%e7%ab%af%e4%b8%8d%e4%bb%85%e5%8f%af%e4%bb%a5%e8%a1%a8%e6%98%8e%e5%85%b6%e5%ae%9e%e7%8e%b0%e6%94%af%e6%8c%81Heartbeats%ef%bc%8c%e8%bf%98%e5%8f%af%e4%bb%a5%e9%80%89%e6%8b%a9%e6%98%af%e5%90%a6%e6%84%bf%e6%84%8f%e6%8e%a5%e6%94%b6%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e5%b9%b6%e4%bd%bf%e7%94%a8%20HeartbeatResponse%20%e6%b6%88%e6%81%af%e8%bf%9b%e8%a1%8c%e5%93%8d%e5%ba%94%e6%88%96%e4%bb%85%e5%8f%91%e9%80%81%20HeartbeatRequest%20%e6%b6%88%e6%81%af%e3%80%82%e5%89%8d%e8%80%85%e9%80%9a%e8%bf%87%e4%bd%bf%e7%94%a8%20peer_allowed_to_send%20%e4%bd%9c%e4%b8%ba%20HeartbeatMode%20%e6%9d%a5%e8%a1%a8%e7%a4%ba%3b%e5%90%8e%e8%80%85%e9%80%9a%e8%bf%87%e4%bd%bf%e7%94%a8%20peer_not_allowed_to_send%20%e4%bd%9c%e4%b8%ba%e5%bf%83%e8%b7%b3%e6%a8%a1%e5%bc%8f%e6%9d%a5%e8%a1%a8%e7%a4%ba%e3%80%82%e6%af%8f%e6%ac%a1%e9%87%8d%e6%96%b0%e8%b0%88%e5%88%a4%e9%83%bd%e5%8f%af%e4%bb%a5%e6%94%b9%e5%8f%98%e8%bf%99%e4%b8%80%e5%86%b3%e5%ae%9a%e3%80%82HeartbeatRequest%20%e6%b6%88%e6%81%af%e7%a6%81%e6%ad%a2%e5%8f%91%e9%80%81%e5%88%b0%e5%b7%b2%e7%bb%8f%e8%a1%a8%e6%98%8e%e4%ba%86%20peer_not_allowed_to_send%20%e7%9a%84%e5%af%b9%e7%ab%af%e3%80%82%e5%a6%82%e6%9e%9c%e5%b7%b2%e7%bb%8f%e8%a1%a8%e6%98%8e%e4%ba%86%20peer_not_allowed_to_send%20%e7%9a%84%e7%ab%af%e7%82%b9%e6%94%b6%e5%88%b0%20HeartbeatRequest%20%e6%b6%88%e6%81%af%ef%bc%8c%e5%88%99%e7%ab%af%e7%82%b9%e5%ba%94%e8%af%a5%e4%bb%a5%e9%9d%99%e9%bb%98%e6%96%b9%e5%bc%8f%e4%b8%a2%e5%bc%83%e8%af%a5%e6%b6%88%e6%81%af%ef%bc%8c%e5%b9%b6%e4%b8%94%e5%8f%af%e4%bb%a5%e5%8f%91%e9%80%81%20unexpected_message%20Alert%20%e6%b6%88%e6%81%af%e3%80%82"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2ftls_heartbeat%2f&t=TLS%20%26%20DTLS%20Heartbeat%20Extension"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>