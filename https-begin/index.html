<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>HTTPS 温故知新（一） —— 开篇 | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="HTTPS 温故知新（一） —— 开篇"><meta property="og:description" content="一、为什么需要 HTTPS HTTP1.1 有以下安全性问题：
 使用明文(不加密)进行通信，内容可能会被窃听； 不验证通信方的身份，通信方的身份有可能遭遇伪装； 无法证明报文的完整性，报文有可能遭篡改。  由于 HTTP 设计之初没有考虑到这几点，所以基于 HTTP 的这些应用都会存在安全问题。
1. 数据没有加密 基于 TCP/IP 的网络，网络各处都会存在被监听的风险。而且如果用 HTTP 协议进行通信，HTTP 本身没有加密功能，所以也无法做到对通信整体(使用 HTTP 协议通信的请求和响应的内容)进行加密。即，HTTP 报文使用明文(指未经过加密的报文)方式发送。
像上图表示的那样，在互联网各个环节都可能被监听。就算是加密通信，也能被监听到通信内容，只不过监听者看到的是密文。要解决 HTTP 上面 3 个大的安全问题，第一步就是要先进行加密通信。于是在传输层增加了一层 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 来加密 HTTP 的通信内容。
HTTPS (HTTP Secure) 并不是新协议，而是 HTTP 先和 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 通信，再由 SSL/TLS 和 TCP 通信。也就是说 HTTPS 使用了隧道进行通信。
这个时候可能有同学会有疑问了，为什么不直接对 HTTP 报文进行加密，这样就不需要 SSL/TLS 这一层了。确实，如果直接对 HTTP 报文进行加密也可以做到加密通信，但是虽然解决了第一条，但是后面 2 条就不好解决了。"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/https-begin/"><meta property="article:published_time" content="2019-01-13T05:31:00+00:00"><meta property="article:modified_time" content="2019-01-13T05:31:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTTPS 温故知新（一） —— 开篇"><meta name=twitter:description content="一、为什么需要 HTTPS HTTP1.1 有以下安全性问题：
 使用明文(不加密)进行通信，内容可能会被窃听； 不验证通信方的身份，通信方的身份有可能遭遇伪装； 无法证明报文的完整性，报文有可能遭篡改。  由于 HTTP 设计之初没有考虑到这几点，所以基于 HTTP 的这些应用都会存在安全问题。
1. 数据没有加密 基于 TCP/IP 的网络，网络各处都会存在被监听的风险。而且如果用 HTTP 协议进行通信，HTTP 本身没有加密功能，所以也无法做到对通信整体(使用 HTTP 协议通信的请求和响应的内容)进行加密。即，HTTP 报文使用明文(指未经过加密的报文)方式发送。
像上图表示的那样，在互联网各个环节都可能被监听。就算是加密通信，也能被监听到通信内容，只不过监听者看到的是密文。要解决 HTTP 上面 3 个大的安全问题，第一步就是要先进行加密通信。于是在传输层增加了一层 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 来加密 HTTP 的通信内容。
HTTPS (HTTP Secure) 并不是新协议，而是 HTTP 先和 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 通信，再由 SSL/TLS 和 TCP 通信。也就是说 HTTPS 使用了隧道进行通信。
这个时候可能有同学会有疑问了，为什么不直接对 HTTP 报文进行加密，这样就不需要 SSL/TLS 这一层了。确实，如果直接对 HTTP 报文进行加密也可以做到加密通信，但是虽然解决了第一条，但是后面 2 条就不好解决了。"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/tls_heartbeat/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/https_record_layer/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&text=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&is_video=false&description=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&name=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87&description=%e4%b8%80%e3%80%81%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%20HTTPS%20HTTP1.1%20%e6%9c%89%e4%bb%a5%e4%b8%8b%e5%ae%89%e5%85%a8%e6%80%a7%e9%97%ae%e9%a2%98%ef%bc%9a%0a%20%e4%bd%bf%e7%94%a8%e6%98%8e%e6%96%87%28%e4%b8%8d%e5%8a%a0%e5%af%86%29%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%ef%bc%8c%e5%86%85%e5%ae%b9%e5%8f%af%e8%83%bd%e4%bc%9a%e8%a2%ab%e7%aa%83%e5%90%ac%ef%bc%9b%20%e4%b8%8d%e9%aa%8c%e8%af%81%e9%80%9a%e4%bf%a1%e6%96%b9%e7%9a%84%e8%ba%ab%e4%bb%bd%ef%bc%8c%e9%80%9a%e4%bf%a1%e6%96%b9%e7%9a%84%e8%ba%ab%e4%bb%bd%e6%9c%89%e5%8f%af%e8%83%bd%e9%81%ad%e9%81%87%e4%bc%aa%e8%a3%85%ef%bc%9b%20%e6%97%a0%e6%b3%95%e8%af%81%e6%98%8e%e6%8a%a5%e6%96%87%e7%9a%84%e5%ae%8c%e6%95%b4%e6%80%a7%ef%bc%8c%e6%8a%a5%e6%96%87%e6%9c%89%e5%8f%af%e8%83%bd%e9%81%ad%e7%af%a1%e6%94%b9%e3%80%82%20%20%e7%94%b1%e4%ba%8e%20HTTP%20%e8%ae%be%e8%ae%a1%e4%b9%8b%e5%88%9d%e6%b2%a1%e6%9c%89%e8%80%83%e8%99%91%e5%88%b0%e8%bf%99%e5%87%a0%e7%82%b9%ef%bc%8c%e6%89%80%e4%bb%a5%e5%9f%ba%e4%ba%8e%20HTTP%20%e7%9a%84%e8%bf%99%e4%ba%9b%e5%ba%94%e7%94%a8%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98%e3%80%82%0a1.%20%e6%95%b0%e6%8d%ae%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%20%e5%9f%ba%e4%ba%8e%20TCP%2fIP%20%e7%9a%84%e7%bd%91%e7%bb%9c%ef%bc%8c%e7%bd%91%e7%bb%9c%e5%90%84%e5%a4%84%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e8%a2%ab%e7%9b%91%e5%90%ac%e7%9a%84%e9%a3%8e%e9%99%a9%e3%80%82%e8%80%8c%e4%b8%94%e5%a6%82%e6%9e%9c%e7%94%a8%20HTTP%20%e5%8d%8f%e8%ae%ae%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%ef%bc%8cHTTP%20%e6%9c%ac%e8%ba%ab%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%e5%8a%9f%e8%83%bd%ef%bc%8c%e6%89%80%e4%bb%a5%e4%b9%9f%e6%97%a0%e6%b3%95%e5%81%9a%e5%88%b0%e5%af%b9%e9%80%9a%e4%bf%a1%e6%95%b4%e4%bd%93%28%e4%bd%bf%e7%94%a8%20HTTP%20%e5%8d%8f%e8%ae%ae%e9%80%9a%e4%bf%a1%e7%9a%84%e8%af%b7%e6%b1%82%e5%92%8c%e5%93%8d%e5%ba%94%e7%9a%84%e5%86%85%e5%ae%b9%29%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e3%80%82%e5%8d%b3%ef%bc%8cHTTP%20%e6%8a%a5%e6%96%87%e4%bd%bf%e7%94%a8%e6%98%8e%e6%96%87%28%e6%8c%87%e6%9c%aa%e7%bb%8f%e8%bf%87%e5%8a%a0%e5%af%86%e7%9a%84%e6%8a%a5%e6%96%87%29%e6%96%b9%e5%bc%8f%e5%8f%91%e9%80%81%e3%80%82%0a%e5%83%8f%e4%b8%8a%e5%9b%be%e8%a1%a8%e7%a4%ba%e7%9a%84%e9%82%a3%e6%a0%b7%ef%bc%8c%e5%9c%a8%e4%ba%92%e8%81%94%e7%bd%91%e5%90%84%e4%b8%aa%e7%8e%af%e8%8a%82%e9%83%bd%e5%8f%af%e8%83%bd%e8%a2%ab%e7%9b%91%e5%90%ac%e3%80%82%e5%b0%b1%e7%ae%97%e6%98%af%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%ef%bc%8c%e4%b9%9f%e8%83%bd%e8%a2%ab%e7%9b%91%e5%90%ac%e5%88%b0%e9%80%9a%e4%bf%a1%e5%86%85%e5%ae%b9%ef%bc%8c%e5%8f%aa%e4%b8%8d%e8%bf%87%e7%9b%91%e5%90%ac%e8%80%85%e7%9c%8b%e5%88%b0%e7%9a%84%e6%98%af%e5%af%86%e6%96%87%e3%80%82%e8%a6%81%e8%a7%a3%e5%86%b3%20HTTP%20%e4%b8%8a%e9%9d%a2%203%20%e4%b8%aa%e5%a4%a7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98%ef%bc%8c%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%b0%b1%e6%98%af%e8%a6%81%e5%85%88%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%e3%80%82%e4%ba%8e%e6%98%af%e5%9c%a8%e4%bc%a0%e8%be%93%e5%b1%82%e5%a2%9e%e5%8a%a0%e4%ba%86%e4%b8%80%e5%b1%82%20SSL%ef%bc%88Secure%20Sockets%20Layer%20%e5%ae%89%e5%85%a8%e5%a5%97%e6%8e%a5%e5%b1%82%ef%bc%89%2f%20TLS%20%28Transport%20Layer%20Security%20%e5%ae%89%e5%85%a8%e5%b1%82%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%29%20%e6%9d%a5%e5%8a%a0%e5%af%86%20HTTP%20%e7%9a%84%e9%80%9a%e4%bf%a1%e5%86%85%e5%ae%b9%e3%80%82%0aHTTPS%20%28HTTP%20Secure%29%20%e5%b9%b6%e4%b8%8d%e6%98%af%e6%96%b0%e5%8d%8f%e8%ae%ae%ef%bc%8c%e8%80%8c%e6%98%af%20HTTP%20%e5%85%88%e5%92%8c%20SSL%ef%bc%88Secure%20Sockets%20Layer%20%e5%ae%89%e5%85%a8%e5%a5%97%e6%8e%a5%e5%b1%82%ef%bc%89%2f%20TLS%20%28Transport%20Layer%20Security%20%e5%ae%89%e5%85%a8%e5%b1%82%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%29%20%e9%80%9a%e4%bf%a1%ef%bc%8c%e5%86%8d%e7%94%b1%20SSL%2fTLS%20%e5%92%8c%20TCP%20%e9%80%9a%e4%bf%a1%e3%80%82%e4%b9%9f%e5%b0%b1%e6%98%af%e8%af%b4%20HTTPS%20%e4%bd%bf%e7%94%a8%e4%ba%86%e9%9a%a7%e9%81%93%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%e3%80%82%0a%e8%bf%99%e4%b8%aa%e6%97%b6%e5%80%99%e5%8f%af%e8%83%bd%e6%9c%89%e5%90%8c%e5%ad%a6%e4%bc%9a%e6%9c%89%e7%96%91%e9%97%ae%e4%ba%86%ef%bc%8c%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e7%9b%b4%e6%8e%a5%e5%af%b9%20HTTP%20%e6%8a%a5%e6%96%87%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e4%b8%8d%e9%9c%80%e8%a6%81%20SSL%2fTLS%20%e8%bf%99%e4%b8%80%e5%b1%82%e4%ba%86%e3%80%82%e7%a1%ae%e5%ae%9e%ef%bc%8c%e5%a6%82%e6%9e%9c%e7%9b%b4%e6%8e%a5%e5%af%b9%20HTTP%20%e6%8a%a5%e6%96%87%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e4%b9%9f%e5%8f%af%e4%bb%a5%e5%81%9a%e5%88%b0%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%ef%bc%8c%e4%bd%86%e6%98%af%e8%99%bd%e7%84%b6%e8%a7%a3%e5%86%b3%e4%ba%86%e7%ac%ac%e4%b8%80%e6%9d%a1%ef%bc%8c%e4%bd%86%e6%98%af%e5%90%8e%e9%9d%a2%202%20%e6%9d%a1%e5%b0%b1%e4%b8%8d%e5%a5%bd%e8%a7%a3%e5%86%b3%e4%ba%86%e3%80%82"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&t=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一为什么需要-https>一、为什么需要 HTTPS</a><ul><li><a href=#1-数据没有加密>1. 数据没有加密</a></li><li><a href=#2-无法验证通信对方的身份>2. 无法验证通信对方的身份</a></li><li><a href=#3-无法防止数据被篡改>3. 无法防止数据被篡改</a></li></ul></li><li><a href=#二部署-https-有何好处>二、部署 HTTPS 有何好处</a><ul><li><a href=#1-使用-http2-获得更高的性能>1. 使用 HTTP/2 获得更高的性能</a></li><li><a href=#2-提高-seo-排名>2. 提高 SEO 排名</a></li><li><a href=#3-更好的推荐数据>3. 更好的推荐数据</a></li><li><a href=#4-更高的安全性>4. 更高的安全性</a></li><li><a href=#5-提高网站的信任和信誉>5. 提高网站的信任和信誉</a></li><li><a href=#6-htlm5-新特性>6. HTLM5 新特性</a></li><li><a href=#7-ios-ats-要求>7. iOS ATS 要求</a></li></ul></li><li><a href=#三https-中的密码学>三、HTTPS 中的密码学</a><ul><li><a href=#1-对称密钥加密>1. 对称密钥加密</a></li><li><a href=#2-公开密钥加密>2. 公开密钥加密</a></li><li><a href=#3-https-采用的加密方式>3. HTTPS 采用的加密方式</a></li><li><a href=#4-认证>4. 认证</a></li><li><a href=#5-完整性>5. 完整性</a></li></ul></li><li><a href=#四https-中的-tls--ssl-协议>四、HTTPS 中的 TLS / SSL 协议</a><ul><li><a href=#1-tls-记录层协议>1. TLS 记录层协议</a></li><li><a href=#2-tls-密码切换协议>2. TLS 密码切换协议</a></li><li><a href=#3-tls-警告协议>3. TLS 警告协议</a></li><li><a href=#4-tls-握手协议>4. TLS 握手协议</a></li><li><a href=#5-tls-应用数据协议>5. TLS 应用数据协议</a></li><li><a href=#6-tls-心跳协议>6. TLS 心跳协议</a></li></ul></li><li><a href=#五-接下来>五. 接下来</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">HTTPS 温故知新（一） —— 开篇</h1><div class=meta><div class=postdate><time datetime="2019-01-13 05:31:00 +0000 UTC" itemprop=datePublished>Jan 13</time></div><div class=article-category><i class="fas fa-archive"></i><a class=category-link href=/categories/protocol>Protocol</a>
,
<a class=category-link href=/categories/https>HTTPS</a></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/protocol rel=tag>Protocol</a>
,
<a class=tag-link href=/tags/https rel=tag>HTTPS</a></div></div></header><div class=content itemprop=articleBody><h2 id=一为什么需要-https>一、为什么需要 HTTPS</h2><p>HTTP1.1 有以下安全性问题：</p><ol><li>使用明文(不加密)进行通信，内容可能会被窃听；</li><li>不验证通信方的身份，通信方的身份有可能遭遇伪装；</li><li>无法证明报文的完整性，报文有可能遭篡改。</li></ol><p>由于 HTTP 设计之初没有考虑到这几点，所以基于 HTTP 的这些应用都会存在安全问题。</p><h3 id=1-数据没有加密>1. 数据没有加密</h3><p>基于 TCP/IP 的网络，网络各处都会存在被监听的风险。而且如果用 HTTP 协议进行通信，HTTP 本身没有加密功能，所以也无法做到对通信整体(使用 HTTP 协议通信的请求和响应的内容)进行加密。即，HTTP 报文使用明文(指未经过加密的报文)方式发送。</p><p>像上图表示的那样，在互联网各个环节都可能被监听。就算是加密通信，也能被监听到通信内容，只不过监听者看到的是密文。要解决 HTTP 上面 3 个大的安全问题，第一步就是要先进行加密通信。于是在传输层增加了一层 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 来加密 HTTP 的通信内容。</p><p>HTTPS (HTTP Secure) 并不是新协议，而是 HTTP 先和 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 通信，再由 SSL/TLS 和 TCP 通信。也就是说 HTTPS 使用了隧道进行通信。</p><p>这个时候可能有同学会有疑问了，为什么不直接对 HTTP 报文进行加密，这样就不需要 SSL/TLS 这一层了。确实，如果直接对 HTTP 报文进行加密也可以做到加密通信，但是虽然解决了第一条，但是后面 2 条就不好解决了。</p><p>就算直接对 HTTP 进行加密，HTTP 头部也没有加密，而头部信息也会导致信息不安全。</p><h3 id=2-无法验证通信对方的身份>2. 无法验证通信对方的身份</h3><p>基于 TCP 的 HTTP 虽然可以保证数据能完整的传输给对方，但是无法验证通信对方的身份。HTTP 也由于协议的灵活性，应用的非常广泛。通信的双方无须验证身份，服务器只要接收到能识别的请求，就会返回一个响应，一个 request 就一定会有一个 response。由于不确认通信对方，就会导致一些隐患：</p><ul><li>服务器无法验证请求来自谁，是否是合法的客户端。</li><li>客户端收到响应，也无法验证是否是来自合法的服务器。</li><li>无法阻止海量请求下的 Dos 拒绝攻击（Denial of Service，拒绝服务攻击）</li></ul><h3 id=3-无法防止数据被篡改>3. 无法防止数据被篡改</h3><p>HTTP 协议是无法保证数据的完整性的。所谓完整性指的是信息的准确度。若无法证明信息的完整性，也就意味着无法判断信息是否准确。</p><p>客户端和服务端面对收到的响应和请求，都只能无条件接受，HTTP 也无法知道请求或响应在传输过程中是否已经被篡改了，例如遭到了中间人攻击(Man-in-the-Middle attack，MITM)。</p><p>HTTP 也有可以验证报文完整性的方法，但是还是不可靠。比如利用 MD5 和 SHA-1 等散列值校验的方法，用来确认文件的数字签名。（MD5 和 SHA-1 低位数的已经不再安全了，会遭到碰撞攻击，这个之后的文章再细致分析）</p><p>有下载服务的 Web 网站也会提供 PGP (Pretty Good Privacy，完美隐私)创建的数字签名及 MD5 算法生成的散列值。PGP 用来证明创建文件的数字签名，MD5 是由单向函数生成的散列值。在 HTTP 的协议下，浏览器是无法知晓数据被篡改了，还是需要用户自己查看。但是如果 PGP 和 MD5 在传输前就被篡改了，用户拿到以后验证对比发现是一致的，这种情况也没法保证数据的完整正确性。</p><p>通过使用 SSL，HTTPS 不仅能保证密文传输，重要的是还可以做到验证通信方的身份，保证报文的完整性。完美的解决了 HTTP 在安全性上的三大缺陷。</p><h2 id=二部署-https-有何好处>二、部署 HTTPS 有何好处</h2><p>可能读者有这样的疑惑，除去电商，金融，和钱打交道以外的网站必须要部署 HTTPS，其他的网站用不用 HTTPS 无所谓。笔者之前也有类似的想法，不过这个想法是错误的。</p><p>电商，金融，和钱打交道以外的网站必须要部署 HTTPS，这个毫无疑问，是为了防止用户金钱上的损失，但是其他的网站呢？如果不部署 HTTPS，用裸的 HTTP，很容易遭到劫持，包括可能会被 ISP 插入小广告。小广告非常影响用户体验，如果是黄色广告，还会影响用户对这个网站的印象。另外用户浏览了哪些页面，用户行为也很容易被分析出来，这种也算是泄露了用户的隐私。</p><p>部署 HTTPS 有以下的好处：</p><h3 id=1-使用-http2-获得更高的性能>1. 使用 HTTP/2 获得更高的性能</h3><p>内容交付网络和网络托管服务提供商正在开始推广 HTTP/2。在 Velocity 的一次会议上，Load Impact 和 Mozilla 报告说，互联网用户可以通过 HTTP/2 优化比 HTTP/1.1 上的网站性能要好 50-70％。但是想用 HTTP/2 的性能优势，必须要先部署 HTTPS，这个规定也算是对 HTTPS 的一个推广。</p><h3 id=2-提高-seo-排名>2. 提高 SEO 排名</h3><p>谷歌在 2014 年宣布，支持 HTTPS 的网站将会有排名靠前的较大权重。</p><h3 id=3-更好的推荐数据>3. 更好的推荐数据</h3><p>如果采用了谷歌的 Analytics 库，它目前是强制运行在 HTTPS 上的，如果还是使用 HTTP，会由于 Analytics 不会获取 HTTP 网站的 Referral 信息而导致数据不准确。</p><h3 id=4-更高的安全性>4. 更高的安全性</h3><p>主流浏览器现在都会针对 HTTPS 网站增加小绿锁标志，没有小绿锁的网站，对用户第一印象就不会很好。</p><h3 id=5-提高网站的信任和信誉>5. 提高网站的信任和信誉</h3><p>Chrome 62 版本以后，如果网页有输入框，没有 HTTPS 的网页一律都显示为不安全。</p><h3 id=6-htlm5-新特性>6. HTLM5 新特性</h3><p>在 Chrome 50版本以后，地理位置，音频视频接口必须要求运行在 HTTPS 上，目的是为了能保证数据传输安全。</p><h3 id=7-ios-ats-要求>7. iOS ATS 要求</h3><p>苹果为了推广HTTPS，在 WWDC 2017 上也宣布新的 App 必须要开启 APS (App Transport Security)安全特性。</p><h2 id=三https-中的密码学>三、HTTPS 中的密码学</h2><h3 id=1-对称密钥加密>1. 对称密钥加密</h3><p>对称密钥加密（Symmetric-Key Encryption），加密的加密和解密使用同一密钥。</p><ul><li>优点：运算速度快；</li><li>缺点：密钥容易被获取。</li></ul><blockquote><p>关于对称加密更加详细的内容，可以看笔者之前写的 <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/HTTPS-symmetric-encryption.md>《漫游对称加密算法》</a></p></blockquote><h3 id=2-公开密钥加密>2. 公开密钥加密</h3><p>公开密钥加密（Public-Key Encryption），也称为非对称密钥加密，使用一对密钥用于加密和解密，分别为公开密钥和私有密钥。公开密钥所有人都可以获得，通信发送方获得接收方的公开密钥之后，就可以使用公开密钥进行加密，接收方收到通信内容后使用私有密钥解密。</p><ul><li>优点：更为安全；</li><li>缺点：运算速度慢；</li></ul><blockquote><p>关于公开密钥加密更加详细的内容，可以看笔者之前写的 <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/HTTPS-asymmetric-encryption.md>《翱游公钥密码算法》</a></p></blockquote><h3 id=3-https-采用的加密方式>3. HTTPS 采用的加密方式</h3><p>HTTPS 采用混合的加密机制，使用公开密钥加密用于传输对称密钥，之后使用对称密钥加密进行通信。（下图中的 Session Key 就是对称密钥）</p><h3 id=4-认证>4. 认证</h3><p>HTTPS 通过使用 <strong>证书</strong> 来对通信方进行认证。</p><p>数字证书认证机构（CA，Certificate Authority）是客户端与服务器双方都可信赖的第三方机构。服务器的运营人员向 CA 提出公开密钥的申请，CA 在判明提出申请者的身份之后，会对已申请的公开密钥做数字签名，然后分配这个已签名的公开密钥，并将该公开密钥放入公开密钥证书后绑定在一起。</p><p>进行 HTTPS 通信时，服务器会把证书发送给客户端，客户端取得其中的公开密钥之后，先进行验证，如果验证通过，就可以开始通信。</p><blockquote><p>关于证书更加详细的内容，可以看笔者之前写的 <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/HTTPS-digital-certificate.md>《随处可见的公钥证书》</a></p></blockquote><p>使用 OpenSSL 这套开源程序，每个人都可以构建一套属于自己的认证机构，从而自己给自己颁发服务器证书。浏览器在访问该服务器时，会显示“无法确认连接安全性”或“该网站的安全证书存在问题”等警告消息。</p><h3 id=5-完整性>5. 完整性</h3><p>TLS / SSL 提供报文摘要功能来验证完整性。</p><h2 id=四https-中的-tls--ssl-协议>四、HTTPS 中的 TLS / SSL 协议</h2><p>能让 HTTPS 带来安全性的是其背后的 TLS 协议。它源于九十年代中期在 Netscape 上开发的称为安全套接字层(SSL)的协议。到 20 世纪 90 年代末，Netscape 将 SSL 移交给了 IETF，IETF 将其重命名为 TLS，并从此成为该协议的管理者。许多人仍将 Web 加密称作 SSL，即使绝大多数服务已切换到仅支持 TLS。</p><ul><li><p>1995: SSL 2.0. 由 Netscape 提出，这个版本由于设计缺陷，并不安全，很快被发现有严重漏洞，已经废弃。</p></li><li><p>1996: SSL 3.0. 写成 RFC，开始流行。目前（2015年）已经不安全，必须禁用。</p></li><li><p>1999: TLS 1.0. 互联网标准化组织 ISOC 接替 NetScape 公司，发布了 SSL 的升级版 TLS 1.0 版。</p></li><li><p>2006: TLS 1.1. 作为 RFC 4346 发布。主要 fix 了 CBC 模式相关的如 BEAST 攻击等漏洞。</p></li><li><p>2008: TLS 1.2. 作为 RFC 5246 发布。增进安全性。目前（2015 年）应该主要部署的版本，请确保你使用的是这个版本。</p></li><li><p>2018：8月10日 RFC8446 TLS 1.3 协议正式发布，它剔除了 TLS 1.2 协议中不安全的因素，极大地增强了协议的安全性和性能。</p></li></ul><p>在 IETF 中，协议被称为 RFC。TLS 1.0 是 RFC 2246，TLS 1.1 是 RFC 4346，TLS 1.2 是 RFC 5246。现在，TLS 1.3 为 RFC 8446。从 TLS 1.2 到 TLS 1.3，前前后后花了快 10 年的时间。RFC 通常按顺序发布，TLS 正式规范都是以 46 作为 RFC 编号的一部分更像是计划好的，并非巧合。</p><p>TLS/SSL 协议位于应用层和传输层 TCP 协议之间。TLS 粗略的划分又可以分为 2 层：</p><ul><li>靠近应用层的握手协议 TLS Handshaking Protocols</li><li>靠近 TCP 的记录层协议 TLS Record Protocol</li></ul><p>TLS 握手协议还能细分为 5 个子协议：</p><ul><li>change_cipher_spec (在 TLS 1.3 中这个协议已经删除，为了兼容 TLS 老版本，可能还会存在)</li><li>alert</li><li>handshake</li><li>application_data</li><li>heartbeat (这个是 TLS 1.3 新加的，TLS 1.3 之前的版本没有这个协议)</li></ul><p>这些子协议之间的关系可以用下图来表示：</p><h3 id=1-tls-记录层协议>1. TLS 记录层协议</h3><p>记录层将上层的信息块分段为 TLSPlaintext 记录，TLSPlaintext 中包含 2^14 字节或更少字节块的数据。根据底层 ContentType 的不同，消息边界的处理方式也不同。TLS 1.3 中的规则比 TLS 1.2 中强制执行的规则更加严格。</p><p>握手消息可以合并为单个 TLSPlaintext 记录，或者在几个记录中分段，前提是：</p><ul><li><p>握手消息不得与其他记录类型交错。也就是说，如果握手消息被分成两个或多个记录，则它们之间不能有任何其他记录。</p></li><li><p>握手消息绝不能跨越密钥更改。实现方必须验证密钥更改之前的所有消息是否与记录边界对齐; 如果没有，那么他们必须用 &ldquo;unexpected_message&rdquo; alert 消息终止连接。因为 ClientHello，EndOfEarlyData，ServerHello，Finished 和 KeyUpdate 消息可以在密钥更改之前立即发生，所以实现方必须将这些消息与记录边界对齐。</p></li></ul><p>实现方绝不能发送握手类型的零长度片段，即使这些片段包含填充。</p><p>另外 Alert 消息禁止在记录之间进行分段，并且多条 alert 消息不得合并为单个 TLSPlaintext 记录。换句话说，具有 alert 类型的记录必须只包含一条消息。</p><p>应用数据消息包含对 TLS 不透明的数据。应用数据消息始终应该受到保护。可以发送应用数据的零长度片段，因为它们可能作为流量分析对策使用。应用数据片段可以拆分为多个记录，也可以合并为一个记录。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>      <span style=color:#66d9ef>struct</span> {
          ContentType type;
          ProtocolVersion legacy_record_version;
          uint16 length;
          opaque fragment[TLSPlaintext.length];
      } TLSPlaintext;
</code></pre></div><ul><li>type:<br>用于处理 TLS 握手层的高级协议。</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>      <span style=color:#66d9ef>enum</span> {
          invalid(<span style=color:#ae81ff>0</span>),
          change_cipher_spec(<span style=color:#ae81ff>20</span>),
          alert(<span style=color:#ae81ff>21</span>),
          handshake(<span style=color:#ae81ff>22</span>),
          application_data(<span style=color:#ae81ff>23</span>),
          heartbeat(<span style=color:#ae81ff>24</span>),  <span style=color:#75715e>/* RFC 6520 */</span>
          (<span style=color:#ae81ff>255</span>)
      } ContentType;
</code></pre></div><p>ContentType 是对握手协议的封装，消息头类型和握手层子协议编号的对应关系如下：</p><table><thead><tr><th align=center>消息头类型</th><th align=center>ContentType</th></tr></thead><tbody><tr><td align=center>change_cipher_spec</td><td align=center>0x014</td></tr><tr><td align=center>alert</td><td align=center>0x015</td></tr><tr><td align=center>handshake</td><td align=center>0x016</td></tr><tr><td align=center>application_data</td><td align=center>0x017</td></tr><tr><td align=center>heartbeat (TLS 1.3 新增)</td><td align=center>0x018</td></tr></tbody></table><ul><li>legacy_record_version:<br>对于除初始 ClientHello 之外的 TLS 1.3 实现生成的所有记录(即，在 HelloRetryRequest 之后未生成的记录)，必须将其设置为 0x0303，其中出于兼容性目的，它也可以是0x0301。该字段在 TLS 1.3 中已经弃用，必须忽略它。在某些情况下，以前版本的 TLS 将在此字段中使用其他值。</li></ul><p>在 TLS 1.3 中，version 为 0x0304，过去版本与 version 的对应关系如下：</p><table><thead><tr><th align=center>协议版本</th><th align=center>version</th></tr></thead><tbody><tr><td align=center>TLS 1.3</td><td align=center>0x0304</td></tr><tr><td align=center>TLS 1.2</td><td align=center>0x0303</td></tr><tr><td align=center>TLS 1.1</td><td align=center>0x0302</td></tr><tr><td align=center>TLS 1.0</td><td align=center>0x0301</td></tr><tr><td align=center>SSL 3.0</td><td align=center>0x0300</td></tr></tbody></table><ul><li><p>length:<br>TLSPlaintext.fragment 的长度(以字节为单位)。长度不得超过 2 ^ 14 字节。接收超过此长度的记录的端点必须使用 &ldquo;record_overflow&rdquo; alert 消息终止连接。</p></li><li><p>fragment:<br>正在传输的数据。此字段的值是透明的，它并被视为一个独立的块，由类型字段指定的更高级别协议处理。</p></li></ul><p>当尚未使用密码保护时，TLSPlaintext 结构是直接写入传输线路中的。一旦记录保护开始，TLSPlaintext 记录将受到密码保护。请注意，应用数据记录不得写入未受保护的连接中。所以在握手成功之前，是不能发送应用数据的。</p><p>TLS 记录层协议在整个 TLS 协议中的定位如下：</p><ul><li><p>封装处理 TLS 上层(握手层)中的平行子协议(TLS 1.3 中是 5 个子协议，TLS 1.2 及更老的版本是 4 个子协议)，加上消息头，打包往下传递给 TCP 处理。</p></li><li><p>对上层应用数据协议进行密码保护，对其他的子协议只是简单封装(即不加密)</p></li></ul><blockquote><p>关于 TLS 记录层协议更多细节将在接下来的文章中详细分析。也会对 TLS 1.2 和 TLS 1.3 展开对比。</p></blockquote><h3 id=2-tls-密码切换协议>2. TLS 密码切换协议</h3><blockquote><p><strong>注意</strong>：该协议在 TLS 1.3 标准规范中已经删除，但是实际使用中为了兼容 TLS 老版本和一些消息中间件，所以实际传输中还可能用到这个协议。</p></blockquote><p>change_cipher_spec (以下简称 CCS 协议) 协议，是 TLS 记录层对应用数据是否进行加密的分界线。客户端或者服务端一旦收到对端发来的 CCS 协议，就表明接下来传输数据过程中可以对应用数据协议进行加密了。</p><p>TLS 记录层在处理上层 5 个协议(密码切换协议，警告协议，握手协议，心跳协议，应用数据协议)的时候，TLS 不同版本对不同协议加密的情况不同，具体情况如下：</p><table><thead><tr><th align=center>协议版本</th><th align=center>密码切换协议</th><th align=center>警告协议</th><th align=center>握手协议</th><th align=center>心跳协议</th><th align=center>应用数据协议</th></tr></thead><tbody><tr><td align=center>TLS 1.3</td><td align=center>无</td><td align=center>✅(根据连接状态不同进行加密，即一部分会加密)</td><td align=center>✅(一部分加密)</td><td align=center>❌</td><td align=center>✅</td></tr><tr><td align=center>TLS 1.2</td><td align=center>❌</td><td align=center>❌</td><td align=center>❌</td><td align=center>无</td><td align=center>✅</td></tr></tbody></table><blockquote><p>关于 TLS CCS 协议更多细节将在接下来的握手文章中详细分析。也会对 TLS 1.2 和 TLS 1.3 展开对比。</p></blockquote><p>协议数据结构如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>struct</span> {
       <span style=color:#66d9ef>enum</span> { change_cipher_spec(<span style=color:#ae81ff>1</span>), (<span style=color:#ae81ff>255</span>) } type;
   } ChangeCipherSpec;
</code></pre></div><p>经过 TLS 记录层包装以后，结构如下:</p><h3 id=3-tls-警告协议>3. TLS 警告协议</h3><p>TLS 提供 alert 内容类型用来表示关闭信息和错误。与其他消息一样，alert 消息也会根据当前连接状态的进行加密。在 TLS 1.3 中，错误的严重性隐含在正在发送的警报类型中，并且可以安全地忽略 &ldquo;level&rdquo; 字段。&ldquo;close_notify&rdquo; alert 用于表示连接从一个方向开始有序的关闭。收到这样的警报后，TLS 实现方应该表明应用程序的数据结束。</p><p>收到错误警报后，TLS 实现方应该向应用程序表示出现了错误，并且不允许在连接上发送或接收任何其他数据。</p><p>协议数据结构如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>      <span style=color:#66d9ef>enum</span> { warning(<span style=color:#ae81ff>1</span>), fatal(<span style=color:#ae81ff>2</span>), (<span style=color:#ae81ff>255</span>) } AlertLevel;
      
      <span style=color:#66d9ef>struct</span> {
          AlertLevel level;
          AlertDescription description;
      } Alert;
</code></pre></div><p>经过 TLS 记录层包装以后，结构如下:</p><p>TLS 1.3 和 TLS 1.2 在这个协议上改动很小，只是新增加了几个枚举类型。</p><p>TLS 1.2 的所有警告描述信息：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#66d9ef>enum</span> {
       close_notify(<span style=color:#ae81ff>0</span>),
       unexpected_message(<span style=color:#ae81ff>10</span>),
       bad_record_mac(<span style=color:#ae81ff>20</span>),
       decryption_failed_RESERVED(<span style=color:#ae81ff>21</span>),
       record_overflow(<span style=color:#ae81ff>22</span>),
       decompression_failure(<span style=color:#ae81ff>30</span>),
       handshake_failure(<span style=color:#ae81ff>40</span>),
       no_certificate_RESERVED(<span style=color:#ae81ff>41</span>),
       bad_certificate(<span style=color:#ae81ff>42</span>),
       unsupported_certificate(<span style=color:#ae81ff>43</span>),
       certificate_revoked(<span style=color:#ae81ff>44</span>),
       certificate_expired(<span style=color:#ae81ff>45</span>),
       certificate_unknown(<span style=color:#ae81ff>46</span>),
       illegal_parameter(<span style=color:#ae81ff>47</span>),
       unknown_ca(<span style=color:#ae81ff>48</span>),
       access_denied(<span style=color:#ae81ff>49</span>),
       decode_error(<span style=color:#ae81ff>50</span>),
       decrypt_error(<span style=color:#ae81ff>51</span>),
       export_restriction_RESERVED(<span style=color:#ae81ff>60</span>),
       protocol_version(<span style=color:#ae81ff>70</span>),
       insufficient_security(<span style=color:#ae81ff>71</span>),
       internal_error(<span style=color:#ae81ff>80</span>),
       user_canceled(<span style=color:#ae81ff>90</span>),
       no_renegotiation(<span style=color:#ae81ff>100</span>),
       unsupported_extension(<span style=color:#ae81ff>110</span>),           <span style=color:#75715e>/* new */</span>
       (<span style=color:#ae81ff>255</span>)
   } AlertDescription;
</code></pre></div><p>TLS 1.3 的所有警告描述信息：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>      <span style=color:#66d9ef>enum</span> {
          close_notify(<span style=color:#ae81ff>0</span>),
          unexpected_message(<span style=color:#ae81ff>10</span>),
          bad_record_mac(<span style=color:#ae81ff>20</span>),
          decryption_failed_RESERVED(<span style=color:#ae81ff>21</span>),
          record_overflow(<span style=color:#ae81ff>22</span>),
          decompression_failure_RESERVED(<span style=color:#ae81ff>30</span>),
          handshake_failure(<span style=color:#ae81ff>40</span>),
          no_certificate_RESERVED(<span style=color:#ae81ff>41</span>),
          bad_certificate(<span style=color:#ae81ff>42</span>),
          unsupported_certificate(<span style=color:#ae81ff>43</span>),
          certificate_revoked(<span style=color:#ae81ff>44</span>),
          certificate_expired(<span style=color:#ae81ff>45</span>),
          certificate_unknown(<span style=color:#ae81ff>46</span>),
          illegal_parameter(<span style=color:#ae81ff>47</span>),
          unknown_ca(<span style=color:#ae81ff>48</span>),
          access_denied(<span style=color:#ae81ff>49</span>),
          decode_error(<span style=color:#ae81ff>50</span>),
          decrypt_error(<span style=color:#ae81ff>51</span>),
          export_restriction_RESERVED(<span style=color:#ae81ff>60</span>),
          protocol_version(<span style=color:#ae81ff>70</span>),
          insufficient_security(<span style=color:#ae81ff>71</span>),
          internal_error(<span style=color:#ae81ff>80</span>),
          inappropriate_fallback(<span style=color:#ae81ff>86</span>),
          user_canceled(<span style=color:#ae81ff>90</span>),
          no_renegotiation_RESERVED(<span style=color:#ae81ff>100</span>),
          missing_extension(<span style=color:#ae81ff>109</span>),
          unsupported_extension(<span style=color:#ae81ff>110</span>),
          certificate_unobtainable_RESERVED(<span style=color:#ae81ff>111</span>),
          unrecognized_name(<span style=color:#ae81ff>112</span>),
          bad_certificate_status_response(<span style=color:#ae81ff>113</span>),
          bad_certificate_hash_value_RESERVED(<span style=color:#ae81ff>114</span>),
          unknown_psk_identity(<span style=color:#ae81ff>115</span>),
          certificate_required(<span style=color:#ae81ff>116</span>),
          no_application_protocol(<span style=color:#ae81ff>120</span>),
          (<span style=color:#ae81ff>255</span>)
      } AlertDescription;
</code></pre></div><p>TLS 1.3 比 TLS 1.2 新增了 9 个警告描述信息：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>          inappropriate_fallback(<span style=color:#ae81ff>86</span>),
          missing_extension(<span style=color:#ae81ff>109</span>),
          certificate_unobtainable_RESERVED(<span style=color:#ae81ff>111</span>),
          unrecognized_name(<span style=color:#ae81ff>112</span>),
          bad_certificate_status_response(<span style=color:#ae81ff>113</span>),
          bad_certificate_hash_value_RESERVED(<span style=color:#ae81ff>114</span>),
          unknown_psk_identity(<span style=color:#ae81ff>115</span>),
          certificate_required(<span style=color:#ae81ff>116</span>),
          no_application_protocol(<span style=color:#ae81ff>120</span>),

</code></pre></div><h3 id=4-tls-握手协议>4. TLS 握手协议</h3><p>握手协议是整个 TLS 协议簇中最最核心的协议，HTTPS 能保证安全也是因为它的功劳。</p><p>握手协议由多个子消息构成，服务端和客户端第一次完成一次握手需要 2-RTT。</p><p>握手协议的目的是为了双方协商出密码块，这个密码块会交给 TLS 记录层进行密钥加密。也就是说握手协议达成的“共识”(密码块)是整个 TLS 和 HTTPS 安全的基础。</p><p>握手协议在 TLS 1.2 和 TLS 1.3 中发生了很大的变化。TLS 1.3 的 0-RTT 是一个全新的概念。两个版本在密钥协商上，密码套件选择上都有很大不同。</p><p>TLS 1.2 协议数据结构如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>enum</span> {
       hello_request(<span style=color:#ae81ff>0</span>), 
       client_hello(<span style=color:#ae81ff>1</span>), 
       server_hello(<span style=color:#ae81ff>2</span>),
       certificate(<span style=color:#ae81ff>11</span>), 
       server_key_exchange (<span style=color:#ae81ff>12</span>),
       certificate_request(<span style=color:#ae81ff>13</span>), 
       server_hello_done(<span style=color:#ae81ff>14</span>),
       certificate_verify(<span style=color:#ae81ff>15</span>), 
       client_key_exchange(<span style=color:#ae81ff>16</span>),
       finished(<span style=color:#ae81ff>20</span>)
       (<span style=color:#ae81ff>255</span>)
   } HandshakeType;

   <span style=color:#66d9ef>struct</span> {
       HandshakeType msg_type;
       uint24 length;
       select (HandshakeType) {
           <span style=color:#66d9ef>case</span> hello_request:       HelloRequest;
           <span style=color:#66d9ef>case</span> client_hello:        ClientHello;
           <span style=color:#66d9ef>case</span> server_hello:        ServerHello;
           <span style=color:#66d9ef>case</span> certificate:         Certificate;
           <span style=color:#66d9ef>case</span> server_key_exchange: ServerKeyExchange;
           <span style=color:#66d9ef>case</span> certificate_request: CertificateRequest;
           <span style=color:#66d9ef>case</span> server_hello_done:   ServerHelloDone;
           <span style=color:#66d9ef>case</span> certificate_verify:  CertificateVerify;
           <span style=color:#66d9ef>case</span> client_key_exchange: ClientKeyExchange;
           <span style=color:#66d9ef>case</span> finished:            Finished;
       } body;
   } Handshake;
</code></pre></div><p>TLS 1.3 协议数据结构如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>      <span style=color:#66d9ef>enum</span> {
          hello_request_RESERVED(<span style=color:#ae81ff>0</span>),
          client_hello(<span style=color:#ae81ff>1</span>),
          server_hello(<span style=color:#ae81ff>2</span>),
          hello_verify_request_RESERVED(<span style=color:#ae81ff>3</span>),
          new_session_ticket(<span style=color:#ae81ff>4</span>),
          end_of_early_data(<span style=color:#ae81ff>5</span>),
          hello_retry_request_RESERVED(<span style=color:#ae81ff>6</span>),
          encrypted_extensions(<span style=color:#ae81ff>8</span>),
          certificate(<span style=color:#ae81ff>11</span>),
          server_key_exchange_RESERVED(<span style=color:#ae81ff>12</span>),
          certificate_request(<span style=color:#ae81ff>13</span>),
          server_hello_done_RESERVED(<span style=color:#ae81ff>14</span>),
          certificate_verify(<span style=color:#ae81ff>15</span>),
          client_key_exchange_RESERVED(<span style=color:#ae81ff>16</span>),
          finished(<span style=color:#ae81ff>20</span>),
          certificate_url_RESERVED(<span style=color:#ae81ff>21</span>),
          certificate_status_RESERVED(<span style=color:#ae81ff>22</span>),
          supplemental_data_RESERVED(<span style=color:#ae81ff>23</span>),
          key_update(<span style=color:#ae81ff>24</span>),
          message_hash(<span style=color:#ae81ff>254</span>),
          (<span style=color:#ae81ff>255</span>)
      } HandshakeType;

      <span style=color:#66d9ef>struct</span> {
          HandshakeType msg_type;    <span style=color:#75715e>/* handshake type */</span>
          uint24 length;             <span style=color:#75715e>/* bytes in message */</span>
          select (Handshake.msg_type) {
              <span style=color:#66d9ef>case</span> client_hello:          ClientHello;
              <span style=color:#66d9ef>case</span> server_hello:          ServerHello;
              <span style=color:#66d9ef>case</span> end_of_early_data:     EndOfEarlyData;
              <span style=color:#66d9ef>case</span> encrypted_extensions:  EncryptedExtensions;
              <span style=color:#66d9ef>case</span> certificate_request:   CertificateRequest;
              <span style=color:#66d9ef>case</span> certificate:           Certificate;
              <span style=color:#66d9ef>case</span> certificate_verify:    CertificateVerify;
              <span style=color:#66d9ef>case</span> finished:              Finished;
              <span style=color:#66d9ef>case</span> new_session_ticket:    NewSessionTicket;
              <span style=color:#66d9ef>case</span> key_update:            KeyUpdate;
          };
      } Handshake;
</code></pre></div><p>经过 TLS 记录层包装以后，结构如下:</p><p>握手消息类型虽然有很多种，但是最终传到 TLS 记录层，有些会被合并到一条消息。</p><blockquote><p>关于 TLS 握手协议更多细节将在接下来的文章中详细分析。也会对 TLS 1.2 和 TLS 1.3 展开对比。</p></blockquote><h3 id=5-tls-应用数据协议>5. TLS 应用数据协议</h3><p>应用数据协议就是 TLS 上层的各种协议，TLS 主要保护的数据就是应用数据协议的数据。</p><p>经过 TLS 记录层包装以后，结构如下:</p><p>TLS 记录层会根据加密模式的不同在应用数据的末尾加上 MAC 校验数据。</p><h3 id=6-tls-心跳协议>6. TLS 心跳协议</h3><p>这个协议是 TLS 1.3 新增的。更加细节可以看这篇文章<a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/TLS_Heartbeat.md>《TLS & DTLS Heartbeat Extension》</a>，这篇文章是笔者根据 <a href=https://tools.ietf.org/html/rfc6520>[RFC 6520]</a> 翻译的。感兴趣的可以去看看这篇文章。这篇文章还涉及到了 DTLS 和 PMTU 发现。</p><p>协议数据结构如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   <span style=color:#66d9ef>enum</span> {
      heartbeat_request(<span style=color:#ae81ff>1</span>),
      heartbeat_response(<span style=color:#ae81ff>2</span>),
      (<span style=color:#ae81ff>255</span>)
   } HeartbeatMessageType;
   
   <span style=color:#66d9ef>struct</span> {
      HeartbeatMessageType type;
      uint16 payload_length;
      opaque payload[HeartbeatMessage.payload_length];
      opaque padding[padding_length];
   } HeartbeatMessage;
</code></pre></div><p>经过 TLS 记录层包装以后，结构如下:</p><p>根据 <a href=https://tools.ietf.org/html/rfc6066>[RFC6066]</a> 中的定义，在协商的时候，HeartbeatMessage 的总长度不得超过 2 ^ 14 或 max_fragment_length。</p><p>HeartbeatMessage 的长度为 TLS 的TLSPlaintext.length 和 DTLS 的 DTLSPlaintext.length。此外，类型 type 字段的长度是 1 个字节，并且 payload_length 的长度是 2 个字节。因此，padding_length 是TLSPlaintext.length - payload_length - 3 用于 TLS，DTLSPlaintext.length - payload_length - 3 用于 DTLS。padding_length 必须至少为 16。</p><p>HeartbeatMessage 的发送方必须使用至少 16 个字节的随机填充。必须忽略收到的HeartbeatMessage 消息的填充。</p><h2 id=五-接下来>五. 接下来</h2><p>本篇文章作为 HTTPS 的开篇文章，分析了 HTTTPS 协议存在的必要性，HTTPS 带来的好处，HTTPS 安全的本质，以及 TLS 各个子协议之间的关系和作用。</p><p>接下来的几篇文章将会详细的对比 TLS 1.2 和 TLS 1.3 在握手协议上的差别，在记录层上的差别，在密钥导出上的差别，以及 TLS 1.3 新增的 0-RTT 到底是怎么回事。</p><hr><p>Reference：</p><p>《图解 HTTP》<br>《深入浅出 HTTPS》<br><a href=https://tools.ietf.org/html/rfc8446>TLS 1.3 规范 [RFC 8446]</a><br><a href=https://tools.ietf.org/html/rfc5246>TLS 1.2 规范 [RFC 5246]</a></p><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://halfrost.com/HTTPS-begin/>https://halfrost.com/HTTPS_begin/</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一为什么需要-https>一、为什么需要 HTTPS</a><ul><li><a href=#1-数据没有加密>1. 数据没有加密</a></li><li><a href=#2-无法验证通信对方的身份>2. 无法验证通信对方的身份</a></li><li><a href=#3-无法防止数据被篡改>3. 无法防止数据被篡改</a></li></ul></li><li><a href=#二部署-https-有何好处>二、部署 HTTPS 有何好处</a><ul><li><a href=#1-使用-http2-获得更高的性能>1. 使用 HTTP/2 获得更高的性能</a></li><li><a href=#2-提高-seo-排名>2. 提高 SEO 排名</a></li><li><a href=#3-更好的推荐数据>3. 更好的推荐数据</a></li><li><a href=#4-更高的安全性>4. 更高的安全性</a></li><li><a href=#5-提高网站的信任和信誉>5. 提高网站的信任和信誉</a></li><li><a href=#6-htlm5-新特性>6. HTLM5 新特性</a></li><li><a href=#7-ios-ats-要求>7. iOS ATS 要求</a></li></ul></li><li><a href=#三https-中的密码学>三、HTTPS 中的密码学</a><ul><li><a href=#1-对称密钥加密>1. 对称密钥加密</a></li><li><a href=#2-公开密钥加密>2. 公开密钥加密</a></li><li><a href=#3-https-采用的加密方式>3. HTTPS 采用的加密方式</a></li><li><a href=#4-认证>4. 认证</a></li><li><a href=#5-完整性>5. 完整性</a></li></ul></li><li><a href=#四https-中的-tls--ssl-协议>四、HTTPS 中的 TLS / SSL 协议</a><ul><li><a href=#1-tls-记录层协议>1. TLS 记录层协议</a></li><li><a href=#2-tls-密码切换协议>2. TLS 密码切换协议</a></li><li><a href=#3-tls-警告协议>3. TLS 警告协议</a></li><li><a href=#4-tls-握手协议>4. TLS 握手协议</a></li><li><a href=#5-tls-应用数据协议>5. TLS 应用数据协议</a></li><li><a href=#6-tls-心跳协议>6. TLS 心跳协议</a></li></ul></li><li><a href=#五-接下来>五. 接下来</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&text=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&is_video=false&description=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&title=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&name=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87&description=%e4%b8%80%e3%80%81%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%20HTTPS%20HTTP1.1%20%e6%9c%89%e4%bb%a5%e4%b8%8b%e5%ae%89%e5%85%a8%e6%80%a7%e9%97%ae%e9%a2%98%ef%bc%9a%0a%20%e4%bd%bf%e7%94%a8%e6%98%8e%e6%96%87%28%e4%b8%8d%e5%8a%a0%e5%af%86%29%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%ef%bc%8c%e5%86%85%e5%ae%b9%e5%8f%af%e8%83%bd%e4%bc%9a%e8%a2%ab%e7%aa%83%e5%90%ac%ef%bc%9b%20%e4%b8%8d%e9%aa%8c%e8%af%81%e9%80%9a%e4%bf%a1%e6%96%b9%e7%9a%84%e8%ba%ab%e4%bb%bd%ef%bc%8c%e9%80%9a%e4%bf%a1%e6%96%b9%e7%9a%84%e8%ba%ab%e4%bb%bd%e6%9c%89%e5%8f%af%e8%83%bd%e9%81%ad%e9%81%87%e4%bc%aa%e8%a3%85%ef%bc%9b%20%e6%97%a0%e6%b3%95%e8%af%81%e6%98%8e%e6%8a%a5%e6%96%87%e7%9a%84%e5%ae%8c%e6%95%b4%e6%80%a7%ef%bc%8c%e6%8a%a5%e6%96%87%e6%9c%89%e5%8f%af%e8%83%bd%e9%81%ad%e7%af%a1%e6%94%b9%e3%80%82%20%20%e7%94%b1%e4%ba%8e%20HTTP%20%e8%ae%be%e8%ae%a1%e4%b9%8b%e5%88%9d%e6%b2%a1%e6%9c%89%e8%80%83%e8%99%91%e5%88%b0%e8%bf%99%e5%87%a0%e7%82%b9%ef%bc%8c%e6%89%80%e4%bb%a5%e5%9f%ba%e4%ba%8e%20HTTP%20%e7%9a%84%e8%bf%99%e4%ba%9b%e5%ba%94%e7%94%a8%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98%e3%80%82%0a1.%20%e6%95%b0%e6%8d%ae%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%20%e5%9f%ba%e4%ba%8e%20TCP%2fIP%20%e7%9a%84%e7%bd%91%e7%bb%9c%ef%bc%8c%e7%bd%91%e7%bb%9c%e5%90%84%e5%a4%84%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e8%a2%ab%e7%9b%91%e5%90%ac%e7%9a%84%e9%a3%8e%e9%99%a9%e3%80%82%e8%80%8c%e4%b8%94%e5%a6%82%e6%9e%9c%e7%94%a8%20HTTP%20%e5%8d%8f%e8%ae%ae%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%ef%bc%8cHTTP%20%e6%9c%ac%e8%ba%ab%e6%b2%a1%e6%9c%89%e5%8a%a0%e5%af%86%e5%8a%9f%e8%83%bd%ef%bc%8c%e6%89%80%e4%bb%a5%e4%b9%9f%e6%97%a0%e6%b3%95%e5%81%9a%e5%88%b0%e5%af%b9%e9%80%9a%e4%bf%a1%e6%95%b4%e4%bd%93%28%e4%bd%bf%e7%94%a8%20HTTP%20%e5%8d%8f%e8%ae%ae%e9%80%9a%e4%bf%a1%e7%9a%84%e8%af%b7%e6%b1%82%e5%92%8c%e5%93%8d%e5%ba%94%e7%9a%84%e5%86%85%e5%ae%b9%29%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e3%80%82%e5%8d%b3%ef%bc%8cHTTP%20%e6%8a%a5%e6%96%87%e4%bd%bf%e7%94%a8%e6%98%8e%e6%96%87%28%e6%8c%87%e6%9c%aa%e7%bb%8f%e8%bf%87%e5%8a%a0%e5%af%86%e7%9a%84%e6%8a%a5%e6%96%87%29%e6%96%b9%e5%bc%8f%e5%8f%91%e9%80%81%e3%80%82%0a%e5%83%8f%e4%b8%8a%e5%9b%be%e8%a1%a8%e7%a4%ba%e7%9a%84%e9%82%a3%e6%a0%b7%ef%bc%8c%e5%9c%a8%e4%ba%92%e8%81%94%e7%bd%91%e5%90%84%e4%b8%aa%e7%8e%af%e8%8a%82%e9%83%bd%e5%8f%af%e8%83%bd%e8%a2%ab%e7%9b%91%e5%90%ac%e3%80%82%e5%b0%b1%e7%ae%97%e6%98%af%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%ef%bc%8c%e4%b9%9f%e8%83%bd%e8%a2%ab%e7%9b%91%e5%90%ac%e5%88%b0%e9%80%9a%e4%bf%a1%e5%86%85%e5%ae%b9%ef%bc%8c%e5%8f%aa%e4%b8%8d%e8%bf%87%e7%9b%91%e5%90%ac%e8%80%85%e7%9c%8b%e5%88%b0%e7%9a%84%e6%98%af%e5%af%86%e6%96%87%e3%80%82%e8%a6%81%e8%a7%a3%e5%86%b3%20HTTP%20%e4%b8%8a%e9%9d%a2%203%20%e4%b8%aa%e5%a4%a7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98%ef%bc%8c%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%b0%b1%e6%98%af%e8%a6%81%e5%85%88%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%e3%80%82%e4%ba%8e%e6%98%af%e5%9c%a8%e4%bc%a0%e8%be%93%e5%b1%82%e5%a2%9e%e5%8a%a0%e4%ba%86%e4%b8%80%e5%b1%82%20SSL%ef%bc%88Secure%20Sockets%20Layer%20%e5%ae%89%e5%85%a8%e5%a5%97%e6%8e%a5%e5%b1%82%ef%bc%89%2f%20TLS%20%28Transport%20Layer%20Security%20%e5%ae%89%e5%85%a8%e5%b1%82%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%29%20%e6%9d%a5%e5%8a%a0%e5%af%86%20HTTP%20%e7%9a%84%e9%80%9a%e4%bf%a1%e5%86%85%e5%ae%b9%e3%80%82%0aHTTPS%20%28HTTP%20Secure%29%20%e5%b9%b6%e4%b8%8d%e6%98%af%e6%96%b0%e5%8d%8f%e8%ae%ae%ef%bc%8c%e8%80%8c%e6%98%af%20HTTP%20%e5%85%88%e5%92%8c%20SSL%ef%bc%88Secure%20Sockets%20Layer%20%e5%ae%89%e5%85%a8%e5%a5%97%e6%8e%a5%e5%b1%82%ef%bc%89%2f%20TLS%20%28Transport%20Layer%20Security%20%e5%ae%89%e5%85%a8%e5%b1%82%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae%29%20%e9%80%9a%e4%bf%a1%ef%bc%8c%e5%86%8d%e7%94%b1%20SSL%2fTLS%20%e5%92%8c%20TCP%20%e9%80%9a%e4%bf%a1%e3%80%82%e4%b9%9f%e5%b0%b1%e6%98%af%e8%af%b4%20HTTPS%20%e4%bd%bf%e7%94%a8%e4%ba%86%e9%9a%a7%e9%81%93%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%e3%80%82%0a%e8%bf%99%e4%b8%aa%e6%97%b6%e5%80%99%e5%8f%af%e8%83%bd%e6%9c%89%e5%90%8c%e5%ad%a6%e4%bc%9a%e6%9c%89%e7%96%91%e9%97%ae%e4%ba%86%ef%bc%8c%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e7%9b%b4%e6%8e%a5%e5%af%b9%20HTTP%20%e6%8a%a5%e6%96%87%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e4%b8%8d%e9%9c%80%e8%a6%81%20SSL%2fTLS%20%e8%bf%99%e4%b8%80%e5%b1%82%e4%ba%86%e3%80%82%e7%a1%ae%e5%ae%9e%ef%bc%8c%e5%a6%82%e6%9e%9c%e7%9b%b4%e6%8e%a5%e5%af%b9%20HTTP%20%e6%8a%a5%e6%96%87%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e4%b9%9f%e5%8f%af%e4%bb%a5%e5%81%9a%e5%88%b0%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%ef%bc%8c%e4%bd%86%e6%98%af%e8%99%bd%e7%84%b6%e8%a7%a3%e5%86%b3%e4%ba%86%e7%ac%ac%e4%b8%80%e6%9d%a1%ef%bc%8c%e4%bd%86%e6%98%af%e5%90%8e%e9%9d%a2%202%20%e6%9d%a1%e5%b0%b1%e4%b8%8d%e5%a5%bd%e8%a7%a3%e5%86%b3%e4%ba%86%e3%80%82"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fhttps-begin%2f&t=HTTPS%20%e6%b8%a9%e6%95%85%e7%9f%a5%e6%96%b0%ef%bc%88%e4%b8%80%ef%bc%89%20%e2%80%94%e2%80%94%20%e5%bc%80%e7%af%87"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>