<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>TLS 1.3 Cryptographic Computations | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="TLS 1.3 Cryptographic Computations"><meta property="og:description" content="TLS 握手建立一个或多个输入的 secrets，如下文所述，将这些 secrets 组合起来以创建实际工作密钥材料。密钥派生过程包含输入 secrets 和握手记录。请注意，由于握手记录包含来自 Hello 消息的随机值，因此即使使用相同的输入 secrets，任何给定的握手都将具有不同的流量 secrets，就像将相同的 PSK 用于多个连接的情况一样。
一. Key Schedule 密钥派生过程使用 HKDF [RFC5869] 定义的 HKDF-Extract 和 HKDF-Expand 函数，以及下面定义的函数:
HKDF-Expand-Label(Secret, Label, Context, Length) = HKDF-Expand(Secret, HkdfLabel, Length) Where HkdfLabel is specified as: struct { uint16 length = Length; opaque label<7..255> = &#34;tls13 &#34; + Label; opaque context<0..255> = Context; } HkdfLabel; Derive-Secret(Secret, Label, Messages) = HKDF-Expand-Label(Secret, Label, Transcript-Hash(Messages), Hash.length) Transcript-Hash 和 HKDF 使用的 Hash 函数是密码套件哈希算法。Hash.length 是其输出长度(以字节为单位)。消息是表示的握手消息的串联，包括握手消息类型和长度字段，但不包括记录层头。请注意，在某些情况下，零长度 context（由 &#34;&rdquo; 表示）传递给 HKDF-Expand-Label。本文档中指定的 labels 都是 ASCII 字符串，不包括尾随 NUL 字节。"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/tls_1-3_cryptographic_computations/"><meta property="article:published_time" content="2018-11-11T00:44:00+00:00"><meta property="article:modified_time" content="2018-11-11T00:44:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="TLS 1.3 Cryptographic Computations"><meta name=twitter:description content="TLS 握手建立一个或多个输入的 secrets，如下文所述，将这些 secrets 组合起来以创建实际工作密钥材料。密钥派生过程包含输入 secrets 和握手记录。请注意，由于握手记录包含来自 Hello 消息的随机值，因此即使使用相同的输入 secrets，任何给定的握手都将具有不同的流量 secrets，就像将相同的 PSK 用于多个连接的情况一样。
一. Key Schedule 密钥派生过程使用 HKDF [RFC5869] 定义的 HKDF-Extract 和 HKDF-Expand 函数，以及下面定义的函数:
HKDF-Expand-Label(Secret, Label, Context, Length) = HKDF-Expand(Secret, HkdfLabel, Length) Where HkdfLabel is specified as: struct { uint16 length = Length; opaque label<7..255> = &#34;tls13 &#34; + Label; opaque context<0..255> = Context; } HkdfLabel; Derive-Secret(Secret, Label, Messages) = HKDF-Expand-Label(Secret, Label, Transcript-Hash(Messages), Hash.length) Transcript-Hash 和 HKDF 使用的 Hash 函数是密码套件哈希算法。Hash.length 是其输出长度(以字节为单位)。消息是表示的握手消息的串联，包括握手消息类型和长度字段，但不包括记录层头。请注意，在某些情况下，零长度 context（由 &#34;&rdquo; 表示）传递给 HKDF-Expand-Label。本文档中指定的 labels 都是 ASCII 字符串，不包括尾随 NUL 字节。"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/tls_1-3_alert_protocol/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/tls_1-3_0-rtt/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&text=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&is_video=false&description=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TLS%201.3%20Cryptographic%20Computations&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&name=TLS%201.3%20Cryptographic%20Computations&description=TLS%20%e6%8f%a1%e6%89%8b%e5%bb%ba%e7%ab%8b%e4%b8%80%e4%b8%aa%e6%88%96%e5%a4%9a%e4%b8%aa%e8%be%93%e5%85%a5%e7%9a%84%20secrets%ef%bc%8c%e5%a6%82%e4%b8%8b%e6%96%87%e6%89%80%e8%bf%b0%ef%bc%8c%e5%b0%86%e8%bf%99%e4%ba%9b%20secrets%20%e7%bb%84%e5%90%88%e8%b5%b7%e6%9d%a5%e4%bb%a5%e5%88%9b%e5%bb%ba%e5%ae%9e%e9%99%85%e5%b7%a5%e4%bd%9c%e5%af%86%e9%92%a5%e6%9d%90%e6%96%99%e3%80%82%e5%af%86%e9%92%a5%e6%b4%be%e7%94%9f%e8%bf%87%e7%a8%8b%e5%8c%85%e5%90%ab%e8%be%93%e5%85%a5%20secrets%20%e5%92%8c%e6%8f%a1%e6%89%8b%e8%ae%b0%e5%bd%95%e3%80%82%e8%af%b7%e6%b3%a8%e6%84%8f%ef%bc%8c%e7%94%b1%e4%ba%8e%e6%8f%a1%e6%89%8b%e8%ae%b0%e5%bd%95%e5%8c%85%e5%90%ab%e6%9d%a5%e8%87%aa%20Hello%20%e6%b6%88%e6%81%af%e7%9a%84%e9%9a%8f%e6%9c%ba%e5%80%bc%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%8d%b3%e4%bd%bf%e4%bd%bf%e7%94%a8%e7%9b%b8%e5%90%8c%e7%9a%84%e8%be%93%e5%85%a5%20secrets%ef%bc%8c%e4%bb%bb%e4%bd%95%e7%bb%99%e5%ae%9a%e7%9a%84%e6%8f%a1%e6%89%8b%e9%83%bd%e5%b0%86%e5%85%b7%e6%9c%89%e4%b8%8d%e5%90%8c%e7%9a%84%e6%b5%81%e9%87%8f%20secrets%ef%bc%8c%e5%b0%b1%e5%83%8f%e5%b0%86%e7%9b%b8%e5%90%8c%e7%9a%84%20PSK%20%e7%94%a8%e4%ba%8e%e5%a4%9a%e4%b8%aa%e8%bf%9e%e6%8e%a5%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%80%e6%a0%b7%e3%80%82%0a%e4%b8%80.%20Key%20Schedule%20%e5%af%86%e9%92%a5%e6%b4%be%e7%94%9f%e8%bf%87%e7%a8%8b%e4%bd%bf%e7%94%a8%20HKDF%20%5bRFC5869%5d%20%e5%ae%9a%e4%b9%89%e7%9a%84%20HKDF-Extract%20%e5%92%8c%20HKDF-Expand%20%e5%87%bd%e6%95%b0%ef%bc%8c%e4%bb%a5%e5%8f%8a%e4%b8%8b%e9%9d%a2%e5%ae%9a%e4%b9%89%e7%9a%84%e5%87%bd%e6%95%b0%3a%0aHKDF-Expand-Label%28Secret%2c%20Label%2c%20Context%2c%20Length%29%20%3d%20HKDF-Expand%28Secret%2c%20HkdfLabel%2c%20Length%29%20Where%20HkdfLabel%20is%20specified%20as%3a%20struct%20%7b%20uint16%20length%20%3d%20Length%3b%20opaque%20label%26lt%3b7..255%26gt%3b%20%3d%20%26%2334%3btls13%20%26%2334%3b%20%2b%20Label%3b%20opaque%20context%26lt%3b0..255%26gt%3b%20%3d%20Context%3b%20%7d%20HkdfLabel%3b%20Derive-Secret%28Secret%2c%20Label%2c%20Messages%29%20%3d%20HKDF-Expand-Label%28Secret%2c%20Label%2c%20Transcript-Hash%28Messages%29%2c%20Hash.length%29%20Transcript-Hash%20%e5%92%8c%20HKDF%20%e4%bd%bf%e7%94%a8%e7%9a%84%20Hash%20%e5%87%bd%e6%95%b0%e6%98%af%e5%af%86%e7%a0%81%e5%a5%97%e4%bb%b6%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%e3%80%82Hash.length%20%e6%98%af%e5%85%b6%e8%be%93%e5%87%ba%e9%95%bf%e5%ba%a6%28%e4%bb%a5%e5%ad%97%e8%8a%82%e4%b8%ba%e5%8d%95%e4%bd%8d%29%e3%80%82%e6%b6%88%e6%81%af%e6%98%af%e8%a1%a8%e7%a4%ba%e7%9a%84%e6%8f%a1%e6%89%8b%e6%b6%88%e6%81%af%e7%9a%84%e4%b8%b2%e8%81%94%ef%bc%8c%e5%8c%85%e6%8b%ac%e6%8f%a1%e6%89%8b%e6%b6%88%e6%81%af%e7%b1%bb%e5%9e%8b%e5%92%8c%e9%95%bf%e5%ba%a6%e5%ad%97%e6%ae%b5%ef%bc%8c%e4%bd%86%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%ae%b0%e5%bd%95%e5%b1%82%e5%a4%b4%e3%80%82%e8%af%b7%e6%b3%a8%e6%84%8f%ef%bc%8c%e5%9c%a8%e6%9f%90%e4%ba%9b%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e9%9b%b6%e9%95%bf%e5%ba%a6%20context%ef%bc%88%e7%94%b1%20%26quot%3b%26rdquo%3b%20%e8%a1%a8%e7%a4%ba%ef%bc%89%e4%bc%a0%e9%80%92%e7%bb%99%20HKDF-Expand-Label%e3%80%82%e6%9c%ac%e6%96%87%e6%a1%a3%e4%b8%ad%e6%8c%87%e5%ae%9a%e7%9a%84%20labels%20%e9%83%bd%e6%98%af%20ASCII%20%e5%ad%97%e7%ac%a6%e4%b8%b2%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e5%b0%be%e9%9a%8f%20NUL%20%e5%ad%97%e8%8a%82%e3%80%82"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&t=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一-key-schedule>一. Key Schedule</a></li><li><a href=#二-updating-traffic-secrets>二. Updating Traffic Secrets</a></li><li><a href=#三-traffic-key-calculation>三. Traffic Key Calculation</a></li><li><a href=#四-ecdhe-shared-secret-calculation>四. (EC)DHE Shared Secret Calculation</a><ul><li><a href=#1-finite-field-diffie-hellman>1. Finite Field Diffie-Hellman</a></li><li><a href=#2-elliptic-curve-diffie-hellman>2. Elliptic Curve Diffie-Hellman</a></li></ul></li><li><a href=#五-exporters>五. Exporters</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">TLS 1.3 Cryptographic Computations</h1><div class=meta><div class=postdate><time datetime="2018-11-11 00:44:00 +0000 UTC" itemprop=datePublished>Nov 11</time></div><div class=article-category><i class="fas fa-archive"></i><a class=category-link href=/categories/protocol>Protocol</a>
,
<a class=category-link href=/categories/https>HTTPS</a></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/protocol rel=tag>Protocol</a>
,
<a class=tag-link href=/tags/https rel=tag>HTTPS</a></div></div></header><div class=content itemprop=articleBody><p>TLS 握手建立一个或多个输入的 secrets，如下文所述，将这些 secrets 组合起来以创建实际工作密钥材料。密钥派生过程包含输入 secrets 和握手记录。请注意，由于握手记录包含来自 Hello 消息的随机值，因此即使使用相同的输入 secrets，任何给定的握手都将具有不同的流量 secrets，就像将相同的 PSK 用于多个连接的情况一样。</p><h2 id=一-key-schedule>一. Key Schedule</h2><p>密钥派生过程使用 HKDF <a href=https://tools.ietf.org/html/rfc5869>[RFC5869]</a> 定义的 HKDF-Extract 和 HKDF-Expand 函数，以及下面定义的函数:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>       HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(Secret, Label, Context, Length) <span style=color:#f92672>=</span>
            HKDF<span style=color:#f92672>-</span>Expand(Secret, HkdfLabel, Length)

       Where HkdfLabel is specified as:

       <span style=color:#66d9ef>struct</span> {
           uint16 length <span style=color:#f92672>=</span> Length;
           opaque label<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>7..255</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;tls13 &#34;</span> <span style=color:#f92672>+</span> Label;
           opaque context<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>0..255</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> Context;
       } HkdfLabel;

       Derive<span style=color:#f92672>-</span>Secret(Secret, Label, Messages) <span style=color:#f92672>=</span>
            HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(Secret, Label,
                              Transcript<span style=color:#f92672>-</span>Hash(Messages), Hash.length)
</code></pre></div><p>Transcript-Hash 和 HKDF 使用的 Hash 函数是密码套件哈希算法。Hash.length 是其输出长度(以字节为单位)。消息是表示的握手消息的串联，包括握手消息类型和长度字段，但不包括记录层头。请注意，在某些情况下，零长度 context（由 "&rdquo; 表示）传递给 HKDF-Expand-Label。本文档中指定的 labels 都是 ASCII 字符串，不包括尾随 NUL 字节。</p><p>注意：对于常见的哈希函数，任何超过 12 个字符的 label 都需要额外迭代哈希函数才能计算。所有标准都已选择遵守此限制。</p><p>密钥是从使用 HKDF-Extract 和 Derive-Secret 函数的两个输入 secrets 中派生出来的。添加新 secret 的一般模式是使用 HKDF-Extract，其中 Salt 是当前的 secret 状态，输入密钥材料(IKM)是要添加的新 secret 。在此版本的 TLS 1.3 中，两个输入 secrets 是:</p><ul><li><p>PSK(外部建立的预共享密钥，或从先前连接的 resumption_master_secret 值派生的)</p></li><li><p>(EC)DHE 共享 secret (<a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/TLS_1.3_Cryptographic_Computations.md#%E5%9B%9B-ecdhe-shared-secret-calculation>Section 7.4</a>)</p></li></ul><p>这将生成一个完整的密钥推导计划，如下图所示。在此图中，约定以下的格式：</p><ul><li><p>HKDF-Extract 画在图上，它为从顶部获取 Salt 参数，从左侧获取 IKM 参数，它的输出是底部，和右侧输出的名称。</p></li><li><p>Derive-Secret 的 Secret 参数由传入的箭头指示。例如，Early Secret 是生成 client_early_traffic_secret 的 Secret。</p></li><li><p>&ldquo;0&rdquo; 表示将 Hash.length 字节的字符串设置为零。</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>             <span style=color:#ae81ff>0</span>
             <span style=color:#f92672>|</span>
             v
   PSK <span style=color:#f92672>-&gt;</span>  HKDF<span style=color:#f92672>-</span>Extract <span style=color:#f92672>=</span> Early Secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;ext binder&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;res binder&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> binder_key
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;c e traffic&#34;</span>, ClientHello)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> client_early_traffic_secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;e exp master&#34;</span>, ClientHello)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> early_exporter_master_secret
             v
       Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;derived&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)
             <span style=color:#f92672>|</span>
             v
   (EC)DHE <span style=color:#f92672>-&gt;</span> HKDF<span style=color:#f92672>-</span>Extract <span style=color:#f92672>=</span> Handshake Secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;c hs traffic&#34;</span>,
             <span style=color:#f92672>|</span>                     ClientHello...ServerHello)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> client_handshake_traffic_secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;s hs traffic&#34;</span>,
             <span style=color:#f92672>|</span>                     ClientHello...ServerHello)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> server_handshake_traffic_secret
             v
       Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;derived&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)
             <span style=color:#f92672>|</span>
             v
   <span style=color:#ae81ff>0</span> <span style=color:#f92672>-&gt;</span> HKDF<span style=color:#f92672>-</span>Extract <span style=color:#f92672>=</span> Master Secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;c ap traffic&#34;</span>,
             <span style=color:#f92672>|</span>                     ClientHello...server Finished)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> client_application_traffic_secret_0
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;s ap traffic&#34;</span>,
             <span style=color:#f92672>|</span>                     ClientHello...server Finished)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> server_application_traffic_secret_0
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;exp master&#34;</span>,
             <span style=color:#f92672>|</span>                     ClientHello...server Finished)
             <span style=color:#f92672>|</span>                     <span style=color:#f92672>=</span> exporter_master_secret
             <span style=color:#f92672>|</span>
             <span style=color:#f92672>+-----&gt;</span> Derive<span style=color:#f92672>-</span>Secret(., <span style=color:#e6db74>&#34;res master&#34;</span>,
                                   ClientHello...client Finished)
                                   <span style=color:#f92672>=</span> resumption_master_secret
</code></pre></div><p>这里的一般模式指的是，图左侧显示的 secrets 是没有上下文的原始熵，而右侧的 secrets 包括握手上下文，因此可以用来派生工作密钥而无需额外的上下文。请注意，对 Derive-Secret 的不同调用可能会使用不同的 Messages 参数，即使是具有相同的 secret。在 0-RTT 交换中，Derive-Secret 和四个不同的副本一起被调用;在 1-RTT-only 交换中，它和三个不同的副本一起被调用。</p><p>如果给定的 secret 不可用，则使用由设置为零的 Hash.length 字节串组成的 0 值。请注意，这并不意味着要跳过轮次，因此如果 PSK 未被使用，Early Secret 仍将是 HKDF-Extract(0,0)。对于 binder_key 的计算，label 是外部 PSK(在 TLS 之外提供的那些)的 &ldquo;ext binder&rdquo; 和用于恢复 PSK 的 &ldquo;res binder&rdquo;(提供为先前握手的恢复主密钥的那些)。不同的 labels 阻止了一种 PSK 替代另一种 PSK。</p><p>这存在有多个潜在的 Early Secret 值，具体取决于 Server 最终选择的 PSK。Client 需要为每个潜在的 PSK 都计算一个值;如果没有选择 PSK，则需要计算对应于零 PSK 的 Early Secret。</p><p>一旦计算出了从给定 secret 派生出的所有值，就应该删除该 secret。</p><h2 id=二-updating-traffic-secrets>二. Updating Traffic Secrets</h2><p>一旦握手完成后，任何一方都可以使用<a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/TLS_1.3_Handshake_Protocol.md#3-key-and-initialization-vector-update>第 4.6.3 节</a>中定义的 KeyUpdate 握手消息更新其发送流量密钥。 下一代流量密钥的计算方法是，如本节所述，从 client_ / server_application_traffic_secret_N 生成出 client_ / server_application_traffic_secret_N + 1，然后按 <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/TLS_1.3_Cryptographic_Computations.md#%E4%B8%89-traffic-key-calculation>7.3 节</a>所述方法重新导出流量密钥。</p><p>下一代 application_traffic_secret 计算方法如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>       application_traffic_secret_N<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>=</span>
           HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(application_traffic_secret_N,
                             <span style=color:#e6db74>&#34;traffic upd&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, Hash.length)
</code></pre></div><p>一旦计算了 client_ / server_application_traffic_secret_N + 1 及其关联的流量密钥，实现方应该删除 client_ / server_application_traffic_secret_N 及其关联的流量密钥。</p><h2 id=三-traffic-key-calculation>三. Traffic Key Calculation</h2><p>流量密钥材料由以下输入值生成:</p><ul><li><p>secret 的值</p></li><li><p>表示正在生成的特定值的目的值</p></li><li><p>生成密钥的长度</p></li></ul><p>使用输入流量 secret 的值生成流量密钥材料:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>  [sender]_write_key <span style=color:#f92672>=</span> HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(Secret, <span style=color:#e6db74>&#34;key&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, key_length)
   [sender]_write_iv  <span style=color:#f92672>=</span> HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(Secret, <span style=color:#e6db74>&#34;iv&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, iv_length)
</code></pre></div><p>[sender] 表示发送方。每种记录类型的 Secret 值显示在下表中:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>       <span style=color:#f92672>+-------------------+---------------------------------------+</span>
       <span style=color:#f92672>|</span> Record Type       <span style=color:#f92672>|</span> Secret                                <span style=color:#f92672>|</span>
       <span style=color:#f92672>+-------------------+---------------------------------------+</span>
       <span style=color:#f92672>|</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>-</span>RTT Application <span style=color:#f92672>|</span> client_early_traffic_secret           <span style=color:#f92672>|</span>
       <span style=color:#f92672>|</span>                   <span style=color:#f92672>|</span>                                       <span style=color:#f92672>|</span>
       <span style=color:#f92672>|</span> Handshake         <span style=color:#f92672>|</span> [sender]_handshake_traffic_secret     <span style=color:#f92672>|</span>
       <span style=color:#f92672>|</span>                   <span style=color:#f92672>|</span>                                       <span style=color:#f92672>|</span>
       <span style=color:#f92672>|</span> Application Data  <span style=color:#f92672>|</span> [sender]_application_traffic_secret_N <span style=color:#f92672>|</span>
       <span style=color:#f92672>+-------------------+---------------------------------------+</span>
</code></pre></div><p>每当底层 Secret 更改时(例如，从握手更改为应用数据密钥或密钥更新时)，将重新计算所有流量密钥材料。</p><h2 id=四-ecdhe-shared-secret-calculation>四. (EC)DHE Shared Secret Calculation</h2><h3 id=1-finite-field-diffie-hellman>1. Finite Field Diffie-Hellman</h3><p>对于有限的字段组合，执行传统的 Diffie-Hellman <a href=https://tools.ietf.org/html/rfc8446#ref-DH76>[DH76]</a> 计算。协商密钥(Z)被转换成一个字节字符串，字符串以 big-endian 形式编码，并用零往左边填充到初始的大小。此字节字符串用作上面指定的密钥计划中的共享密钥。</p><p>请注意，此结构与先前版本的 TLS 不同，TLS 之前的版本删除了前导零。</p><h3 id=2-elliptic-curve-diffie-hellman>2. Elliptic Curve Diffie-Hellman</h3><p>对于 secp256r1，secp384r1 和 secp521r1，ECDH 计算(包括参数和密钥生成以及共享密钥计算)根据 <a href=https://tools.ietf.org/html/rfc8446#ref-IEEE1363>[IEEE1363]</a> 使用 ECKAS-DH1 方案执行，identity 映射作为密钥导出函数(KDF）， 因此，共享 secret 是表示为八位字节串的 ECDH 共享秘密椭圆曲线点的 x 坐标。
 
注意，FE2OSP (字段元素到八位字符串转换原语)输出的该八位字节串(IEEE 1363 术语中的“Z”)对于任何给定字段都具有恒定长度;在此八位字符串中找到的前导零不得被截断。</p><p>(请注意，使用 KDF 标识是一种技术性。完整的做法是 ECDH 与 KDF 一起使用，因为 TLS 不直接将此 secret 用于计算其他 secret 以外的任何其他内容。)</p><p>对于 X25519 和 X448，ECDH 计算如下：</p><ul><li><p>放入 KeyShareEntry.key_exchange 结构的公钥是将 ECDH 标量乘法函数应用于适当长度(标量输入)和标准公共基点( u 坐标点输入)的密钥的结果。</p></li><li><p>ECDH 共享密钥是将 ECDH 标量乘法函数应用于密钥(标量输入)和对等方的公钥( u 坐标点输入)的结果。输出是直接使用的，没有经过处理的。</p></li></ul><p>对于这些曲线，实现方应该使用 <a href=https://tools.ietf.org/html/rfc7748>RFC7748</a> 中指定的方法来计算 Diffie-Hellman 共享密钥。实现方必须检查计算的 Diffie-Hellman 共享密钥是否为全零值，如果是，则中止，如 <a href=https://tools.ietf.org/html/rfc7748#section-6>[RFC7748] 第 6 节</a> 所述。如果实现者使用这些椭圆曲线的替代实现，他们应该执行 <a href=https://tools.ietf.org/html/rfc7748#section-7>[RFC7748] 第 7 节</a>中指定的附加检查。</p><h2 id=五-exporters>五. Exporters</h2><p>[RFC5705] 根据 TLS 伪随机函数(PRF)定义 TLS 的密钥材料 exporter。本文档用 HKDF 取代 PRF，因此需要新的结构。exporter 的接口保持不变。</p><p>exporter 的值计算方法如下:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>   TLS<span style=color:#f92672>-</span>Exporter(label, context_value, key_length) <span style=color:#f92672>=</span>
       HKDF<span style=color:#f92672>-</span>Expand<span style=color:#f92672>-</span>Label(Derive<span style=color:#f92672>-</span>Secret(Secret, label, <span style=color:#e6db74>&#34;&#34;</span>),
                         <span style=color:#e6db74>&#34;exporter&#34;</span>, Hash(context_value), key_length)
</code></pre></div><p>Secret 可以是 early_exporter_master_secret 或 exporter_master_secret。除非应用程序明确指定，否则实现方必须使用exporter_master_secret。early_exporter_master_secret 被定义用来在 0-RTT 数据需要 exporter 的设置这种情况中使用。建议为 early exporter 提供单独的接口;这可以避免 exporter 用户在需要常规 exporter 时意外使用 early exporter，反之亦然。</p><p>如果未提供上下文，则 context_value 为零长度。因此，不提供上下文计算与提供空上下文得到的结果都是相同的。这是对以前版本的 TLS 的更改，以前的 TLS 版本中，空的上下文产生的输出与不提供的上下文的结果不同。截至本文档，无论是否使用上下文，都不会使用已分配的 exporter 标签。未来的规范绝不能定义允许空上下文和没有相同标签的上下文的 exporter 的使用。exporter 的新用法应该是在所有 exporter 计算中提供上下文，尽管值可能为空。</p><p>exporter 标签格式的要求在 <a href=https://tools.ietf.org/html/rfc5705#section-4>[RFC5705] 第4节</a> 中定义。</p><hr><p>Reference：</p><p><a href=https://tools.ietf.org/html/rfc8446>RFC 8446</a></p><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://halfrost.com/tls_1-3_cryptographic_computations/>https://halfrost.com/TLS_1.3_Cryptographic_Computations/</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一-key-schedule>一. Key Schedule</a></li><li><a href=#二-updating-traffic-secrets>二. Updating Traffic Secrets</a></li><li><a href=#三-traffic-key-calculation>三. Traffic Key Calculation</a></li><li><a href=#四-ecdhe-shared-secret-calculation>四. (EC)DHE Shared Secret Calculation</a><ul><li><a href=#1-finite-field-diffie-hellman>1. Finite Field Diffie-Hellman</a></li><li><a href=#2-elliptic-curve-diffie-hellman>2. Elliptic Curve Diffie-Hellman</a></li></ul></li><li><a href=#五-exporters>五. Exporters</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&text=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&is_video=false&description=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=TLS%201.3%20Cryptographic%20Computations&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&title=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&name=TLS%201.3%20Cryptographic%20Computations&description=TLS%20%e6%8f%a1%e6%89%8b%e5%bb%ba%e7%ab%8b%e4%b8%80%e4%b8%aa%e6%88%96%e5%a4%9a%e4%b8%aa%e8%be%93%e5%85%a5%e7%9a%84%20secrets%ef%bc%8c%e5%a6%82%e4%b8%8b%e6%96%87%e6%89%80%e8%bf%b0%ef%bc%8c%e5%b0%86%e8%bf%99%e4%ba%9b%20secrets%20%e7%bb%84%e5%90%88%e8%b5%b7%e6%9d%a5%e4%bb%a5%e5%88%9b%e5%bb%ba%e5%ae%9e%e9%99%85%e5%b7%a5%e4%bd%9c%e5%af%86%e9%92%a5%e6%9d%90%e6%96%99%e3%80%82%e5%af%86%e9%92%a5%e6%b4%be%e7%94%9f%e8%bf%87%e7%a8%8b%e5%8c%85%e5%90%ab%e8%be%93%e5%85%a5%20secrets%20%e5%92%8c%e6%8f%a1%e6%89%8b%e8%ae%b0%e5%bd%95%e3%80%82%e8%af%b7%e6%b3%a8%e6%84%8f%ef%bc%8c%e7%94%b1%e4%ba%8e%e6%8f%a1%e6%89%8b%e8%ae%b0%e5%bd%95%e5%8c%85%e5%90%ab%e6%9d%a5%e8%87%aa%20Hello%20%e6%b6%88%e6%81%af%e7%9a%84%e9%9a%8f%e6%9c%ba%e5%80%bc%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%8d%b3%e4%bd%bf%e4%bd%bf%e7%94%a8%e7%9b%b8%e5%90%8c%e7%9a%84%e8%be%93%e5%85%a5%20secrets%ef%bc%8c%e4%bb%bb%e4%bd%95%e7%bb%99%e5%ae%9a%e7%9a%84%e6%8f%a1%e6%89%8b%e9%83%bd%e5%b0%86%e5%85%b7%e6%9c%89%e4%b8%8d%e5%90%8c%e7%9a%84%e6%b5%81%e9%87%8f%20secrets%ef%bc%8c%e5%b0%b1%e5%83%8f%e5%b0%86%e7%9b%b8%e5%90%8c%e7%9a%84%20PSK%20%e7%94%a8%e4%ba%8e%e5%a4%9a%e4%b8%aa%e8%bf%9e%e6%8e%a5%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%80%e6%a0%b7%e3%80%82%0a%e4%b8%80.%20Key%20Schedule%20%e5%af%86%e9%92%a5%e6%b4%be%e7%94%9f%e8%bf%87%e7%a8%8b%e4%bd%bf%e7%94%a8%20HKDF%20%5bRFC5869%5d%20%e5%ae%9a%e4%b9%89%e7%9a%84%20HKDF-Extract%20%e5%92%8c%20HKDF-Expand%20%e5%87%bd%e6%95%b0%ef%bc%8c%e4%bb%a5%e5%8f%8a%e4%b8%8b%e9%9d%a2%e5%ae%9a%e4%b9%89%e7%9a%84%e5%87%bd%e6%95%b0%3a%0aHKDF-Expand-Label%28Secret%2c%20Label%2c%20Context%2c%20Length%29%20%3d%20HKDF-Expand%28Secret%2c%20HkdfLabel%2c%20Length%29%20Where%20HkdfLabel%20is%20specified%20as%3a%20struct%20%7b%20uint16%20length%20%3d%20Length%3b%20opaque%20label%26lt%3b7..255%26gt%3b%20%3d%20%26%2334%3btls13%20%26%2334%3b%20%2b%20Label%3b%20opaque%20context%26lt%3b0..255%26gt%3b%20%3d%20Context%3b%20%7d%20HkdfLabel%3b%20Derive-Secret%28Secret%2c%20Label%2c%20Messages%29%20%3d%20HKDF-Expand-Label%28Secret%2c%20Label%2c%20Transcript-Hash%28Messages%29%2c%20Hash.length%29%20Transcript-Hash%20%e5%92%8c%20HKDF%20%e4%bd%bf%e7%94%a8%e7%9a%84%20Hash%20%e5%87%bd%e6%95%b0%e6%98%af%e5%af%86%e7%a0%81%e5%a5%97%e4%bb%b6%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%e3%80%82Hash.length%20%e6%98%af%e5%85%b6%e8%be%93%e5%87%ba%e9%95%bf%e5%ba%a6%28%e4%bb%a5%e5%ad%97%e8%8a%82%e4%b8%ba%e5%8d%95%e4%bd%8d%29%e3%80%82%e6%b6%88%e6%81%af%e6%98%af%e8%a1%a8%e7%a4%ba%e7%9a%84%e6%8f%a1%e6%89%8b%e6%b6%88%e6%81%af%e7%9a%84%e4%b8%b2%e8%81%94%ef%bc%8c%e5%8c%85%e6%8b%ac%e6%8f%a1%e6%89%8b%e6%b6%88%e6%81%af%e7%b1%bb%e5%9e%8b%e5%92%8c%e9%95%bf%e5%ba%a6%e5%ad%97%e6%ae%b5%ef%bc%8c%e4%bd%86%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%ae%b0%e5%bd%95%e5%b1%82%e5%a4%b4%e3%80%82%e8%af%b7%e6%b3%a8%e6%84%8f%ef%bc%8c%e5%9c%a8%e6%9f%90%e4%ba%9b%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e9%9b%b6%e9%95%bf%e5%ba%a6%20context%ef%bc%88%e7%94%b1%20%26quot%3b%26rdquo%3b%20%e8%a1%a8%e7%a4%ba%ef%bc%89%e4%bc%a0%e9%80%92%e7%bb%99%20HKDF-Expand-Label%e3%80%82%e6%9c%ac%e6%96%87%e6%a1%a3%e4%b8%ad%e6%8c%87%e5%ae%9a%e7%9a%84%20labels%20%e9%83%bd%e6%98%af%20ASCII%20%e5%ad%97%e7%ac%a6%e4%b8%b2%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e5%b0%be%e9%9a%8f%20NUL%20%e5%ad%97%e8%8a%82%e3%80%82"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2ftls_1-3_cryptographic_computations%2f&t=TLS%201.3%20Cryptographic%20Computations"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>