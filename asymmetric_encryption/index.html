<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>翱游公钥密码算法 | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="翱游公钥密码算法"><meta property="og:description" content="一、引子 在对称加密中，例如一次性密码本，就存在密钥配送的问题。在 DES、AES 中也存在这个问题。由于加密和解密的密钥是相同的，所以必须向接收者配送密钥。如果使用公钥密钥，则无需向接收者配送用于解密的密钥，这样就解决了密钥配送的问题，可以说公钥密码是密码学历史上最伟大的发明。
二、配送密钥问题 为了防止中间人截获密钥，安全的把密钥传递给通信对方。有以下 4 种方式：
1. 事先共享密钥 这种方法虽然有效，但是具有局限性。在一次性密码本中，我们说过，大国之间的热线是用这种方式加密的，但是密钥是靠特工押送过去的。如果通讯对方在附近，提前共享密钥还比较方便。如果通讯对方在世界各地，这种方式也就存在局限性了。
另外通讯量增大以后，密钥个数也会陡增。n 个人两两通讯，需要 n * (n-1) /2 个密钥。这点来看，也不现实。
2. 密钥分配中心 为了解决事先共享密钥的密钥增多的问题。于是有人想出了密钥分配中心(Key Distribution Center, KDC)的办法。每次加密的密钥由密钥中心进行分配，每个人只要和密钥中心事先共享密钥就可以了。
虽然这个方法解决了密钥增多的问题，但是又带来了新的问题。
密钥中心存储和记录了所有的密钥，一旦它出现故障或者被攻击破坏，那么所有的加密都会瘫痪。这也是集中式管理的缺点。
3. Diffie-Hellman 密钥交换 为了解决集中式管理的缺点，那么应该密钥的配送还是不能用集中式。于是有人想出了 Diffie-Hellman 密钥交换的方法。
在 Diffie-Hellman 密钥交换中，加密通信双方需要交换一些信息，而这些信息即便被窃听者窃听，也不会有任何问题。
根据交换的信息，双方各自生成相同的密钥。而窃听者无法生成相同的密钥。这种方式可行。不过这种方式不算是非对称加密，在本文中不详细讨论。
4. 公钥密码 非对称加密有一个公钥和一个私钥。公钥可以在网上传播，被窃听者拿到也没有关系，由于没有私钥，他也无法解开密文。私钥只要掌握在接收者手上就不会导致密文被窃听。
举个例子：超市里面的存包处，所有顾客有硬币就可以存包。硬币就是“公钥”，顾客把包放进箱子里，（明文加密），箱子锁上以后就没人能打开。这个时候窃听者也拿不走存进去的包。这个明文（包），只有私钥才能打开。客户存完包以后会生成一个私钥，只要这个钥匙在手，就可以随时开箱拿包。
三、非对称加密 非对称加密一般指的是具有公钥密钥(public-key cryptography)的加密算法。密钥分为加密密钥和解密密钥两种。发送者用加密密钥对信息进行加密，接收者用解密密钥对密文进行解密。可以公开出去的叫公钥(public key)，保存在自己手上不公开的叫私钥(private key)。
公钥和私钥是一一对应的。一对公钥和私钥统称为密钥对(key pair)。在数学的关系上，这两者不能单独生成。
四、非对称加密存在的问题 公钥密码虽然解决了密钥配送的问题，但是并不意味着它解决了所有问题。公钥密码存在以下几个问题：
 公钥认证 处理速度不到对称加密的十分之一  五、RSA 算法流程 RSA 是一种公钥密码算法，它的名字是由它的三位开发者，即 Ron Rivest、Adi Shamir 和 Leonard Adleman 的姓氏的首字母组成的 (Rivest-Shamir-Adleman)。1983 年，RSA 公司为 RSA 算法在美国取得了权利，但是现在该专利已经过期了。
RSA 可以被用于公钥密码和数字签名。"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/asymmetric_encryption/"><meta property="article:published_time" content="2018-08-19T00:22:00+00:00"><meta property="article:modified_time" content="2018-08-19T00:22:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="翱游公钥密码算法"><meta name=twitter:description content="一、引子 在对称加密中，例如一次性密码本，就存在密钥配送的问题。在 DES、AES 中也存在这个问题。由于加密和解密的密钥是相同的，所以必须向接收者配送密钥。如果使用公钥密钥，则无需向接收者配送用于解密的密钥，这样就解决了密钥配送的问题，可以说公钥密码是密码学历史上最伟大的发明。
二、配送密钥问题 为了防止中间人截获密钥，安全的把密钥传递给通信对方。有以下 4 种方式：
1. 事先共享密钥 这种方法虽然有效，但是具有局限性。在一次性密码本中，我们说过，大国之间的热线是用这种方式加密的，但是密钥是靠特工押送过去的。如果通讯对方在附近，提前共享密钥还比较方便。如果通讯对方在世界各地，这种方式也就存在局限性了。
另外通讯量增大以后，密钥个数也会陡增。n 个人两两通讯，需要 n * (n-1) /2 个密钥。这点来看，也不现实。
2. 密钥分配中心 为了解决事先共享密钥的密钥增多的问题。于是有人想出了密钥分配中心(Key Distribution Center, KDC)的办法。每次加密的密钥由密钥中心进行分配，每个人只要和密钥中心事先共享密钥就可以了。
虽然这个方法解决了密钥增多的问题，但是又带来了新的问题。
密钥中心存储和记录了所有的密钥，一旦它出现故障或者被攻击破坏，那么所有的加密都会瘫痪。这也是集中式管理的缺点。
3. Diffie-Hellman 密钥交换 为了解决集中式管理的缺点，那么应该密钥的配送还是不能用集中式。于是有人想出了 Diffie-Hellman 密钥交换的方法。
在 Diffie-Hellman 密钥交换中，加密通信双方需要交换一些信息，而这些信息即便被窃听者窃听，也不会有任何问题。
根据交换的信息，双方各自生成相同的密钥。而窃听者无法生成相同的密钥。这种方式可行。不过这种方式不算是非对称加密，在本文中不详细讨论。
4. 公钥密码 非对称加密有一个公钥和一个私钥。公钥可以在网上传播，被窃听者拿到也没有关系，由于没有私钥，他也无法解开密文。私钥只要掌握在接收者手上就不会导致密文被窃听。
举个例子：超市里面的存包处，所有顾客有硬币就可以存包。硬币就是“公钥”，顾客把包放进箱子里，（明文加密），箱子锁上以后就没人能打开。这个时候窃听者也拿不走存进去的包。这个明文（包），只有私钥才能打开。客户存完包以后会生成一个私钥，只要这个钥匙在手，就可以随时开箱拿包。
三、非对称加密 非对称加密一般指的是具有公钥密钥(public-key cryptography)的加密算法。密钥分为加密密钥和解密密钥两种。发送者用加密密钥对信息进行加密，接收者用解密密钥对密文进行解密。可以公开出去的叫公钥(public key)，保存在自己手上不公开的叫私钥(private key)。
公钥和私钥是一一对应的。一对公钥和私钥统称为密钥对(key pair)。在数学的关系上，这两者不能单独生成。
四、非对称加密存在的问题 公钥密码虽然解决了密钥配送的问题，但是并不意味着它解决了所有问题。公钥密码存在以下几个问题：
 公钥认证 处理速度不到对称加密的十分之一  五、RSA 算法流程 RSA 是一种公钥密码算法，它的名字是由它的三位开发者，即 Ron Rivest、Adi Shamir 和 Leonard Adleman 的姓氏的首字母组成的 (Rivest-Shamir-Adleman)。1983 年，RSA 公司为 RSA 算法在美国取得了权利，但是现在该专利已经过期了。
RSA 可以被用于公钥密码和数字签名。"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/symmetric_encryption/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/one_way_hash/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&text=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&is_video=false&description=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&name=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95&description=%e4%b8%80%e3%80%81%e5%bc%95%e5%ad%90%20%e5%9c%a8%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%ad%ef%bc%8c%e4%be%8b%e5%a6%82%e4%b8%80%e6%ac%a1%e6%80%a7%e5%af%86%e7%a0%81%e6%9c%ac%ef%bc%8c%e5%b0%b1%e5%ad%98%e5%9c%a8%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%e5%9c%a8%20DES%e3%80%81AES%20%e4%b8%ad%e4%b9%9f%e5%ad%98%e5%9c%a8%e8%bf%99%e4%b8%aa%e9%97%ae%e9%a2%98%e3%80%82%e7%94%b1%e4%ba%8e%e5%8a%a0%e5%af%86%e5%92%8c%e8%a7%a3%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%e6%98%af%e7%9b%b8%e5%90%8c%e7%9a%84%ef%bc%8c%e6%89%80%e4%bb%a5%e5%bf%85%e9%a1%bb%e5%90%91%e6%8e%a5%e6%94%b6%e8%80%85%e9%85%8d%e9%80%81%e5%af%86%e9%92%a5%e3%80%82%e5%a6%82%e6%9e%9c%e4%bd%bf%e7%94%a8%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%ef%bc%8c%e5%88%99%e6%97%a0%e9%9c%80%e5%90%91%e6%8e%a5%e6%94%b6%e8%80%85%e9%85%8d%e9%80%81%e7%94%a8%e4%ba%8e%e8%a7%a3%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e5%8f%af%e4%bb%a5%e8%af%b4%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e6%98%af%e5%af%86%e7%a0%81%e5%ad%a6%e5%8e%86%e5%8f%b2%e4%b8%8a%e6%9c%80%e4%bc%9f%e5%a4%a7%e7%9a%84%e5%8f%91%e6%98%8e%e3%80%82%0a%e4%ba%8c%e3%80%81%e9%85%8d%e9%80%81%e5%af%86%e9%92%a5%e9%97%ae%e9%a2%98%20%e4%b8%ba%e4%ba%86%e9%98%b2%e6%ad%a2%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%88%aa%e8%8e%b7%e5%af%86%e9%92%a5%ef%bc%8c%e5%ae%89%e5%85%a8%e7%9a%84%e6%8a%8a%e5%af%86%e9%92%a5%e4%bc%a0%e9%80%92%e7%bb%99%e9%80%9a%e4%bf%a1%e5%af%b9%e6%96%b9%e3%80%82%e6%9c%89%e4%bb%a5%e4%b8%8b%204%20%e7%a7%8d%e6%96%b9%e5%bc%8f%ef%bc%9a%0a1.%20%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%20%e8%bf%99%e7%a7%8d%e6%96%b9%e6%b3%95%e8%99%bd%e7%84%b6%e6%9c%89%e6%95%88%ef%bc%8c%e4%bd%86%e6%98%af%e5%85%b7%e6%9c%89%e5%b1%80%e9%99%90%e6%80%a7%e3%80%82%e5%9c%a8%e4%b8%80%e6%ac%a1%e6%80%a7%e5%af%86%e7%a0%81%e6%9c%ac%e4%b8%ad%ef%bc%8c%e6%88%91%e4%bb%ac%e8%af%b4%e8%bf%87%ef%bc%8c%e5%a4%a7%e5%9b%bd%e4%b9%8b%e9%97%b4%e7%9a%84%e7%83%ad%e7%ba%bf%e6%98%af%e7%94%a8%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e5%8a%a0%e5%af%86%e7%9a%84%ef%bc%8c%e4%bd%86%e6%98%af%e5%af%86%e9%92%a5%e6%98%af%e9%9d%a0%e7%89%b9%e5%b7%a5%e6%8a%bc%e9%80%81%e8%bf%87%e5%8e%bb%e7%9a%84%e3%80%82%e5%a6%82%e6%9e%9c%e9%80%9a%e8%ae%af%e5%af%b9%e6%96%b9%e5%9c%a8%e9%99%84%e8%bf%91%ef%bc%8c%e6%8f%90%e5%89%8d%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e8%bf%98%e6%af%94%e8%be%83%e6%96%b9%e4%be%bf%e3%80%82%e5%a6%82%e6%9e%9c%e9%80%9a%e8%ae%af%e5%af%b9%e6%96%b9%e5%9c%a8%e4%b8%96%e7%95%8c%e5%90%84%e5%9c%b0%ef%bc%8c%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e4%b9%9f%e5%b0%b1%e5%ad%98%e5%9c%a8%e5%b1%80%e9%99%90%e6%80%a7%e4%ba%86%e3%80%82%0a%e5%8f%a6%e5%a4%96%e9%80%9a%e8%ae%af%e9%87%8f%e5%a2%9e%e5%a4%a7%e4%bb%a5%e5%90%8e%ef%bc%8c%e5%af%86%e9%92%a5%e4%b8%aa%e6%95%b0%e4%b9%9f%e4%bc%9a%e9%99%a1%e5%a2%9e%e3%80%82n%20%e4%b8%aa%e4%ba%ba%e4%b8%a4%e4%b8%a4%e9%80%9a%e8%ae%af%ef%bc%8c%e9%9c%80%e8%a6%81%20n%20%2a%20%28n-1%29%20%2f2%20%e4%b8%aa%e5%af%86%e9%92%a5%e3%80%82%e8%bf%99%e7%82%b9%e6%9d%a5%e7%9c%8b%ef%bc%8c%e4%b9%9f%e4%b8%8d%e7%8e%b0%e5%ae%9e%e3%80%82%0a2.%20%e5%af%86%e9%92%a5%e5%88%86%e9%85%8d%e4%b8%ad%e5%bf%83%20%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e7%9a%84%e5%af%86%e9%92%a5%e5%a2%9e%e5%a4%9a%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%e4%ba%8e%e6%98%af%e6%9c%89%e4%ba%ba%e6%83%b3%e5%87%ba%e4%ba%86%e5%af%86%e9%92%a5%e5%88%86%e9%85%8d%e4%b8%ad%e5%bf%83%28Key%20Distribution%20Center%2c%20KDC%29%e7%9a%84%e5%8a%9e%e6%b3%95%e3%80%82%e6%af%8f%e6%ac%a1%e5%8a%a0%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%e7%94%b1%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e8%bf%9b%e8%a1%8c%e5%88%86%e9%85%8d%ef%bc%8c%e6%af%8f%e4%b8%aa%e4%ba%ba%e5%8f%aa%e8%a6%81%e5%92%8c%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%ba%86%e3%80%82%0a%e8%99%bd%e7%84%b6%e8%bf%99%e4%b8%aa%e6%96%b9%e6%b3%95%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e5%a2%9e%e5%a4%9a%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e4%bd%86%e6%98%af%e5%8f%88%e5%b8%a6%e6%9d%a5%e4%ba%86%e6%96%b0%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%0a%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e5%ad%98%e5%82%a8%e5%92%8c%e8%ae%b0%e5%bd%95%e4%ba%86%e6%89%80%e6%9c%89%e7%9a%84%e5%af%86%e9%92%a5%ef%bc%8c%e4%b8%80%e6%97%a6%e5%ae%83%e5%87%ba%e7%8e%b0%e6%95%85%e9%9a%9c%e6%88%96%e8%80%85%e8%a2%ab%e6%94%bb%e5%87%bb%e7%a0%b4%e5%9d%8f%ef%bc%8c%e9%82%a3%e4%b9%88%e6%89%80%e6%9c%89%e7%9a%84%e5%8a%a0%e5%af%86%e9%83%bd%e4%bc%9a%e7%98%ab%e7%97%aa%e3%80%82%e8%bf%99%e4%b9%9f%e6%98%af%e9%9b%86%e4%b8%ad%e5%bc%8f%e7%ae%a1%e7%90%86%e7%9a%84%e7%bc%ba%e7%82%b9%e3%80%82%0a3.%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%20%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e9%9b%86%e4%b8%ad%e5%bc%8f%e7%ae%a1%e7%90%86%e7%9a%84%e7%bc%ba%e7%82%b9%ef%bc%8c%e9%82%a3%e4%b9%88%e5%ba%94%e8%af%a5%e5%af%86%e9%92%a5%e7%9a%84%e9%85%8d%e9%80%81%e8%bf%98%e6%98%af%e4%b8%8d%e8%83%bd%e7%94%a8%e9%9b%86%e4%b8%ad%e5%bc%8f%e3%80%82%e4%ba%8e%e6%98%af%e6%9c%89%e4%ba%ba%e6%83%b3%e5%87%ba%e4%ba%86%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%e7%9a%84%e6%96%b9%e6%b3%95%e3%80%82%0a%e5%9c%a8%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%e4%b8%ad%ef%bc%8c%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%e5%8f%8c%e6%96%b9%e9%9c%80%e8%a6%81%e4%ba%a4%e6%8d%a2%e4%b8%80%e4%ba%9b%e4%bf%a1%e6%81%af%ef%bc%8c%e8%80%8c%e8%bf%99%e4%ba%9b%e4%bf%a1%e6%81%af%e5%8d%b3%e4%be%bf%e8%a2%ab%e7%aa%83%e5%90%ac%e8%80%85%e7%aa%83%e5%90%ac%ef%bc%8c%e4%b9%9f%e4%b8%8d%e4%bc%9a%e6%9c%89%e4%bb%bb%e4%bd%95%e9%97%ae%e9%a2%98%e3%80%82%0a%e6%a0%b9%e6%8d%ae%e4%ba%a4%e6%8d%a2%e7%9a%84%e4%bf%a1%e6%81%af%ef%bc%8c%e5%8f%8c%e6%96%b9%e5%90%84%e8%87%aa%e7%94%9f%e6%88%90%e7%9b%b8%e5%90%8c%e7%9a%84%e5%af%86%e9%92%a5%e3%80%82%e8%80%8c%e7%aa%83%e5%90%ac%e8%80%85%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e7%9b%b8%e5%90%8c%e7%9a%84%e5%af%86%e9%92%a5%e3%80%82%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e5%8f%af%e8%a1%8c%e3%80%82%e4%b8%8d%e8%bf%87%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e4%b8%8d%e7%ae%97%e6%98%af%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%ef%bc%8c%e5%9c%a8%e6%9c%ac%e6%96%87%e4%b8%ad%e4%b8%8d%e8%af%a6%e7%bb%86%e8%ae%a8%e8%ae%ba%e3%80%82%0a4.%20%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%20%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e6%9c%89%e4%b8%80%e4%b8%aa%e5%85%ac%e9%92%a5%e5%92%8c%e4%b8%80%e4%b8%aa%e7%a7%81%e9%92%a5%e3%80%82%e5%85%ac%e9%92%a5%e5%8f%af%e4%bb%a5%e5%9c%a8%e7%bd%91%e4%b8%8a%e4%bc%a0%e6%92%ad%ef%bc%8c%e8%a2%ab%e7%aa%83%e5%90%ac%e8%80%85%e6%8b%bf%e5%88%b0%e4%b9%9f%e6%b2%a1%e6%9c%89%e5%85%b3%e7%b3%bb%ef%bc%8c%e7%94%b1%e4%ba%8e%e6%b2%a1%e6%9c%89%e7%a7%81%e9%92%a5%ef%bc%8c%e4%bb%96%e4%b9%9f%e6%97%a0%e6%b3%95%e8%a7%a3%e5%bc%80%e5%af%86%e6%96%87%e3%80%82%e7%a7%81%e9%92%a5%e5%8f%aa%e8%a6%81%e6%8e%8c%e6%8f%a1%e5%9c%a8%e6%8e%a5%e6%94%b6%e8%80%85%e6%89%8b%e4%b8%8a%e5%b0%b1%e4%b8%8d%e4%bc%9a%e5%af%bc%e8%87%b4%e5%af%86%e6%96%87%e8%a2%ab%e7%aa%83%e5%90%ac%e3%80%82%0a%e4%b8%be%e4%b8%aa%e4%be%8b%e5%ad%90%ef%bc%9a%e8%b6%85%e5%b8%82%e9%87%8c%e9%9d%a2%e7%9a%84%e5%ad%98%e5%8c%85%e5%a4%84%ef%bc%8c%e6%89%80%e6%9c%89%e9%a1%be%e5%ae%a2%e6%9c%89%e7%a1%ac%e5%b8%81%e5%b0%b1%e5%8f%af%e4%bb%a5%e5%ad%98%e5%8c%85%e3%80%82%e7%a1%ac%e5%b8%81%e5%b0%b1%e6%98%af%e2%80%9c%e5%85%ac%e9%92%a5%e2%80%9d%ef%bc%8c%e9%a1%be%e5%ae%a2%e6%8a%8a%e5%8c%85%e6%94%be%e8%bf%9b%e7%ae%b1%e5%ad%90%e9%87%8c%ef%bc%8c%ef%bc%88%e6%98%8e%e6%96%87%e5%8a%a0%e5%af%86%ef%bc%89%ef%bc%8c%e7%ae%b1%e5%ad%90%e9%94%81%e4%b8%8a%e4%bb%a5%e5%90%8e%e5%b0%b1%e6%b2%a1%e4%ba%ba%e8%83%bd%e6%89%93%e5%bc%80%e3%80%82%e8%bf%99%e4%b8%aa%e6%97%b6%e5%80%99%e7%aa%83%e5%90%ac%e8%80%85%e4%b9%9f%e6%8b%bf%e4%b8%8d%e8%b5%b0%e5%ad%98%e8%bf%9b%e5%8e%bb%e7%9a%84%e5%8c%85%e3%80%82%e8%bf%99%e4%b8%aa%e6%98%8e%e6%96%87%ef%bc%88%e5%8c%85%ef%bc%89%ef%bc%8c%e5%8f%aa%e6%9c%89%e7%a7%81%e9%92%a5%e6%89%8d%e8%83%bd%e6%89%93%e5%bc%80%e3%80%82%e5%ae%a2%e6%88%b7%e5%ad%98%e5%ae%8c%e5%8c%85%e4%bb%a5%e5%90%8e%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%b8%aa%e7%a7%81%e9%92%a5%ef%bc%8c%e5%8f%aa%e8%a6%81%e8%bf%99%e4%b8%aa%e9%92%a5%e5%8c%99%e5%9c%a8%e6%89%8b%ef%bc%8c%e5%b0%b1%e5%8f%af%e4%bb%a5%e9%9a%8f%e6%97%b6%e5%bc%80%e7%ae%b1%e6%8b%bf%e5%8c%85%e3%80%82%0a%e4%b8%89%e3%80%81%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%20%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%80%e8%88%ac%e6%8c%87%e7%9a%84%e6%98%af%e5%85%b7%e6%9c%89%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%28public-key%20cryptography%29%e7%9a%84%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e3%80%82%e5%af%86%e9%92%a5%e5%88%86%e4%b8%ba%e5%8a%a0%e5%af%86%e5%af%86%e9%92%a5%e5%92%8c%e8%a7%a3%e5%af%86%e5%af%86%e9%92%a5%e4%b8%a4%e7%a7%8d%e3%80%82%e5%8f%91%e9%80%81%e8%80%85%e7%94%a8%e5%8a%a0%e5%af%86%e5%af%86%e9%92%a5%e5%af%b9%e4%bf%a1%e6%81%af%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e6%8e%a5%e6%94%b6%e8%80%85%e7%94%a8%e8%a7%a3%e5%af%86%e5%af%86%e9%92%a5%e5%af%b9%e5%af%86%e6%96%87%e8%bf%9b%e8%a1%8c%e8%a7%a3%e5%af%86%e3%80%82%e5%8f%af%e4%bb%a5%e5%85%ac%e5%bc%80%e5%87%ba%e5%8e%bb%e7%9a%84%e5%8f%ab%e5%85%ac%e9%92%a5%28public%20key%29%ef%bc%8c%e4%bf%9d%e5%ad%98%e5%9c%a8%e8%87%aa%e5%b7%b1%e6%89%8b%e4%b8%8a%e4%b8%8d%e5%85%ac%e5%bc%80%e7%9a%84%e5%8f%ab%e7%a7%81%e9%92%a5%28private%20key%29%e3%80%82%0a%e5%85%ac%e9%92%a5%e5%92%8c%e7%a7%81%e9%92%a5%e6%98%af%e4%b8%80%e4%b8%80%e5%af%b9%e5%ba%94%e7%9a%84%e3%80%82%e4%b8%80%e5%af%b9%e5%85%ac%e9%92%a5%e5%92%8c%e7%a7%81%e9%92%a5%e7%bb%9f%e7%a7%b0%e4%b8%ba%e5%af%86%e9%92%a5%e5%af%b9%28key%20pair%29%e3%80%82%e5%9c%a8%e6%95%b0%e5%ad%a6%e7%9a%84%e5%85%b3%e7%b3%bb%e4%b8%8a%ef%bc%8c%e8%bf%99%e4%b8%a4%e8%80%85%e4%b8%8d%e8%83%bd%e5%8d%95%e7%8b%ac%e7%94%9f%e6%88%90%e3%80%82%0a%e5%9b%9b%e3%80%81%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e5%ad%98%e5%9c%a8%e7%9a%84%e9%97%ae%e9%a2%98%20%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e8%99%bd%e7%84%b6%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e4%bd%86%e6%98%af%e5%b9%b6%e4%b8%8d%e6%84%8f%e5%91%b3%e7%9d%80%e5%ae%83%e8%a7%a3%e5%86%b3%e4%ba%86%e6%89%80%e6%9c%89%e9%97%ae%e9%a2%98%e3%80%82%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e5%ad%98%e5%9c%a8%e4%bb%a5%e4%b8%8b%e5%87%a0%e4%b8%aa%e9%97%ae%e9%a2%98%ef%bc%9a%0a%20%e5%85%ac%e9%92%a5%e8%ae%a4%e8%af%81%20%e5%a4%84%e7%90%86%e9%80%9f%e5%ba%a6%e4%b8%8d%e5%88%b0%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e7%9a%84%e5%8d%81%e5%88%86%e4%b9%8b%e4%b8%80%20%20%e4%ba%94%e3%80%81RSA%20%e7%ae%97%e6%b3%95%e6%b5%81%e7%a8%8b%20RSA%20%e6%98%af%e4%b8%80%e7%a7%8d%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95%ef%bc%8c%e5%ae%83%e7%9a%84%e5%90%8d%e5%ad%97%e6%98%af%e7%94%b1%e5%ae%83%e7%9a%84%e4%b8%89%e4%bd%8d%e5%bc%80%e5%8f%91%e8%80%85%ef%bc%8c%e5%8d%b3%20Ron%20Rivest%e3%80%81Adi%20Shamir%20%e5%92%8c%20Leonard%20Adleman%20%e7%9a%84%e5%a7%93%e6%b0%8f%e7%9a%84%e9%a6%96%e5%ad%97%e6%af%8d%e7%bb%84%e6%88%90%e7%9a%84%20%28Rivest-Shamir-Adleman%29%e3%80%821983%20%e5%b9%b4%ef%bc%8cRSA%20%e5%85%ac%e5%8f%b8%e4%b8%ba%20RSA%20%e7%ae%97%e6%b3%95%e5%9c%a8%e7%be%8e%e5%9b%bd%e5%8f%96%e5%be%97%e4%ba%86%e6%9d%83%e5%88%a9%ef%bc%8c%e4%bd%86%e6%98%af%e7%8e%b0%e5%9c%a8%e8%af%a5%e4%b8%93%e5%88%a9%e5%b7%b2%e7%bb%8f%e8%bf%87%e6%9c%9f%e4%ba%86%e3%80%82%0aRSA%20%e5%8f%af%e4%bb%a5%e8%a2%ab%e7%94%a8%e4%ba%8e%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e3%80%82"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&t=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一引子>一、引子</a></li><li><a href=#二配送密钥问题>二、配送密钥问题</a><ul><li><a href=#1-事先共享密钥>1. 事先共享密钥</a></li><li><a href=#2-密钥分配中心>2. 密钥分配中心</a></li><li><a href=#3-diffie-hellman-密钥交换>3. Diffie-Hellman 密钥交换</a></li><li><a href=#4-公钥密码>4. 公钥密码</a></li></ul></li><li><a href=#三非对称加密>三、非对称加密</a></li><li><a href=#四非对称加密存在的问题>四、非对称加密存在的问题</a></li><li><a href=#五rsa-算法流程>五、RSA 算法流程</a><ul><li><a href=#1-rsa-加密>1. RSA 加密</a></li><li><a href=#2-rsa-解密>2. RSA 解密</a></li><li><a href=#3-生成密钥对>3. 生成密钥对</a></li></ul></li><li><a href=#六直接攻击-rsa>六、直接攻击 RSA</a></li><li><a href=#七间接攻击-rsa>七、间接攻击 RSA</a></li><li><a href=#八椭圆曲线加密算法>八、椭圆曲线加密算法</a><ul><li><a href=#1-椭圆曲线上的运算>1. 椭圆曲线上的运算</a></li><li><a href=#2-椭圆曲线加密实质>2. 椭圆曲线加密实质</a></li><li><a href=#3-椭圆曲线-diffie-hellman-密钥交换-ecdh>3. 椭圆曲线 Diffie-Hellman 密钥交换 (ECDH)</a></li><li><a href=#4-椭圆曲线-dsa-ecdsa>4. 椭圆曲线 DSA (ECDSA)</a></li><li><a href=#5-椭圆曲线-eigamal-密码>5. 椭圆曲线 EIGamal 密码</a></li></ul></li><li><a href=#九其他公钥加密算法>九、其他公钥加密算法</a></li><li><a href=#十混合加密系统>十、混合加密系统</a></li><li><a href=#十一openssl-中的-rsa>十一、OpenSSL 中的 RSA</a></li><li><a href=#十二openssl-中的-ecc>十二、OpenSSL 中的 ECC</a><ul><li><a href=#1-dh-密钥协商>1. DH 密钥协商</a></li><li><a href=#2-ecc-加密>2. ECC 加密</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">翱游公钥密码算法</h1><div class=meta><div class=postdate><time datetime="2018-08-19 00:22:00 +0000 UTC" itemprop=datePublished>Aug 19</time></div><div class=article-category><i class="fas fa-archive"></i><a class=category-link href=/categories/protocol>Protocol</a>
,
<a class=category-link href=/categories/https>HTTPS</a>
,
<a class=category-link href=/categories/cryptography>Cryptography</a></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/protocol rel=tag>Protocol</a>
,
<a class=tag-link href=/tags/https rel=tag>HTTPS</a>
,
<a class=tag-link href=/tags/cryptography rel=tag>Cryptography</a></div></div></header><div class=content itemprop=articleBody><h2 id=一引子>一、引子</h2><p>在对称加密中，例如一次性密码本，就存在密钥配送的问题。在 DES、AES 中也存在这个问题。由于加密和解密的密钥是相同的，所以必须向接收者配送密钥。如果使用公钥密钥，则无需向接收者配送用于解密的密钥，这样就解决了密钥配送的问题，可以说公钥密码是密码学历史上最伟大的发明。</p><h2 id=二配送密钥问题>二、配送密钥问题</h2><p>为了防止中间人截获密钥，安全的把密钥传递给通信对方。有以下 4 种方式：</p><h3 id=1-事先共享密钥>1. 事先共享密钥</h3><p>这种方法虽然有效，但是具有局限性。在一次性密码本中，我们说过，大国之间的热线是用这种方式加密的，但是密钥是靠特工押送过去的。如果通讯对方在附近，提前共享密钥还比较方便。如果通讯对方在世界各地，这种方式也就存在局限性了。</p><p>另外通讯量增大以后，密钥个数也会陡增。n 个人两两通讯，需要 n * (n-1) /2 个密钥。这点来看，也不现实。</p><h3 id=2-密钥分配中心>2. 密钥分配中心</h3><p>为了解决事先共享密钥的密钥增多的问题。于是有人想出了密钥分配中心(Key Distribution Center, KDC)的办法。每次加密的密钥由密钥中心进行分配，每个人只要和密钥中心事先共享密钥就可以了。</p><p>虽然这个方法解决了密钥增多的问题，但是又带来了新的问题。</p><p>密钥中心存储和记录了所有的密钥，一旦它出现故障或者被攻击破坏，那么所有的加密都会瘫痪。这也是集中式管理的缺点。</p><h3 id=3-diffie-hellman-密钥交换>3. Diffie-Hellman 密钥交换</h3><p>为了解决集中式管理的缺点，那么应该密钥的配送还是不能用集中式。于是有人想出了 Diffie-Hellman 密钥交换的方法。</p><p>在 Diffie-Hellman 密钥交换中，加密通信双方需要交换一些信息，而这些信息即便被窃听者窃听，也不会有任何问题。</p><p>根据交换的信息，双方各自生成相同的密钥。而窃听者无法生成相同的密钥。这种方式可行。不过这种方式不算是非对称加密，在本文中不详细讨论。</p><h3 id=4-公钥密码>4. 公钥密码</h3><p>非对称加密有一个公钥和一个私钥。公钥可以在网上传播，被窃听者拿到也没有关系，由于没有私钥，他也无法解开密文。私钥只要掌握在接收者手上就不会导致密文被窃听。</p><p>举个例子：超市里面的存包处，所有顾客有硬币就可以存包。硬币就是“公钥”，顾客把包放进箱子里，（明文加密），箱子锁上以后就没人能打开。这个时候窃听者也拿不走存进去的包。这个明文（包），只有私钥才能打开。客户存完包以后会生成一个私钥，只要这个钥匙在手，就可以随时开箱拿包。</p><h2 id=三非对称加密>三、非对称加密</h2><p>非对称加密一般指的是具有公钥密钥(public-key cryptography)的加密算法。密钥分为加密密钥和解密密钥两种。发送者用加密密钥对信息进行加密，接收者用解密密钥对密文进行解密。可以公开出去的叫公钥(public key)，保存在自己手上不公开的叫私钥(private key)。</p><p>公钥和私钥是一一对应的。一对公钥和私钥统称为密钥对(key pair)。在数学的关系上，这两者不能单独生成。</p><h2 id=四非对称加密存在的问题>四、非对称加密存在的问题</h2><p>公钥密码虽然解决了密钥配送的问题，但是并不意味着它解决了所有问题。公钥密码存在以下几个问题：</p><ul><li>公钥认证</li><li>处理速度不到对称加密的十分之一</li></ul><h2 id=五rsa-算法流程>五、RSA 算法流程</h2><p>RSA 是一种公钥密码算法，它的名字是由它的三位开发者，即 Ron Rivest、Adi Shamir 和 Leonard Adleman 的姓氏的首字母组成的 (Rivest-Shamir-Adleman)。1983 年，RSA 公司为 RSA 算法在美国取得了权利，但是现在该专利已经过期了。</p><p>RSA 可以被用于公钥密码和数字签名。</p><h3 id=1-rsa-加密>1. RSA 加密</h3><p>在 RSA 中，明文、密钥和密文都是数字。加密过程可以用下面的公式来表示：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>密文</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>明文</span><span style=color:#f92672>^</span>E mod N
</code></pre></div><p>RSA 的密文是对代表明文的数字 E 次方求 mod N 的结果。E 和 N 是 RSA 加密的密钥，<strong>E 和 N 的组合就是公钥</strong>。E 是加密 Encryption 的首字母，N 是数字 Number 的首字母。</p><h3 id=2-rsa-解密>2. RSA 解密</h3><p>RSA 解密过程可以用下面的公式来表示：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>明文</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>密文</span><span style=color:#f92672>^</span>D mod N
</code></pre></div><p>解密的过程是对密文的数字的 D 次方求 mod N 就可以得到明文。<strong>D 和 N 的组合就是私钥</strong>。D 是解密 Decryption 的首字母，N 是数字 Number 的首字母。</p><p>RSA 奇妙的是加密和解密过程是一致的。加密是求明文的 E 次方对 N 的 mod 余数。解密是求密文的 D 次方对 N 的 mod 余数。</p><h3 id=3-生成密钥对>3. 生成密钥对</h3><p>E 和 N 是公钥，D 和 N 是私钥，因此求 E、D 和 N 的这三个数是<strong>生成密钥对</strong>。具体流程主要分为 4 步：</p><ul><li>求 N</li><li>求 L(L 是仅在生成密钥对的过程中使用的数)</li><li>求 E</li><li>求 D</li></ul><p>主要步骤如下图：</p><p>先计算 N。</p><p>计算 N 需要准备 2 个很大的质数。质数太小容易被破译，太大导致计算时间很长。p 和 q 都是由伪随机数生成器生成的，且 p != q。N = p * q。</p><p>再计算 L。</p><p>L 这个数只在生成密钥对的过程中会用到，加密和解密过程中都不出现。
L 是 p - 1 和 q - 1 的最小公倍数 (least common multiple, lcm)。</p><p>再求数 E。</p><p>数 E 需要满足两个条件：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;</span> E <span style=color:#f92672>&lt;</span> L

gcd(E,L) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>，</span> E <span style=color:#960050;background-color:#1e0010>和</span> L <span style=color:#960050;background-color:#1e0010>的最大公约数为</span> <span style=color:#ae81ff>1</span> (E <span style=color:#960050;background-color:#1e0010>和</span> L <span style=color:#960050;background-color:#1e0010>互质</span>)
</code></pre></div><p>条件 1 用伪随机生成树生成。条件 2 是为了保证一定存在解密时需要使用的数 D。求最大公约数可以使用欧几里得的辗转相除法。</p><p>至次，我们已经生成了密钥对中的公钥{E,M}</p><p>再求 D。</p><p>数 D 是由数 E 计算得到的。D、E、L 之间具有以下的关系：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;</span> D <span style=color:#f92672>&lt;</span> L

E <span style=color:#f92672>*</span> D mod L <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</code></pre></div><p>只要 D 满足上面的条件，就可以通过 E 和 N 进行加密的密文，可以通过 D 和 N 进行解密。要保证一定存在满足条件的 D，需要先保证 E 和 L 的最大公约数为 1 。<code>E * D mod L = 1</code> 这个条件保证了密文解密以后可以得到明文。</p><p>总结一下推导流程：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>明文</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>密文</span><span style=color:#f92672>^</span>D mod N
	 <span style=color:#f92672>=</span> (<span style=color:#960050;background-color:#1e0010>明文</span><span style=color:#f92672>^</span>E)<span style=color:#f92672>^</span>D mod N
	 <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>明文</span><span style=color:#f92672>^</span>(E <span style=color:#f92672>*</span> D) mod N

E <span style=color:#f92672>*</span> D mod L <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>保证了最终的转换可以还原成明文。这里详细推导可以见文章末尾</span> Reference <span style=color:#960050;background-color:#1e0010>阮老师的两篇</span> RSA <span style=color:#960050;background-color:#1e0010>分析的文章。</span>
</code></pre></div><h2 id=六直接攻击-rsa>六、直接攻击 RSA</h2><p>要想直接攻击 RSA，也就是拿到密文算出明文。我们知道：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>密文</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>明文</span><span style=color:#f92672>^</span>E mod N
</code></pre></div><p>攻击者可以拿到密文和公钥{E,N}。那么现在问题转变成求离散对数的问题。目前还没有针对这个问题的高效算法。所以这条路走不通。</p><p>换一个思路，算出私钥，通过解密的方式顺序计算出明文。现在公钥里面有 N，私钥还需要知道 D，那么能暴力计算出 D 么？</p><p>一般 p 和 q 的长度都在 1024 位以上，N 的长度在 2048 以上。D 的长度 和 N 差不多，那么需要进行 2048 位以上的破解，在现实的时间内破解也是极其困难的。(除非以后量子计算机出现，当然量子计算机出现，当前现有加密体系也会被全部颠覆)</p><p>既然暴力破解 D 是不可能的，那么通过 E 和 N 计算 D 可行么？整理一下可以推暴力计算 D 的现有条件：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>E <span style=color:#f92672>*</span> D mod L <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

N <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q

L <span style=color:#f92672>=</span> lcm( p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> , q<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)

</code></pre></div><p>目前我们知道 E 和 N，想算出 D 需要先算出 L，而 L 和 p、q 有关系。 p * q 又恰恰等于 N。那么我们第一步需要先破译 p 和 q。</p><p>目前对大数 N 进行质因数分解，比较难。<strong>一旦发现了能对大整数进行质因数分解的高效算法，RSA 也就能够被破译</strong>。目前还没有有效的算法。想通过猜测来推出 p、q 也不可能。p、q 的位数一般会比较长。</p><p><strong>p、q 两者在 RSA 中的地位和私钥的地位是一样的，一旦 p、q 被泄露，也就相当于私钥被泄露了</strong>。</p><h2 id=七间接攻击-rsa>七、间接攻击 RSA</h2><p>间接攻击 RSA 指的是利用中间人攻击。</p><p>举个例子，如下图：</p><p>主动攻击者 Mallory 在通信双方之间拦截各自的公钥。并且分别向两者发送自己的公钥。这样攻击者就可以在中间截获两边的密文，并且用自己的私钥进行解密。解密得到明文以后就可以任意篡改原文。最终达到攻击的目的。</p><p>这种攻击仅仅靠 RSA 本身是无法防御的。要想防御中间人攻击需要用到认证相关的算法。认证相关的算法在下一篇文章里面再详细说明。</p><h2 id=八椭圆曲线加密算法>八、椭圆曲线加密算法</h2><p>椭圆曲线密码(Elliptic Curve Cryptography, ECC)是近期备受关注的公钥密码算法。它的特点是比 RSA 所需的密钥长度短。<strong>椭圆曲线密码密钥短但强度高</strong>。密钥长度 224 - 255 比特的椭圆曲线密码，与密钥长度为 2048 比特的 RSA 具备相同的长度。</p><p>对应关系如下：</p><table><thead><tr><th align=center>RSA Key Length (bit)</th><th align=center>ECC Key Length (bit)</th><th align=center>AES Key Length (bit)</th></tr></thead><tbody><tr><td align=center>1024</td><td align=center>160</td><td align=center>80</td></tr><tr><td align=center>2048</td><td align=center>224</td><td align=center>112</td></tr><tr><td align=center>3072</td><td align=center>256</td><td align=center>128</td></tr><tr><td align=center>7680</td><td align=center>384</td><td align=center>192</td></tr><tr><td align=center>15360</td><td align=center>521</td><td align=center>256</td></tr></tbody></table><table><thead><tr><th align=center>密码学算法</th><th align=center>推荐的密钥安全长度</th></tr></thead><tbody><tr><td align=center>AES 对称加密算法</td><td align=center>128 比特</td></tr><tr><td align=center>RSA 加密和签名算法</td><td align=center>2048 比特</td></tr><tr><td align=center>DSA 数字签名算法</td><td align=center>2048 比特</td></tr><tr><td align=center>ECC 椭圆曲线算法</td><td align=center>256 比特</td></tr></tbody></table><p>由于 ECC 密钥具有很短的长度，所以运算速度比较快。到目前为止，对于 ECC 进行逆操作还是很难的，数学上证明不可破解，ECC 算法的优势就是性能和安全性高。实际应用可以结合其他的公开密钥算法形成更快、更安全的公开密钥算法，比如结合 DH 密钥形成 ECDH 密钥协商算法，结合数字签名 DSA 算法组成 ECDSA 数字签名算法。</p><table><thead><tr><th align=center>算法</th><th align=center>加密/解密</th><th align=center>数字签名</th><th align=center>密钥交换</th></tr></thead><tbody><tr><td align=center>RSA</td><td align=center>✅</td><td align=center>✅</td><td align=center>✅</td></tr><tr><td align=center>Diffie-Hellman</td><td align=center>❌</td><td align=center>❌</td><td align=center>✅</td></tr><tr><td align=center>DSS</td><td align=center>❌</td><td align=center>✅</td><td align=center>❌</td></tr><tr><td align=center>椭圆曲线 ECC</td><td align=center>✅</td><td align=center>✅</td><td align=center>✅</td></tr></tbody></table><p>如上表，椭圆曲线可以用于 3 个方面：</p><ul><li>基于椭圆曲线的公钥密码</li><li>基于椭圆曲线的数字签名</li><li>基于椭圆曲线的密钥交换</li></ul><blockquote><p>椭圆曲线 (Elliptic Curve，EC) 这个名字很容易让人联想到“椭圆形”。但实际上椭圆曲线的图像并不是椭圆形的，之所以叫椭圆曲线，是有历史原因的，因为椭圆曲线源自于求椭圆弧长的椭圆积分反函数。</p></blockquote><p>椭圆曲线源自于求椭圆弧长的椭圆积分的反函数。一般情况下，椭圆曲线可以用下面的方程式来表示，其中 a,b,c,d 为系数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>E: y<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>=</span> ax<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> bx<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> cx<span style=color:#f92672>+</span> d
</code></pre></div><p>举个例子，</p><p>上面是一条椭圆曲线，但是它的样子也并不是一个椭圆。</p><h3 id=1-椭圆曲线上的运算>1. 椭圆曲线上的运算</h3><p>加法运算：椭圆曲线上的两点 A 和 B，构成的直线与椭圆曲线的交点，与 X 轴的对称点，定义为 A+B。如下图：</p><p>当然也存在两个点重合的情况，这种情况下，就相当于寻找 2 倍点的问题。在椭圆曲线上的一点 A，做一条切线，与椭圆曲线的另外一交点，相对于 X 轴的对称点成为 2 倍点。这种运算成为 2 倍计算，如下图：</p><p>点 A 相对于 X 轴的对称位置的点成为 -A。这个运算成为椭圆曲线的正负取反运算。如下图：</p><h3 id=2-椭圆曲线加密实质>2. 椭圆曲线加密实质</h3><p>椭圆曲线加密的实质是利用椭圆曲线上离散对数问题(Elliptic Curve Discrete Logarithm Problem, ECDLP)，实质是<strong>已知点 xG 求数 x 的问题</strong>。</p><blockquote><p>已知：<br>椭圆曲线 E<br>椭圆曲线 E 上的一点 G (基点)<br>椭圆曲线 E 上的一点 xG (G 的 x 倍)</p><p>求：<br>数 x</p></blockquote><p>椭圆曲线在实数域上是连续的，曲线也是一条光滑的曲线。假设椭圆曲线为 E2：y^2 = x^3 + x + 1，如下图：</p><p>如果位于有限域 F23 上，那么 E2：y^2 ≡ x^3 + x + 1 (mod 23)。此时椭圆曲线就不是一个连续的曲线了，而是一堆离散的点。如下图：</p><p>上图中每个点的 y 坐标对 23 求余，都等于 x^3 + x + 1 对 23 求余。如果我们把 E2 上的点 G=(0,1) 作为基点，那么按照椭圆曲线的计算规则计算 2G、3G、4G、5G、……。</p><p>这就是“已知 G 和 xG 求 x 的问题”。这个问题在 p 相当大的时候，很难求解。<strong>椭圆曲线无法被破解的原因是：求解椭圆曲线上的离散对数问题是非常困难的</strong>。</p><p>但是椭圆曲线加密算法并非在实数域 R 上，而是在<strong>有限域 F(P) 上</strong>。有限域 F(P) 指的是对于某个给定的质数 p，由 0，1，2，……，p-1 共 p 个元素所组成的整数集合中定义的加减乘除运算。</p><blockquote><p>椭圆曲线加密算法除了可以使用特征数为质数 p 的素域 GF(P)，椭圆曲线还可以使用特征数为 2^m 的扩张域 GF(2^m)。</p></blockquote><h3 id=3-椭圆曲线-diffie-hellman-密钥交换-ecdh>3. 椭圆曲线 Diffie-Hellman 密钥交换 (ECDH)</h3><blockquote><p>Diffie-Hellman 发明出来的非常早：<br>1976 年，Diffie 和 Hellman 提出了不对称加密<br>1977 年，Rivest，Shamir 和 Adleman 提出了 RSA 公钥算法<br>1977 年，DES 算法出现<br>80 年代，出现 IDEA 和 CAST 等算法
90 年代，对称密钥进一步成熟，Rijndael，RC6 的出现，以及椭圆曲线等其他公钥算法<br>2000 年，Rijndael 算法成为 AES 标准</p></blockquote><p>非椭圆曲线的 Diffie-Hellman 密钥交换利用的是：</p><p><strong>以 p 为模，已知 G 和 G^x mod p 求 x 的复杂度(有限域上的离散对数问题)</strong></p><p>椭圆曲线的 Diffie-Hellman 密钥交换利用的是：</p><p><strong>在椭圆曲线上，已知 G 和 xG 求 x 的复杂度(椭圆曲线上的离散对数问题)</strong></p><p>DH 算法和 RSA 算法最大的不同在于：</p><ul><li>DH 算法在进行<strong>密钥协商</strong>的过程中，通信双方的任何一方无法独自计算出一个会话密钥，通信双方各自保留一部分关键信息，再将另外一部分信息告诉对方，双方有了全部信息才能共同计算出全部的会话密钥。</li><li>RSA 算法在传输会话密钥的时候，会话密钥完全由客户端生成和控制，并没有服务端的参与，准确的来说应该叫 <strong>RSA 密钥传输</strong>。</li></ul><p>举个例子来说明 ECDH 算法是如何生成共享密钥的。</p><ul><li>Alice 向 Bob 发送点 G，点 G 被窃听了也没有关系。</li><li>Alice 生成随机数 a。这个数<strong>只有 Alice 自己一个人知道</strong>。也没有必要告诉 Bob。更加不能让第三者知道，这个 a 称为 Alice 的私钥。</li><li>Bob 生成随机数 b。这个数<strong>只有 Bob 自己一个人知道</strong>。也没有必要告诉 Alice。更加不能让第三者知道，这个 b 称为 Bob 的私钥。</li><li>Alice 向 Bob 发送点 aG。点 aG 被窃听了也没有关系。它是 Alice 的公钥。</li><li>Bob 向 Alice 发送点 bG。点 bG 被窃听了也没有关系。它是 Bob 的公钥。</li><li>Alice 拿到 Bob 发过来的 bG，开始计算其在椭圆曲线上 a 倍的点，即 a(bG) = abG，它就是 Alice 和 Bob 的共享密钥。</li><li>Bob 拿到 Alice 发过来的点 aG 开始计算其在椭圆曲线上 b 倍的点，即 b(aG) = baG = abG，它就是 Alice 和 Bob 的共享密钥。</li></ul><p>窃听者一共可以拿到 3 个有效信息：G、aG、bG。但是由于“已知 G 和 xG 求 x 非常难”，导致已知 G 和 aG 无法求解出 a，已知 G 和 bG 无法求解出 b。所以最终也就无法求解出私钥 abG。</p><blockquote><p>严格的来说，椭圆曲线上的离散对数问题的复杂度只能证明 “已知 G，aG，bG 难以求出 a，b”，但无法证明“已知 G，aG，bG 难以求出 abG”，后者需要另外证明。具体证明这里省略。</p></blockquote><p>如果采用静态的 DH 算法和 ECC 结合就是 ECDH 算法。这种方式每次都使用的相同的 G 基点，它的优点在于可以避免每次在初始化连接时服务器频繁生成 G。这个过程比较消耗 CPU。但是它带来的缺点是，一旦随机数 a、b 被泄露了，那么在这之前的所有会话都将会被解密。</p><p>为了解决这个问题，于是出现了 DHE 算法(Diffie-Hellman Ephemeral ，短暂临时的 DH 算法)，结合 ECC 后形成了 ECDHE 算法。它可以保证每次通信使用的共享密钥都是不同的，DH 密钥对仅仅保存在内存中，不像 RSA 的私钥保存在磁盘上，攻击者即使从内存中破解了私钥，也仅仅影响本次通信，所以无需担心在此之前的通信内容会被解密，这样的特征成为前向安全性(Forward Secrecy，FS)或者完全前向安全性(Perfect Forward Secrecy，PFS)。更安全的是，协商出会话密钥后，a 和 b 两个私钥可以丢弃，进一步提升了安全性，在有限的时间、有效的空间生成了密钥对。在 TLS 握手中使用的 ECDHE_ECDSA 和 ECDHE_RSA 密钥交换算法。</p><h3 id=4-椭圆曲线-dsa-ecdsa>4. 椭圆曲线 DSA (ECDSA)</h3><p>使用椭圆曲线密码还可以实现数字签名。</p><p>假设 Alice 要对消息 m 加上数字签名，而 Bob 需要验证该签名。下面所有的“计算”，都是代表以 p 为模的时钟运算。</p><h3 id=5-椭圆曲线-eigamal-密码>5. 椭圆曲线 EIGamal 密码</h3><p>假设 Alice 要想 Bob 发送一条消息，Alice 可以将自己要发送的消息用椭圆曲线上的一个点 M 来表示(实际上是用该点的 x 坐标)</p><p>加密：</p><ul><li>Alice 用自己的私钥 a 以及 Bob 的公钥 bG，对消息 M 计算点 M + abG。此点 M + abG 就是密文。</li><li>Alice 将密文 M + abG 发送给 Bob。</li></ul><p>解密：</p><ul><li>Bob 接收到密文 M + abG。</li><li>Bob 用 Alice 的公钥 aG 以及自己的私钥 b 计算出共享密钥 abG。将收到的密文减去 abG 就可以得到原文 M 了。</li></ul><p>这里用到的还是窃听者无法出 abG 的特点，所以保证了密文的安全。</p><h2 id=九其他公钥加密算法>九、其他公钥加密算法</h2><p>EIGamal 方式是由 Taher EIGamal 设计的公钥算法。RSA 利用了质因数分解的困难度，而 EIGamal 利用了 mod N 下求离散对数的困难度。</p><p>EIGamal 方式有一个缺点，就是经过加密的密文长度会变成明文的 2 倍。密码软件 GnuPG 中就支持这种方式。</p><p>Rabin 方式是由 M.O.Rabin 设计的公钥算法。Rabin 利用了 mod N 下求平方根的困难度。破译 Rabin 公钥密码的困难度与 RSA 质因数分解 N 是相当的。</p><h2 id=十混合加密系统>十、混合加密系统</h2><p>通过使用对称加密可以解决信息安全的问题，但是使用对称加密，必须要解决密钥配送的问题。</p><p>使用公钥密码可以解决密钥配送的问题，但是公钥密码又暴露了 2 个新的问题。</p><ul><li>公钥密码的处理速度远远低于对称密码</li><li>公钥密码难以抵御中间人攻击</li></ul><p>第一点缺点可以用这一章节讲的混合加密系统来解决。第二点缺点需要用到下一篇文章中的认证相关的算法来解决。</p><p>混合密码系统 (hybrid crytosystem) 是将对称密码和公钥密码的优势相结合的方法。用快速的对称密码对明文进行加密，用公钥密码对对称密码的密钥进行加密。由于对称密钥一般都比消息本身要短，这样公钥密码速度慢的问题也可以忽略。</p><ul><li>用对称密码对消息明文进行加密</li><li>用伪随机生成器生成对称密码加密中使用的会话密钥</li><li>用公钥密码加密会话密钥</li><li>从混合密码系统外部赋予公钥密码加密时使用的密钥</li></ul><p>会话密钥 (session key) 是指为本次通信而生成的临时密钥。它一般都是通过伪随机数生成器产生的。伪随机生成器所产生的会话密钥同时也会作为对称密码的密钥使用。<strong>会话密钥是对称密码的密钥，同时也是公钥密码的明文</strong>。</p><p>下图是混合密码系统中的加密流程：</p><p>值得说明的是，公钥密码的强度应该高于对称密码。因为对称密码会话密钥被破译只影响本地通信内容，但是公钥密钥被破译就会影响到过去所有通信内容，以及未来所有通信内容。</p><p>下图是混合密码系统中的解密流程：</p><h2 id=十一openssl-中的-rsa>十一、OpenSSL 中的 RSA</h2><p>使用 genrsa 子命令生成密钥对，密钥对是一个文件。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成密钥长度为 2048 比特
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl genrsa <span style=color:#f92672>-</span>out mykey.pem <span style=color:#ae81ff>2048</span>
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating RSA private key, <span style=color:#ae81ff>2048</span> bit <span style=color:#66d9ef>long</span> modulus (<span style=color:#ae81ff>2</span> primes)
..................................................<span style=color:#f92672>+++</span>
...............................................................<span style=color:#f92672>+++</span>
e is <span style=color:#ae81ff>65537</span> (<span style=color:#ae81ff>0x010001</span>)


<span style=color:#f92672>-----</span>BEGIN RSA PRIVATE KEY<span style=color:#f92672>-----</span>
MIIEowIBAAKCAQEAvQuZaPWI47tMLufxTxlFUmVkvl3HCjo7WtxD7znK5TvbOtQN
N0QsbhdzLc<span style=color:#f92672>+</span>gVy8asYE95f06ujELtsrhLX2g8HcklgAM13k6ML47Vj1mEgl8M1Gh
ye<span style=color:#f92672>/</span>ZcWeOFYxDn3JbhVZbofzAwowkEbc9KXMxYI<span style=color:#f92672>+</span>J2Bp1wCq7dh1IHVkV1OQy2qo6
poR0pMjV1qd<span style=color:#f92672>+</span>AzrBFyVtV6DqNkInFrPMCL9iu<span style=color:#f92672>+</span>j1PliNG4I00<span style=color:#f92672>+</span><span style=color:#ae81ff>66</span>JcVBlMCsYxX6
orhhwDV85NVitAvEX2GwRd3v65<span style=color:#f92672>/</span><span style=color:#ae81ff>93</span>ZtOOTJgyofrFr<span style=color:#f92672>/</span>nYxp<span style=color:#f92672>/</span>ytfhwIsDTIfuGNES
<span style=color:#ae81ff>9</span>xJ0x4ENbEL8POTHrpEgpf9VQ<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>mdVxkCtWsPwIDAQABAoIBACe<span style=color:#f92672>/</span>zJ35IrNfqoEi
W<span style=color:#f92672>+</span>bZ1W2hzDEK3tMTs29DaTVf3X2dvFb<span style=color:#f92672>+</span>R1kbiIwNejZjtb8fNGmmVzGIsVR9A42H
<span style=color:#ae81ff>0</span>xkRlUl6g8LWd9zGrKmbFjbn6hJY1DimLXKccAgcUg<span style=color:#f92672>/</span>N0lowXXYH1nSVBKLjfKIM
<span style=color:#f92672>+</span>VtB0VwQUleSGLgzQ<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>t4L<span style=color:#f92672>/</span>q<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>AnztXe<span style=color:#f92672>/</span>LLyMxjsW1XNSlMREPjBoykygw6dk41<span style=color:#f92672>/</span>
Wou96UvUElJc9YiU<span style=color:#f92672>+</span>WwIL46yWfwf68C9qmlrkY32pj7q<span style=color:#f92672>/</span>q7FHLsgGeiSXpxRYSeo
bl99xHzBN<span style=color:#f92672>/</span>Kf3wHcw803JFSolZKb63VDt0p9P58Dg34M9NxqHKfnXW<span style=color:#f92672>/+</span>Ot4ryIaT
LNUe1IECgYEA3UiEUANv10WSmXQXuNOcCsTezwvNGrxERD6q7sGs4gEMDkjOy4eG
ENbT3OqISOpMjli9<span style=color:#f92672>+</span>m0XjG0Jdc6<span style=color:#f92672>+</span>WaAKbddAwwfHfq<span style=color:#f92672>+</span>e9qWHg88q1yHJFYLRMMgV
f5kV5sq2<span style=color:#f92672>/</span>b<span style=color:#f92672>+</span>eOLpPeOI4dRiU1J5dorab0SxpSMvLcu1krPpss3BoBDECgYEA2rRM
EH<span style=color:#f92672>/</span>gtT3uTGVfsF9WtFr<span style=color:#f92672>+/</span>AYExsLg8GK38HdwopVPhgNMhrIIvHSRBpGgPNZC7Q6z
pDreFZM5U0zCcLVpYdKSh0ag0uckOVwDoKcvOFEG<span style=color:#f92672>+</span>hE5N22LseiU2FXSDFPjk5wz
C5ZKZDh826n<span style=color:#f92672>+</span><span style=color:#ae81ff>28</span>P7XN74HGDvF<span style=color:#f92672>/</span>usXEA8ibu5y28CgYAbidbNjl<span style=color:#f92672>/</span>wznu8FTKOkect
f<span style=color:#f92672>+</span>qqobFYzm1AgPwM0pWNWswBSxZRRgBtQA8FwzpKuL3mSSz7aXAwzbELtDsENGKX
<span style=color:#ae81ff>4</span>N3yZ5lwLrL9xwPiZ3nRZCb<span style=color:#f92672>+</span>QlV<span style=color:#f92672>+</span>WKg0RPzwx<span style=color:#f92672>/</span>GWCq7KKIWTabPU<span style=color:#f92672>/</span>sYm376PbWJe
<span style=color:#ae81ff>2</span>cQQhyw<span style=color:#f92672>+</span>lUSeMlwsyKRpQQKBgH1hyAndhjHh43Ag3g77WXXkhTJvMOXSa6rkrZdK
omRTPVgTJBhEkQWZvlsJudem7o<span style=color:#f92672>+</span>BUjPhG9k6oi7DXuXG2zedxSuQrjq7EOVhfyLn
NgcPTPSoUykXwHKqaEruSJGQtnO1pP4Ll3KFf<span style=color:#f92672>+</span><span style=color:#ae81ff>9f</span>MiFD5iOEILIEUI5rVpE8sng0
C3w5AoGBAIRZ7BVKof069wdJRbCYWNcQ9wLpfbsDfJ1nB25aDlYsbiX<span style=color:#f92672>+</span><span style=color:#ae81ff>04</span>dg30oY
<span style=color:#ae81ff>63</span>IQIuE1<span style=color:#f92672>+</span>uU<span style=color:#f92672>+</span>ucQhOn1ct8zQN8<span style=color:#f92672>+</span>neqRsfyAKfDr9pble8L2PeLdTlJiSnChXmctX
fR6ZxFL<span style=color:#f92672>/</span>ScnE2JiJ9EJeAvKVVRBWe4loSiz1LOjRXnNqTQK5VUdT
<span style=color:#f92672>-----</span>END RSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>用 3DES 加密口令</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 口令结合 3DES 算法保护密钥对
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl genrsa <span style=color:#f92672>-</span>des3 <span style=color:#f92672>-</span>out mykey2.pem <span style=color:#ae81ff>2048</span>
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN RSA PRIVATE KEY<span style=color:#f92672>-----</span>
Proc<span style=color:#f92672>-</span>Type: <span style=color:#ae81ff>4</span>,ENCRYPTED
DEK<span style=color:#f92672>-</span>Info: DES<span style=color:#f92672>-</span>EDE3<span style=color:#f92672>-</span>CBC,<span style=color:#ae81ff>4F</span><span style=color:#ae81ff>3848</span>C3AF836C73

<span style=color:#f92672>+</span>TL2YDfcSZh3oCPUcUaKLHZBnnzSKSspZV5NwlDHbyokkigEeVaEn19nBEDdH5ph
Mv2afNfs5TNHe<span style=color:#f92672>/</span>uxun0OP99Z<span style=color:#f92672>/</span>QrWgkz75JRDQYjUEBilte0MHLS<span style=color:#f92672>+</span>W7bzJlYcYYhs
IK<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span><span style=color:#f92672>/</span>x6X3A0T3lm13PV389RnuEJKl<span style=color:#f92672>/</span>x4JhhS7<span style=color:#f92672>+</span>AHUt<span style=color:#f92672>/</span>ceYxYAbW35dPVzBaVX8KL
<span style=color:#ae81ff>1</span>t67joBEasOxqFblDcVniOWLHhdn4aF<span style=color:#f92672>+</span>k4P4a3qs5ayzVNxB7<span style=color:#f92672>+</span>cQOK7ZFyRN7OOP
O<span style=color:#f92672>/</span>iu6Ha7kCqUi4NP8yJohfBoiLqmWAgl5nbyRs<span style=color:#f92672>/</span>ymjrI1Qu9Gne551cXY57SFJB1
YdtXanXcQodL9S9EZ9dSNrQLzDbQ2bpJNO7QdmxTxxUWn0Nw2SBeRcju<span style=color:#f92672>+</span><span style=color:#ae81ff>5</span>HU<span style=color:#75715e>//XV
</span><span style=color:#75715e></span>FB90xc3abskjE<span style=color:#f92672>/</span>Dq8KCWY<span style=color:#f92672>+</span>TogEJmB8fLGBGnF3RDUkgOtQ93omGREcRgI3QSDt2O
KryYSwO<span style=color:#f92672>/</span>f0Rh<span style=color:#f92672>+</span>dbLs6OhenPgUEHFXteS0ETq5Q7lPAgH6xLGQdrdVHm2gkQ72IMt
JE4w68bC8x4qM7XSK9RublEjFWY7UKd93JWsaxbokozD7cYSi2SZO6eDiKZMUhOH
bV<span style=color:#f92672>+</span><span style=color:#ae81ff>7u</span>St6IT6KdvNTtO4hQFcttqjxApdwDf1GA8qRUmQ57PS6pbpGq07zGYtoGZ2o
Za1MUZtH<span style=color:#f92672>/</span>omi41smVPJWlB5YEQhVPclpw4BpGkVqYoI56QrmEuZWK8x8A8Fota0C
ZZvvbEFGO<span style=color:#f92672>+</span>wKlp3mmaKC0g3P0xXblKUVzpXhiEGEPxyxzMYu7vhS4gSEA8TvWyH3
YJBDDF2dSPYoJq0HQcnmeVKNG544ZSuJz<span style=color:#f92672>/+</span>Jfn6WcD6qx5zZ9NXsm6xaji5hHGoW
aJzWGZbk74WXpc<span style=color:#f92672>+</span>y<span style=color:#f92672>/</span>NFyJLhKpozr<span style=color:#f92672>+</span>Gsu8r40A<span style=color:#f92672>+</span>BCQXhkYUu58QAbtuWP48gfyn0<span style=color:#f92672>+</span>
fP0oLlBq3UGMga46JJgdMNbnNcbo5Qxzo0srHdwiYts4oBXEfED<span style=color:#f92672>/</span>NRQeecsKqrvk
qNxK9AR0MP3sKMshuBiS0nSgGovnAG5TwEzbwPgoiU09CWGWLQQOnRxZt4FNmVqz
kQg8t<span style=color:#f92672>+</span>U0JW8rKSH9FihRXpOeSDlVrk4L8It98v8KyczNWZjKxBszbO<span style=color:#f92672>/</span>AJeK8gPeY
hXZ6bU8<span style=color:#f92672>/</span>FljI<span style=color:#f92672>+</span>NMeA7gUgcNjXNSoNdHiJFMh5XbVN3AaUiUV9oOr5d<span style=color:#f92672>/</span>v1kWTYz<span style=color:#f92672>+</span>A
xaGw5rYKMe32Fs8ohMHnTydmO4iHGziKt5gchJwzAmY4k05tyyRF<span style=color:#f92672>/</span>VjJCb4bV0XA
VwGLUlhuNWzuvh2FGBXceEOf6eOzE1FDriTVQX2gFSBaE3olWtBvB7lzAEm<span style=color:#f92672>+</span>nyMJ
zL<span style=color:#f92672>+</span>aiSBDgBSKFkGRXe5i2Lq7<span style=color:#f92672>/</span><span style=color:#ae81ff>3600</span>z4HWON3Ccc8gwuVVOsv927CDXdi33Ew<span style=color:#f92672>+</span>XqN
yKxG2PFHf2MoymRcp<span style=color:#f92672>+</span>YnyZqa2yGCQWXEOvzUgRRIlgH9BVbXxPKPigDwWqho5X<span style=color:#f92672>+</span>F
<span style=color:#ae81ff>3</span>ymDjsGp87x8RoE14GWImVpYjWx500fs<span style=color:#f92672>/</span>FweLoKzi<span style=color:#f92672>+</span>RRWvFFcc4izW7YvGY9yby7
zWKng2Wrqkc0NBExqkIxpcGsLay<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>joa<span style=color:#f92672>++</span>lX<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span>V0<span style=color:#f92672>/</span>Rdq8DWrI2zalpw3LYsN1jCW
<span style=color:#ae81ff>1</span>iOD6CoOsAKsj3QpqFU4gh5RRXgPYQK1nq0ctonVsQ7Cv1929<span style=color:#f92672>+</span>TmMw<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END RSA PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>从密钥对中分离出公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>in mykey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out mypubkey.pem

<span style=color:#75715e>// 需要输入口令才能分离公钥
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>in mykey2.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out mypubkey2.pem
</code></pre></div><p>无口令的分离出公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>writing RSA key

<span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvQuZaPWI47tMLufxTxlF
UmVkvl3HCjo7WtxD7znK5TvbOtQNN0QsbhdzLc<span style=color:#f92672>+</span>gVy8asYE95f06ujELtsrhLX2g
<span style=color:#ae81ff>8</span>HcklgAM13k6ML47Vj1mEgl8M1Ghye<span style=color:#f92672>/</span>ZcWeOFYxDn3JbhVZbofzAwowkEbc9KXMx
YI<span style=color:#f92672>+</span>J2Bp1wCq7dh1IHVkV1OQy2qo6poR0pMjV1qd<span style=color:#f92672>+</span>AzrBFyVtV6DqNkInFrPMCL9i
u<span style=color:#f92672>+</span>j1PliNG4I00<span style=color:#f92672>+</span><span style=color:#ae81ff>66</span>JcVBlMCsYxX6orhhwDV85NVitAvEX2GwRd3v65<span style=color:#f92672>/</span><span style=color:#ae81ff>93</span>ZtOOTJg
yofrFr<span style=color:#f92672>/</span>nYxp<span style=color:#f92672>/</span>ytfhwIsDTIfuGNES9xJ0x4ENbEL8POTHrpEgpf9VQ<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>mdVxkCtWs
PwIDAQAB
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>有口令的分离出公钥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>writing RSA key

<span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn2AlBE0SzDjS4ITtV0KU
i7ZfpVaI7SaxhkVqgZNqTX8WsLQefXJipzcCR3aFNOyfRr<span style=color:#f92672>/</span>YtsUKKozD3qtQRckH
TkZdil80RB9im8IINIgUXWtOm1j6<span style=color:#f92672>/</span>ztptKtPoBlv556<span style=color:#f92672>+</span>cLY<span style=color:#f92672>+</span>zEJQWnSzB3N8g2py
<span style=color:#ae81ff>26</span>oewc6AeZiYtqpLEbuGBsBxGa8xNIp2<span style=color:#f92672>/</span>fnBKonA4stAI6b<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>yCsDeEwgw3O7omt
AMTtYBJqd2Be9Np8CukXD4fBLdVRcRoTiIGxSp8GRJ<span style=color:#f92672>+</span>F5JBIr5THMAerVhNjdAeU
y15gc7B5OTJUfLmBXWo6gmq4hLcp4S5dCv7kapK7Zebyt1LkXAsrRCWGMVavy84y
fwIDAQAB
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>校验密码对文件是否正确</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// -noout 参数表示不打印密钥对信息，如果校验成功，说明密钥对文件无误
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>in mykey.pem <span style=color:#f92672>-</span>check <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>RSA key ok
</code></pre></div><p>显示公钥信息</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl rsa <span style=color:#f92672>-</span>pubin <span style=color:#f92672>-</span>in mypubkey.pem <span style=color:#f92672>-</span>text
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>RSA Public<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>2048</span> bit)
Modulus:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>bd:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>f5:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span>e3:bb:<span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>2</span>e:e7:f1:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>be:<span style=color:#ae81ff>5</span>d:c7:<span style=color:#ae81ff>0</span>a:<span style=color:#ae81ff>3</span>a:<span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>5</span>a:dc:<span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>ef:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span>
    ca:e5:<span style=color:#ae81ff>3</span>b:db:<span style=color:#ae81ff>3</span>a:d4:<span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>6</span>e:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:cf:
    a0:<span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:b1:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:e5:fd:<span style=color:#ae81ff>3</span>a:ba:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>b:b6:ca:
    e1:<span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>7</span>d:a0:f0:<span style=color:#ae81ff>77</span><span style=color:#f92672>:</span><span style=color:#ae81ff>24</span><span style=color:#f92672>:</span><span style=color:#ae81ff>96</span><span style=color:#f92672>:</span><span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>c:d7:<span style=color:#ae81ff>79</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>a:<span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>be:
    <span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>c:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>51</span><span style=color:#f92672>:</span>a1:c9:ef:d9:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span><span style=color:#ae81ff>67</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>8</span>e:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>72</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>b:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>b:a1:fc:c0:c2:<span style=color:#ae81ff>8</span>c:
    <span style=color:#ae81ff>24</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>b7:<span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span>d8:<span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>c0:<span style=color:#ae81ff>2</span>a:
    bb:<span style=color:#ae81ff>76</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>d:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>d:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>15</span><span style=color:#f92672>:</span>d4:e4:<span style=color:#ae81ff>32</span><span style=color:#f92672>:</span>da:aa:<span style=color:#ae81ff>3</span>a:a6:<span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>74</span><span style=color:#f92672>:</span>a4:c8:d5:d6:a7:<span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>a:c1:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>57</span><span style=color:#f92672>:</span>a0:
    ea:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span>b3:cc:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>bf:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span>bb:e8:f5:<span style=color:#ae81ff>3</span>e:<span style=color:#ae81ff>58</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>34</span><span style=color:#f92672>:</span>d3:ee:ba:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span>c5:<span style=color:#ae81ff>41</span><span style=color:#f92672>:</span><span style=color:#ae81ff>94</span><span style=color:#f92672>:</span>c0:ac:<span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>15</span><span style=color:#f92672>:</span>
    fa:a2:b8:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span>c0:<span style=color:#ae81ff>35</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>c:e4:d5:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span>b4:<span style=color:#ae81ff>0</span>b:c4:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>61</span><span style=color:#f92672>:</span>
    b0:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>dd:ef:eb:<span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>fd:dd:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>4</span>e:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>32</span><span style=color:#f92672>:</span><span style=color:#ae81ff>60</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
    eb:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span>bf:e7:<span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span>ca:d7:e1:c0:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
    ee:<span style=color:#ae81ff>18</span><span style=color:#f92672>:</span>d1:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>f7:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span><span style=color:#ae81ff>74</span><span style=color:#f92672>:</span>c7:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span>fc:<span style=color:#ae81ff>3</span>c:e4:
    c7:ae:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span>a5:ff:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>ff:<span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:d5:
    ac:<span style=color:#ae81ff>3f</span>
Exponent: <span style=color:#ae81ff>65537</span> (<span style=color:#ae81ff>0x10001</span>)
writing RSA key
<span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvQuZaPWI47tMLufxTxlF
UmVkvl3HCjo7WtxD7znK5TvbOtQNN0QsbhdzLc<span style=color:#f92672>+</span>gVy8asYE95f06ujELtsrhLX2g
<span style=color:#ae81ff>8</span>HcklgAM13k6ML47Vj1mEgl8M1Ghye<span style=color:#f92672>/</span>ZcWeOFYxDn3JbhVZbofzAwowkEbc9KXMx
YI<span style=color:#f92672>+</span>J2Bp1wCq7dh1IHVkV1OQy2qo6poR0pMjV1qd<span style=color:#f92672>+</span>AzrBFyVtV6DqNkInFrPMCL9i
u<span style=color:#f92672>+</span>j1PliNG4I00<span style=color:#f92672>+</span><span style=color:#ae81ff>66</span>JcVBlMCsYxX6orhhwDV85NVitAvEX2GwRd3v65<span style=color:#f92672>/</span><span style=color:#ae81ff>93</span>ZtOOTJg
yofrFr<span style=color:#f92672>/</span>nYxp<span style=color:#f92672>/</span>ytfhwIsDTIfuGNES9xJ0x4ENbEL8POTHrpEgpf9VQ<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>mdVxkCtWs
PwIDAQAB
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Modulus 是 RSA 加密结构中的 N。Exponent 是公钥中的 E。&mdash;&ndash;BEGIN PUBLIC KEY&mdash;&ndash; 和 &mdash;&ndash;END PUBLIC KEY&mdash;&ndash; 之间是公钥具体的值。</p><p>使用密钥对加密</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// rsautl 命令默认填充机制是 PKCS#1 v1.5
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl rsautl <span style=color:#f92672>-</span>encrypt <span style=color:#f92672>-</span>inkey mykey.pem <span style=color:#f92672>-</span>in plain.txt <span style=color:#f92672>-</span>out cipher.txt

<span style=color:#75715e>// 指定 rsautl 填充机制为 PKCS#1 OAEP
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl rsautl <span style=color:#f92672>-</span>encrypt <span style=color:#f92672>-</span>inkey mykey.pem <span style=color:#f92672>-</span>in plain.txt <span style=color:#f92672>-</span>out cipher.txt <span style=color:#f92672>-</span>oaep
</code></pre></div><p>假设我们加密的文件里面的明文是 &ldquo;hello world&rdquo;。加密以后密文变成了：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#ae81ff>1</span>Au<span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>&amp;</span>.<span style=color:#960050;background-color:#1e0010>�</span>rzC<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>��</span><span style=color:#ae81ff>6</span><span style=color:#f92672>:</span>
<span style=color:#f92672>+</span><span style=color:#960050;background-color:#1e0010>��</span><span style=color:#ae81ff>٠</span>P<span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>|</span><span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>İ���</span>}<span style=color:#960050;background-color:#1e0010>&#39;</span>x<span style=color:#960050;background-color:#1e0010>�������</span>X<span style=color:#960050;background-color:#1e0010>�</span>IkBx<span style=color:#960050;background-color:#1e0010>��</span>V2<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>��$�</span>N<span style=color:#960050;background-color:#1e0010>�</span>(<span style=color:#ae81ff>5</span>m<span style=color:#960050;background-color:#1e0010>�</span>s<span style=color:#960050;background-color:#1e0010>�#�</span>m<span style=color:#960050;background-color:#1e0010>�</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>����</span>s<span style=color:#960050;background-color:#1e0010>�ɜ</span><span style=color:#f92672>+</span>jėއ(<span style=color:#f92672>!</span>E<span style=color:#960050;background-color:#1e0010>�</span>t<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>??</span><span style=color:#960050;background-color:#1e0010>�</span>{<span style=color:#960050;background-color:#1e0010>���</span>Y<span style=color:#960050;background-color:#1e0010>�</span>W<span style=color:#960050;background-color:#1e0010>�</span>a<span style=color:#960050;background-color:#1e0010>��</span>tȈp<span style=color:#960050;background-color:#1e0010>���</span>uUlzk<span style=color:#960050;background-color:#1e0010>�</span>I9W<span style=color:#960050;background-color:#1e0010>����</span>[<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>�</span>l<span style=color:#f92672>!</span>J<span style=color:#960050;background-color:#1e0010>��ө��</span><span style=color:#f92672>-</span>v<span style=color:#960050;background-color:#1e0010>�</span>O_h<span style=color:#960050;background-color:#1e0010>����</span>b<span style=color:#f92672>~</span> <span style=color:#960050;background-color:#1e0010>��</span>Y
</code></pre></div><p>使用公钥加密，务必有 -pubin 参数表明 -inkey 参数输入的是公钥文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl rsautl <span style=color:#f92672>-</span>encrypt <span style=color:#f92672>-</span>pubin <span style=color:#f92672>-</span>inkey mypubkey.pem <span style=color:#f92672>-</span>in plain.txt <span style=color:#f92672>-</span>out cipher2.txt
</code></pre></div><p>同样加密的明文是 &ldquo;hello world&rdquo;，加密以后密文变成了：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>�</span>
<span style=color:#960050;background-color:#1e0010>�</span>P<span style=color:#960050;background-color:#1e0010>�</span>C<span style=color:#960050;background-color:#1e0010>��</span>)<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>&gt;</span>e{<span style=color:#960050;background-color:#1e0010>�</span>}<span style=color:#960050;background-color:#1e0010>�</span>QK<span style=color:#960050;background-color:#1e0010>���</span>N2At<span style=color:#960050;background-color:#1e0010>�</span>T<span style=color:#960050;background-color:#1e0010>�</span>XSF<span style=color:#960050;background-color:#1e0010>�</span>P<span style=color:#960050;background-color:#1e0010>�</span>cFO2āFbj<span style=color:#960050;background-color:#1e0010>��</span>G0<span style=color:#960050;background-color:#1e0010>�</span>c<span style=color:#960050;background-color:#1e0010>���</span>Kg<span style=color:#960050;background-color:#1e0010>�</span>G<span style=color:#f92672>+</span><span style=color:#960050;background-color:#1e0010>�</span>Q<span style=color:#960050;background-color:#1e0010>�</span>qߊ<span style=color:#960050;background-color:#1e0010>�&#39;</span>
       <span style=color:#f92672>~</span>;<span style=color:#960050;background-color:#1e0010>�`</span>DF{<span style=color:#960050;background-color:#1e0010>�ϭ</span>a<span style=color:#f92672>&amp;</span>i<span style=color:#960050;background-color:#1e0010>����</span><span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#ae81ff>3l</span><span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>!</span>	<span style=color:#960050;background-color:#1e0010>�</span>w<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>&amp;</span>q<span style=color:#960050;background-color:#1e0010>���</span>Q<span style=color:#960050;background-color:#1e0010>���</span>z<span style=color:#960050;background-color:#1e0010>�</span>f<span style=color:#960050;background-color:#1e0010>��Κ�</span><span style=color:#f92672>!</span><span style=color:#960050;background-color:#1e0010>�</span>u<span style=color:#960050;background-color:#1e0010>�ʩ��</span>j<span style=color:#960050;background-color:#1e0010>�</span>U<span style=color:#960050;background-color:#1e0010>�</span>Y
</code></pre></div><p>解密</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl rsautl <span style=color:#f92672>-</span>decrypt <span style=color:#f92672>-</span>inkey mykey.pem <span style=color:#f92672>-</span>in cipher.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>hello world
</code></pre></div><h2 id=十二openssl-中的-ecc>十二、OpenSSL 中的 ECC</h2><h3 id=1-dh-密钥协商>1. DH 密钥协商</h3><p>与 RSA 密钥对生成方式不一样，DH 密钥对生成方式分为 2 步，第一步先生成参数文件，第二步再根据参数文件生成密钥对，<strong>同一个参数文件可以生成无数多且不重复的密钥对</strong>。</p><p>第一步，生成 DH 密钥对</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成 2048 比特的参数文件
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl dhparam <span style=color:#f92672>-</span>out dhparam.pem <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span> <span style=color:#ae81ff>2048</span>

<span style=color:#960050;background-color:#1e0010>$</span> openssl dhparam <span style=color:#f92672>-</span>in dhparam.pem <span style=color:#f92672>-</span>noout <span style=color:#f92672>-</span>C
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Generating DH parameters, <span style=color:#ae81ff>2048</span> bit <span style=color:#66d9ef>long</span> safe prime, generator <span style=color:#ae81ff>2</span>
This is going to take a <span style=color:#66d9ef>long</span> time
......................<span style=color:#f92672>+</span>..........................................................................<span style=color:#f92672>+</span>..............................................................................................................................................................................................<span style=color:#f92672>+</span>.......................................................<span style=color:#f92672>+</span>

<span style=color:#75715e>#ifndef HEADER_DH_H
</span><span style=color:#75715e># include &lt;openssl/dh.h&gt;
</span><span style=color:#75715e>#endif
</span><span style=color:#75715e></span>
DH <span style=color:#f92672>*</span>get_dh2048()
{
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> dhp_2048[] <span style=color:#f92672>=</span> {
	<span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0xDB</span>, <span style=color:#ae81ff>0x2E</span>, <span style=color:#ae81ff>0xF9</span>, <span style=color:#ae81ff>0x0B</span>, <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0xC4</span>, <span style=color:#ae81ff>0x31</span>,
	<span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xD5</span>, <span style=color:#ae81ff>0xEA</span>, <span style=color:#ae81ff>0x7E</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0xDA</span>, <span style=color:#ae81ff>0xC8</span>,
	<span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x0E</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0xDD</span>, <span style=color:#ae81ff>0xF6</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0x07</span>, <span style=color:#ae81ff>0x2A</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0x97</span>,
	<span style=color:#ae81ff>0xC3</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0xA1</span>, <span style=color:#ae81ff>0x9B</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xC0</span>, <span style=color:#ae81ff>0xB9</span>, <span style=color:#ae81ff>0x33</span>,
	<span style=color:#ae81ff>0xD1</span>, <span style=color:#ae81ff>0xBB</span>, <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0xF0</span>, <span style=color:#ae81ff>0xBA</span>, <span style=color:#ae81ff>0x8C</span>, <span style=color:#ae81ff>0x7A</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x1F</span>, <span style=color:#ae81ff>0xDF</span>,
	<span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xB5</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0x1E</span>, <span style=color:#ae81ff>0xA8</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xC0</span>, <span style=color:#ae81ff>0x94</span>,
	<span style=color:#ae81ff>0xED</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0xFC</span>, <span style=color:#ae81ff>0xF6</span>, <span style=color:#ae81ff>0xE1</span>,
	<span style=color:#ae81ff>0xBE</span>, <span style=color:#ae81ff>0xC7</span>, <span style=color:#ae81ff>0xB8</span>, <span style=color:#ae81ff>0x7A</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0xC1</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x06</span>, <span style=color:#ae81ff>0xC6</span>,
	<span style=color:#ae81ff>0xB8</span>, <span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0xDC</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0xEA</span>, <span style=color:#ae81ff>0xA0</span>, <span style=color:#ae81ff>0xD1</span>, <span style=color:#ae81ff>0x3E</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0xBD</span>,
	<span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0xBB</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0xFE</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0xC7</span>,
	<span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0xA2</span>, <span style=color:#ae81ff>0x0B</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0xAD</span>, <span style=color:#ae81ff>0xDD</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x9A</span>, <span style=color:#ae81ff>0xD8</span>,
	<span style=color:#ae81ff>0x2A</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0xCE</span>, <span style=color:#ae81ff>0xF4</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0xB2</span>, <span style=color:#ae81ff>0x5C</span>, <span style=color:#ae81ff>0x0F</span>, <span style=color:#ae81ff>0x9E</span>,
	<span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0xE5</span>, <span style=color:#ae81ff>0xE6</span>, <span style=color:#ae81ff>0x0D</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0xF5</span>, <span style=color:#ae81ff>0xF5</span>, <span style=color:#ae81ff>0xDC</span>, <span style=color:#ae81ff>0x07</span>,
	<span style=color:#ae81ff>0x2D</span>, <span style=color:#ae81ff>0xF0</span>, <span style=color:#ae81ff>0xDE</span>, <span style=color:#ae81ff>0xB5</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0xEC</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0x65</span>,
	<span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0xC3</span>, <span style=color:#ae81ff>0x8C</span>, <span style=color:#ae81ff>0xBF</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x4C</span>, <span style=color:#ae81ff>0xC3</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x77</span>,
	<span style=color:#ae81ff>0xE0</span>, <span style=color:#ae81ff>0x5F</span>, <span style=color:#ae81ff>0xF6</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x5F</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x75</span>,
	<span style=color:#ae81ff>0x8E</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0xA3</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xD7</span>, <span style=color:#ae81ff>0xE3</span>, <span style=color:#ae81ff>0xB7</span>, <span style=color:#ae81ff>0xB8</span>,
	<span style=color:#ae81ff>0x0F</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0xF3</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x0D</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0xB2</span>, <span style=color:#ae81ff>0x5F</span>,
	<span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x2C</span>, <span style=color:#ae81ff>0x9D</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0xE0</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0xCB</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0xE9</span>, <span style=color:#ae81ff>0x4A</span>,
	<span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0xA0</span>, <span style=color:#ae81ff>0x7E</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0xD4</span>, <span style=color:#ae81ff>0xA9</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0xB0</span>,
	<span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0xB2</span>, <span style=color:#ae81ff>0xF5</span>, <span style=color:#ae81ff>0xB4</span>, <span style=color:#ae81ff>0x9D</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x5B</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0x5D</span>, <span style=color:#ae81ff>0x4B</span>,
	<span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0xAA</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0xA4</span>, <span style=color:#ae81ff>0xA1</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0xF1</span>, <span style=color:#ae81ff>0x59</span>,
	<span style=color:#ae81ff>0xF6</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x8C</span>, <span style=color:#ae81ff>0xE7</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x8F</span>, <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x63</span>, <span style=color:#ae81ff>0x52</span>,
	<span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x0A</span>, <span style=color:#ae81ff>0xC1</span>, <span style=color:#ae81ff>0xC0</span>, <span style=color:#ae81ff>0xE5</span>, <span style=color:#ae81ff>0xDD</span>, <span style=color:#ae81ff>0x6F</span>, <span style=color:#ae81ff>0x4D</span>,
	<span style=color:#ae81ff>0xFD</span>, <span style=color:#ae81ff>0xC1</span>, <span style=color:#ae81ff>0x5D</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x6E</span>, <span style=color:#ae81ff>0xD0</span>, <span style=color:#ae81ff>0xA4</span>, <span style=color:#ae81ff>0xBD</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0xA1</span>,
	<span style=color:#ae81ff>0xA6</span>, <span style=color:#ae81ff>0xDE</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0xC9</span>, <span style=color:#ae81ff>0xF4</span>, <span style=color:#ae81ff>0x4B</span>
    };
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> dhg_2048[] <span style=color:#f92672>=</span> {
	<span style=color:#ae81ff>0x02</span>
    };
    DH <span style=color:#f92672>*</span>dh <span style=color:#f92672>=</span> DH_new();
    BIGNUM <span style=color:#f92672>*</span>dhp_bn, <span style=color:#f92672>*</span>dhg_bn;

    <span style=color:#66d9ef>if</span> (dh <span style=color:#f92672>==</span> NULL)
        <span style=color:#66d9ef>return</span> NULL;
    dhp_bn <span style=color:#f92672>=</span> BN_bin2bn(dhp_2048, <span style=color:#66d9ef>sizeof</span>(dhp_2048), NULL);
    dhg_bn <span style=color:#f92672>=</span> BN_bin2bn(dhg_2048, <span style=color:#66d9ef>sizeof</span>(dhg_2048), NULL);
    <span style=color:#66d9ef>if</span> (dhp_bn <span style=color:#f92672>==</span> NULL <span style=color:#f92672>||</span> dhg_bn <span style=color:#f92672>==</span> NULL
            <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>DH_set0_pqg(dh, dhp_bn, NULL, dhg_bn)) {
        DH_free(dh);
        BN_free(dhp_bn);
        BN_free(dhg_bn);
        <span style=color:#66d9ef>return</span> NULL;
    }
    <span style=color:#66d9ef>return</span> dh;
}
<span style=color:#f92672>-----</span>BEGIN DH PARAMETERS<span style=color:#f92672>-----</span>
MIIBCAKCAQEAvXDbLvkLiTfEMZNIR<span style=color:#f92672>+/</span>V6n682sgUDoLd9sYHKtSXwwKhmwLL5MC5
M9G7afC6jHpXH9<span style=color:#f92672>/</span>TtS<span style=color:#f92672>+</span>HHqg15MCU7SAEJlhQJ<span style=color:#f92672>/</span>z24b7HuHoUwQgWBsa4Cdw06qDR
Poi9s7sF<span style=color:#f92672>/</span>k3LYgWaxwCiC3Ot3TkYmtgqlc70EGqyXA<span style=color:#f92672>+</span>emeXmDWwZ9fXcBy3w3rVY
<span style=color:#ae81ff>7</span>DUz72Vww4y<span style=color:#f92672>/</span>FEBMw0d34F<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>YV9JNcw5dY4xo5lDYdfjt7gPefNmUJUNlbJfGyyd
ZOBUyyfpSiOWoH5V1KmTQ7BpsvW0nUFb011LkUifqlSkoYHxWfazRIzng49XY1JY
cC8KwcDl3W9N<span style=color:#f92672>/</span>cFdYW7QpL0VoabeYcn0SwIBAg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END DH PARAMETERS<span style=color:#f92672>-----</span>
</code></pre></div><p>第二步，基于参数文件生成密钥对</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>paramfile dhparam.pem <span style=color:#f92672>-</span>out dhkey.pem

<span style=color:#75715e>// 查看密钥对文件内容
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in dhkey.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>DH Private<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>2048</span> bit)
    private<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>53</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>c:d5:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>80</span><span style=color:#f92672>:</span><span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>49</span><span style=color:#f92672>:</span>b0:c0:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span>fd:<span style=color:#ae81ff>4</span>b:<span style=color:#ae81ff>8</span>d:
        <span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>c6:b2:f3:<span style=color:#ae81ff>49</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>3</span>c:f7:d8:<span style=color:#ae81ff>49</span><span style=color:#f92672>:</span>cf:b2:b2:cd:
        b6:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>be:b8:de:<span style=color:#ae81ff>54</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:dc:e5:f1:<span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>c:<span style=color:#ae81ff>7</span>c:
        <span style=color:#ae81ff>7</span>d:b9:<span style=color:#ae81ff>6</span>e:aa:db:<span style=color:#ae81ff>3</span>e:a0:b0:e1:e8:aa:b6:<span style=color:#ae81ff>6</span>e:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span>c8:
        <span style=color:#ae81ff>59</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>b7:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>cb:<span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>c8:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>18</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>6</span>b:
        fb:<span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>f6:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:c8:<span style=color:#ae81ff>6</span>d:df:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span>cf:b9:df:<span style=color:#ae81ff>41</span><span style=color:#f92672>:</span><span style=color:#ae81ff>53</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>1</span>c:<span style=color:#ae81ff>5</span>e:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>77</span><span style=color:#f92672>:</span><span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>c0:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>a0:a2:<span style=color:#ae81ff>4</span>d:e8:f7:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:f8:<span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>18</span><span style=color:#f92672>:</span>d1:<span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>dc:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span><span style=color:#ae81ff>93</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>26</span><span style=color:#f92672>:</span>c6:fc:ca:a6:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>73</span><span style=color:#f92672>:</span>d8:bc:ee:<span style=color:#ae81ff>2</span>b:<span style=color:#ae81ff>1</span>c:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>4</span>c:ab:<span style=color:#ae81ff>0</span>b:a3:a0:ce:d3:cd:<span style=color:#ae81ff>1</span>d:d9:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>b3:<span style=color:#ae81ff>32</span><span style=color:#f92672>:</span>f0:
        <span style=color:#ae81ff>74</span><span style=color:#f92672>:</span>fd:<span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>d:<span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>b:a4:ed:e0:d2:<span style=color:#ae81ff>7</span>e:eb:<span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>
        c7:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>e7:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:f8:f0:a5:fc:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span>ee:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>b5:e6:ba:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:e0:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span>bc:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>b3:b3:
        ea:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>5</span>b:f5:db:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>15</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>6</span>b:
        e3:<span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>e:b1:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>a1:c1:bb:c0:fa:<span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>
        ae:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>35</span><span style=color:#f92672>:</span>ce:dc:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:<span style=color:#ae81ff>63</span><span style=color:#f92672>:</span>b4:<span style=color:#ae81ff>30</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>a:<span style=color:#ae81ff>9</span>d:<span style=color:#ae81ff>49</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>b:ac:a0:<span style=color:#ae81ff>8</span>e:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span>dc:a5:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>cd:c6:e0:<span style=color:#ae81ff>74</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>50</span>
    public<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:<span style=color:#ae81ff>3</span>e:<span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>a:e9:<span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span>e0:cc:a0:<span style=color:#ae81ff>40</span><span style=color:#f92672>:</span>
        e9:<span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>c4:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>b0:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>6</span>e:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>a:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span>de:
        a3:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>a:d1:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span>f4:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>c:<span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span>f5:<span style=color:#ae81ff>86</span><span style=color:#f92672>:</span><span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>39</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>13</span><span style=color:#f92672>:</span>bf:c7:<span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>af:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span>cd:<span style=color:#ae81ff>0</span>e:f9:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>d4:
        d4:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span>f7:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:bf:e2:<span style=color:#ae81ff>9</span>a:de:fa:<span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>c:f7:b3:<span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>f2:<span style=color:#ae81ff>30</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>a:
        <span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>e:<span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>51</span><span style=color:#f92672>:</span>ed:<span style=color:#ae81ff>24</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>f9:<span style=color:#ae81ff>6</span>e:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>e:b0:cf:<span style=color:#ae81ff>6</span>a:<span style=color:#ae81ff>7</span>e:c3:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>f5:<span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span>f6:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>c4:<span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>b4:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:
        <span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span><span style=color:#ae81ff>32</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span>be:<span style=color:#ae81ff>77</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>f1:a8:c5:e3:cd:<span style=color:#ae81ff>4</span>d:
        b8:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span>fa:ab:<span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>0</span>c:a7:
        b8:b4:<span style=color:#ae81ff>6</span>e:<span style=color:#ae81ff>76</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span>d2:<span style=color:#ae81ff>50</span><span style=color:#f92672>:</span>b7:a3:<span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>0</span>c:<span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>53</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>
        fa:eb:<span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span>df:e7:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>fa:a8:be:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>41</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span>e9:ae:<span style=color:#ae81ff>1</span>d:e4:e1:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>bc:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span>f3:b3:a2:ab:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>31</span><span style=color:#f92672>:</span>eb:<span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>21</span><span style=color:#f92672>:</span>dc:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span>ea:c2:<span style=color:#ae81ff>1</span>d:ac:
        <span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>d:<span style=color:#ae81ff>0</span>d:d4:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>c:b0:<span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:<span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>f4:<span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>96</span><span style=color:#f92672>:</span>da:e7:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>40</span><span style=color:#f92672>:</span>b4:d6:<span style=color:#ae81ff>0</span>a:<span style=color:#ae81ff>5</span>c:
        aa:df
    prime:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>bd:<span style=color:#ae81ff>70</span><span style=color:#f92672>:</span>db:<span style=color:#ae81ff>2</span>e:f9:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span>c4:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span><span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>47</span><span style=color:#f92672>:</span>ef:
        d5:ea:<span style=color:#ae81ff>7</span>e:bc:da:c8:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span>dd:f6:c6:<span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:d4:
        <span style=color:#ae81ff>97</span><span style=color:#f92672>:</span>c3:<span style=color:#ae81ff>02</span><span style=color:#f92672>:</span>a1:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>02</span><span style=color:#f92672>:</span>cb:e4:c0:b9:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>d1:bb:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span>f0:
        ba:<span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>df:d3:b5:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>e:a8:<span style=color:#ae81ff>35</span><span style=color:#f92672>:</span>e4:c0:
        <span style=color:#ae81ff>94</span><span style=color:#f92672>:</span>ed:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>27</span><span style=color:#f92672>:</span>fc:f6:e1:be:c7:b8:<span style=color:#ae81ff>7</span>a:
        <span style=color:#ae81ff>14</span><span style=color:#f92672>:</span>c1:<span style=color:#ae81ff>08</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>06</span><span style=color:#f92672>:</span>c6:b8:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>dc:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span>ea:a0:d1:<span style=color:#ae81ff>3</span>e:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span>
        bd:b3:bb:<span style=color:#ae81ff>05</span><span style=color:#f92672>:</span>fe:<span style=color:#ae81ff>4</span>d:cb:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:c7:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>a2:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span>
        ad:dd:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>18</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:d8:<span style=color:#ae81ff>2</span>a:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span>ce:f4:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>a:b2:<span style=color:#ae81ff>5</span>c:<span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>99</span><span style=color:#f92672>:</span>e5:e6:<span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>f5:f5:dc:<span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:f0:de:b5:
        <span style=color:#ae81ff>58</span><span style=color:#f92672>:</span>ec:<span style=color:#ae81ff>35</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>ef:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>70</span><span style=color:#f92672>:</span>c3:<span style=color:#ae81ff>8</span>c:bf:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span><span style=color:#ae81ff>40</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:c3:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>e0:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span>f6:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>49</span><span style=color:#f92672>:</span><span style=color:#ae81ff>35</span><span style=color:#f92672>:</span>cc:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>e:<span style=color:#ae81ff>31</span><span style=color:#f92672>:</span>a3:<span style=color:#ae81ff>99</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>61</span><span style=color:#f92672>:</span>d7:e3:b7:b8:<span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>f3:<span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span>b2:
        <span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>9</span>d:<span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>e0:<span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>cb:<span style=color:#ae81ff>27</span><span style=color:#f92672>:</span>e9:<span style=color:#ae81ff>4</span>a:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>96</span><span style=color:#f92672>:</span>a0:<span style=color:#ae81ff>7</span>e:
        <span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>d4:a9:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>b0:<span style=color:#ae81ff>69</span><span style=color:#f92672>:</span>b2:f5:b4:<span style=color:#ae81ff>9</span>d:<span style=color:#ae81ff>41</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>b:d3:<span style=color:#ae81ff>5</span>d:
        <span style=color:#ae81ff>4</span>b:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>aa:<span style=color:#ae81ff>54</span><span style=color:#f92672>:</span>a4:a1:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>f1:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span>f6:b3:<span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:
        e7:<span style=color:#ae81ff>83</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:c1:c0:e5:dd:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>4</span>d:fd:c1:<span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>e:d0:a4:bd:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span>a1:a6:de:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span>c9:
        f4:<span style=color:#ae81ff>4</span>b
    generator: <span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x2</span>)
</code></pre></div><p>prime 是一个大质数，generator 是生成元。</p><p>接下来举一个 DH 密钥协商的完整例子。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 通讯一方生成 DH 参数文件，可以对外公开
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>genparam <span style=color:#f92672>-</span>algorithm DH <span style=color:#f92672>-</span>out dhp.pem

<span style=color:#75715e>// 查看参数文件内容，包括 p 和 g 参数
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl pkeyparam <span style=color:#f92672>-</span>in dhp.pem <span style=color:#f92672>-</span>text
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN DH PARAMETERS<span style=color:#f92672>-----</span>
MIGHAoGBAO6kIxno65uejqlc0Q<span style=color:#f92672>+</span>SwnpIQjc9A8DMr1r1xNk9d<span style=color:#f92672>/</span>qTGczGi52olR96
XfKHZMKCRih4mvFglAfisykwLGdVViiqOQrLmG0uI2WviyPKG4eHqu7gID<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+</span>pil
RBHo6m9McsnlrcGLgV2d3a3IczNcH<span style=color:#f92672>/</span>g2NnVoKN6Q9<span style=color:#f92672>+</span>tGiZKhowZDAgEC
<span style=color:#f92672>-----</span>END DH PARAMETERS<span style=color:#f92672>-----</span>
DH Parameters: (<span style=color:#ae81ff>1024</span> bit)
    prime:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>ee:a4:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>e8:eb:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>8</span>e:a9:<span style=color:#ae81ff>5</span>c:d1:<span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
        c2:<span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>c0:cc:af:<span style=color:#ae81ff>5</span>a:f5:c4:d9:<span style=color:#ae81ff>3</span>d:
        <span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>cc:c6:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>9</span>d:a8:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>5</span>d:f2:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:f1:<span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span>e2:b3:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>aa:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:cb:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>2</span>e:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>af:
        <span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>aa:ee:e0:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>fa:fa:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>a5:
        <span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>e8:ea:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>72</span><span style=color:#f92672>:</span>c9:e5:ad:c1:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>9</span>d:
        dd:ad:c8:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:<span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>de:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>
        f7:eb:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>a1:a3:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span>
    generator: <span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x2</span>)
</code></pre></div><p>发送方 Alice 基于参数文件生成一个密钥对</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>paramfile dhp.pem <span style=color:#f92672>-</span>out akey.pem

<span style=color:#75715e>// 查看密钥对内容
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in akey.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>DH Private<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>1024</span> bit)
    private<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>79</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>83</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>34</span><span style=color:#f92672>:</span>db:<span style=color:#ae81ff>4</span>a:ea:d6:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:
        <span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>cd:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>ea:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>c3:f7:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>91</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>c:<span style=color:#ae81ff>96</span><span style=color:#f92672>:</span>cf:
        <span style=color:#ae81ff>6</span>b:<span style=color:#ae81ff>8</span>d:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>83</span><span style=color:#f92672>:</span>fb:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>c5:f6:eb:
        <span style=color:#ae81ff>74</span><span style=color:#f92672>:</span><span style=color:#ae81ff>13</span><span style=color:#f92672>:</span>ff:a4:<span style=color:#ae81ff>2</span>e:ae:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span>df:b5:<span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:af:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>cf:
        <span style=color:#ae81ff>02</span><span style=color:#f92672>:</span>b6:<span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>d5:c8:a1:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>86</span><span style=color:#f92672>:</span>dd:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>a:d1:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>52</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>ce:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>22</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>f4:df:a6:df:<span style=color:#ae81ff>80</span><span style=color:#f92672>:</span>c2:cc:c6:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>
        de:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span>e2:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>09</span><span style=color:#f92672>:</span>d1:<span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span><span style=color:#ae81ff>88</span><span style=color:#f92672>:</span>
        cc:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span>e6:<span style=color:#ae81ff>22</span><span style=color:#f92672>:</span>b0:fa:<span style=color:#ae81ff>5</span>c:c9:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>d:de:b6:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>05</span><span style=color:#f92672>:</span>f4:<span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>58</span><span style=color:#f92672>:</span>b8:fb:<span style=color:#ae81ff>93</span>
    public<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>4</span>d:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>d3:<span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span>df:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span>fb:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>32</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:<span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>67</span><span style=color:#f92672>:</span>cb:
        <span style=color:#ae81ff>51</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>c:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>10</span><span style=color:#f92672>:</span>ef:<span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span><span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>c:e6:<span style=color:#ae81ff>97</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>10</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>92</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>d:d5:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>d5:<span style=color:#ae81ff>97</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>71</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>12</span><span style=color:#f92672>:</span><span style=color:#ae81ff>99</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>86</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>d:ee:b2:ca:<span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>96</span><span style=color:#f92672>:</span>ae:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>d:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span>b5:
        <span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>0</span>c:e6:<span style=color:#ae81ff>41</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>97</span><span style=color:#f92672>:</span>d4:<span style=color:#ae81ff>0</span>c:<span style=color:#ae81ff>50</span><span style=color:#f92672>:</span>a2:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:a9:e8:
        <span style=color:#ae81ff>7</span>e:c0:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>fd:dc:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>f7:<span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>ee:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>e:
        <span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>70</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>c0:a8:a7:<span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>6</span>e:e8:<span style=color:#ae81ff>27</span><span style=color:#f92672>:</span><span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>b:af:
        <span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>72</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:aa:a1:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>d:<span style=color:#ae81ff>0</span>d:<span style=color:#ae81ff>78</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>1</span>e:bd:b5:
        <span style=color:#ae81ff>3</span>b:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>bc:<span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>1</span>a:d3
    prime:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>ee:a4:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>e8:eb:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>8</span>e:a9:<span style=color:#ae81ff>5</span>c:d1:<span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
        c2:<span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>c0:cc:af:<span style=color:#ae81ff>5</span>a:f5:c4:d9:<span style=color:#ae81ff>3</span>d:
        <span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>cc:c6:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>9</span>d:a8:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>5</span>d:f2:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:f1:<span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span>e2:b3:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>aa:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:cb:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>2</span>e:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>af:
        <span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>aa:ee:e0:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>fa:fa:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>a5:
        <span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>e8:ea:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>72</span><span style=color:#f92672>:</span>c9:e5:ad:c1:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>9</span>d:
        dd:ad:c8:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:<span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>de:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>
        f7:eb:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>a1:a3:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span>
    generator: <span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x2</span>)
</code></pre></div><p>接收方 Bob 也基于参数文件生成一个密钥对</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>paramfile dhp.pem <span style=color:#f92672>-</span>out bkey.pem

<span style=color:#75715e>// 查看密钥对内容
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in bkey.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>PKCS<span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>3</span> DH Private<span style=color:#f92672>-</span>Key: (<span style=color:#ae81ff>1024</span> bit)
    private<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>7</span>b:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>e:c9:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span><span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>a:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>69</span><span style=color:#f92672>:</span><span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>03</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:f5:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span>ef:
        c2:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>27</span><span style=color:#f92672>:</span>f5:a7:e3:c9:<span style=color:#ae81ff>14</span><span style=color:#f92672>:</span><span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>76</span><span style=color:#f92672>:</span>ea:<span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>68</span><span style=color:#f92672>:</span>
        e5:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>38</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span>e1:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>d:fb:d2:<span style=color:#ae81ff>97</span><span style=color:#f92672>:</span><span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>a:<span style=color:#ae81ff>0</span>c:
        <span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>81</span><span style=color:#f92672>:</span>d3:<span style=color:#ae81ff>4</span>a:<span style=color:#ae81ff>33</span><span style=color:#f92672>:</span>c8:<span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>64</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>c:cd:a6:<span style=color:#ae81ff>3</span>a:<span style=color:#ae81ff>26</span><span style=color:#f92672>:</span>
        d0:<span style=color:#ae81ff>2</span>b:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>d:<span style=color:#ae81ff>78</span><span style=color:#f92672>:</span>b0:e7:<span style=color:#ae81ff>1</span>e:<span style=color:#ae81ff>12</span><span style=color:#f92672>:</span>d8:a3:<span style=color:#ae81ff>89</span><span style=color:#f92672>:</span>da:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>53</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>1</span>e:d0:<span style=color:#ae81ff>9</span>a:<span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span>f6:c0:ce:<span style=color:#ae81ff>7</span>d:c9:<span style=color:#ae81ff>25</span><span style=color:#f92672>:</span><span style=color:#ae81ff>50</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>cf:c2:cb:
        <span style=color:#ae81ff>0</span>d:e2:<span style=color:#ae81ff>74</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>c:<span style=color:#ae81ff>58</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>71</span><span style=color:#f92672>:</span><span style=color:#ae81ff>38</span><span style=color:#f92672>:</span>f0:d3:d2:<span style=color:#ae81ff>91</span><span style=color:#f92672>:</span>f4:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>
        ec:da:f2:f9:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span>e6:c4:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:<span style=color:#ae81ff>97</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>a:f9:a3:fd:c0:
        <span style=color:#ae81ff>0</span>e:cb:d0:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>d:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>01</span><span style=color:#f92672>:</span>c4
    public<span style=color:#f92672>-</span>key:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>c:ad:e1:<span style=color:#ae81ff>2f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4f</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:<span style=color:#ae81ff>15</span><span style=color:#f92672>:</span>d0:f9:c5:
        <span style=color:#ae81ff>84</span><span style=color:#f92672>:</span>b4:a3:be:<span style=color:#ae81ff>9</span>d:b2:fb:<span style=color:#ae81ff>57</span><span style=color:#f92672>:</span><span style=color:#ae81ff>86</span><span style=color:#f92672>:</span>b8:c7:<span style=color:#ae81ff>0</span>c:d3:d5:<span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
        c1:<span style=color:#ae81ff>7</span>b:db:e6:e6:b2:<span style=color:#ae81ff>7</span>e:ff:db:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span>d9:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>4</span>d:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span>ac:b2:<span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>23</span><span style=color:#f92672>:</span>f6:aa:<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span>b6:e4:f4:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>f1:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>88</span><span style=color:#f92672>:</span><span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>21</span><span style=color:#f92672>:</span>c9:f7:d2:f3:dc:<span style=color:#ae81ff>0</span>e:a6:<span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span><span style=color:#f92672>:</span>
        ed:<span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>61</span><span style=color:#f92672>:</span><span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>a2:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>d3:<span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>d:c3:<span style=color:#ae81ff>96</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>d:
        be:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>83</span><span style=color:#f92672>:</span>bf:<span style=color:#ae81ff>9</span>e:b3:f8:e7:ac:<span style=color:#ae81ff>88</span><span style=color:#f92672>:</span>c5:<span style=color:#ae81ff>3</span>e:<span style=color:#ae81ff>9</span>b:b7:
        <span style=color:#ae81ff>01</span><span style=color:#f92672>:</span><span style=color:#ae81ff>52</span><span style=color:#f92672>:</span><span style=color:#ae81ff>63</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span>a:<span style=color:#ae81ff>30</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>b:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>06</span><span style=color:#f92672>:</span>f3:b4:f8:
        c4:<span style=color:#ae81ff>4</span>b:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span><span style=color:#ae81ff>45</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span><span style=color:#f92672>:</span>da:d5:<span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>1</span>e
    prime:
        <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>ee:a4:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>e8:eb:<span style=color:#ae81ff>9</span>b:<span style=color:#ae81ff>9</span>e:<span style=color:#ae81ff>8</span>e:a9:<span style=color:#ae81ff>5</span>c:d1:<span style=color:#ae81ff>0f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>
        c2:<span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span><span style=color:#f92672>:</span><span style=color:#ae81ff>37</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>d:<span style=color:#ae81ff>03</span><span style=color:#f92672>:</span>c0:cc:af:<span style=color:#ae81ff>5</span>a:f5:c4:d9:<span style=color:#ae81ff>3</span>d:
        <span style=color:#ae81ff>77</span><span style=color:#f92672>:</span>fa:<span style=color:#ae81ff>93</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span>cc:c6:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>9</span>d:a8:<span style=color:#ae81ff>95</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>a:<span style=color:#ae81ff>5</span>d:f2:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>64</span><span style=color:#f92672>:</span>c2:<span style=color:#ae81ff>82</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span><span style=color:#ae81ff>78</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>a:f1:<span style=color:#ae81ff>60</span><span style=color:#f92672>:</span><span style=color:#ae81ff>94</span><span style=color:#f92672>:</span><span style=color:#ae81ff>07</span><span style=color:#f92672>:</span>e2:b3:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>30</span><span style=color:#f92672>:</span>
        <span style=color:#ae81ff>2</span>c:<span style=color:#ae81ff>67</span><span style=color:#f92672>:</span><span style=color:#ae81ff>55</span><span style=color:#f92672>:</span><span style=color:#ae81ff>56</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>aa:<span style=color:#ae81ff>39</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>a:cb:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>d:<span style=color:#ae81ff>2</span>e:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span><span style=color:#ae81ff>65</span><span style=color:#f92672>:</span>af:
        <span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>23</span><span style=color:#f92672>:</span>ca:<span style=color:#ae81ff>1</span>b:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span><span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>aa:ee:e0:<span style=color:#ae81ff>20</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3f</span><span style=color:#f92672>:</span>fa:fa:<span style=color:#ae81ff>98</span><span style=color:#f92672>:</span>a5:
        <span style=color:#ae81ff>44</span><span style=color:#f92672>:</span><span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>e8:ea:<span style=color:#ae81ff>6f</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>c:<span style=color:#ae81ff>72</span><span style=color:#f92672>:</span>c9:e5:ad:c1:<span style=color:#ae81ff>8</span>b:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:<span style=color:#ae81ff>9</span>d:
        dd:ad:c8:<span style=color:#ae81ff>73</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>c:<span style=color:#ae81ff>1f</span><span style=color:#f92672>:</span>f8:<span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>75</span><span style=color:#f92672>:</span><span style=color:#ae81ff>68</span><span style=color:#f92672>:</span><span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>de:<span style=color:#ae81ff>90</span><span style=color:#f92672>:</span>
        f7:eb:<span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>89</span><span style=color:#f92672>:</span><span style=color:#ae81ff>92</span><span style=color:#f92672>:</span>a1:a3:<span style=color:#ae81ff>06</span><span style=color:#f92672>:</span><span style=color:#ae81ff>43</span>
    generator: <span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x2</span>)
</code></pre></div><p>Alice 拆出公钥文件 akey_pub.pem，私钥自己保存</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in akey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out akey_pub.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBHzCBlQYJKoZIhvcNAQMBMIGHAoGBAO6kIxno65uejqlc0Q<span style=color:#f92672>+</span>SwnpIQjc9A8DM
r1r1xNk9d<span style=color:#f92672>/</span>qTGczGi52olR96XfKHZMKCRih4mvFglAfisykwLGdVViiqOQrLmG0u
I2WviyPKG4eHqu7gID<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+</span>pilRBHo6m9McsnlrcGLgV2d3a3IczNcH<span style=color:#f92672>/</span>g2NnVoKN6Q
<span style=color:#ae81ff>9</span><span style=color:#f92672>+</span>tGiZKhowZDAgECA4GEAAKBgE2Q01<span style=color:#f92672>/</span>fE<span style=color:#f92672>/</span>sXMlVsOxdny1GPQhyIEO97kGks5peS
EJJPFo3Vm0<span style=color:#f92672>/</span>Vl<span style=color:#f92672>/</span>pxOygSmR<span style=color:#f92672>+</span>GDe6yyn5Plq5Gcx0UtQ4aDOZB<span style=color:#f92672>+</span>pfUDFCiF12p6H7A
M<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span>cWcoTkPcbee6IXjlwT8CopwsObugnKUMbr1ZyCqqhBh0NePhtGh69tTsgVXa8
nBrT
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Bob 拆出公钥文件 bkey_pub.pem，私钥自己保存</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in bkey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out bkey_pub.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MIIBIDCBlQYJKoZIhvcNAQMBMIGHAoGBAO6kIxno65uejqlc0Q<span style=color:#f92672>+</span>SwnpIQjc9A8DM
r1r1xNk9d<span style=color:#f92672>/</span>qTGczGi52olR96XfKHZMKCRih4mvFglAfisykwLGdVViiqOQrLmG0u
I2WviyPKG4eHqu7gID<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+</span>pilRBHo6m9McsnlrcGLgV2d3a3IczNcH<span style=color:#f92672>/</span>g2NnVoKN6Q
<span style=color:#ae81ff>9</span><span style=color:#f92672>+</span>tGiZKhowZDAgECA4GFAAKBgQCMreEvQoVP<span style=color:#f92672>+</span>Ad<span style=color:#f92672>+</span>FdD5xYS0o76dsvtXhrjHDNPV
ksF72<span style=color:#f92672>+</span>bmsn7<span style=color:#f92672>/</span><span style=color:#ae81ff>25</span>XZixAaEE1ZrLIAQ28j9qoTtuT0BJLxI4gTIcn30vPcDqZ1IO1M
YSlVojZV0wSffcOWfb5iRIO<span style=color:#f92672>/</span>nrP456yIxT6btwFSYxowX12QRlsGBvO0<span style=color:#f92672>+</span>MRLFkVD
<span style=color:#ae81ff>2</span>tVtHg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Alice 收到 Bob 他的公钥，并将协商出来的密钥保存到 data_a.txt 中</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkeyutl <span style=color:#f92672>-</span>derive <span style=color:#f92672>-</span>inkey akey.pem <span style=color:#f92672>-</span>peerkey bkey_pub.pem <span style=color:#f92672>-</span>out data_a.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>
b;[nQ<span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>!</span>z<span style=color:#960050;background-color:#1e0010></span>X<span style=color:#f92672>^</span>m<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#ae81ff>4</span><span style=color:#960050;background-color:#1e0010>���Է�</span>M<span style=color:#f92672>&lt;</span>{<span style=color:#f92672>|</span><span style=color:#ae81ff>1</span>X<span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>�</span>M3<span style=color:#960050;background-color:#1e0010>�</span>NT<span style=color:#960050;background-color:#1e0010>�Ł</span>m<span style=color:#960050;background-color:#1e0010>�Ϧ\��</span>X<span style=color:#f92672>+&lt;</span><span style=color:#960050;background-color:#1e0010>����</span>(L<span style=color:#960050;background-color:#1e0010>�</span>(<span style=color:#960050;background-color:#1e0010>�</span>F<span style=color:#960050;background-color:#1e0010>��</span>l5Yl<span style=color:#960050;background-color:#1e0010>��</span>N<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>/</span>o<span style=color:#960050;background-color:#1e0010>���</span>v<span style=color:#960050;background-color:#1e0010>�#</span><span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>���</span>J<span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>?</span>R<span style=color:#960050;background-color:#1e0010>�</span>,<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>!&gt;</span>G<span style=color:#960050;background-color:#1e0010>������</span>
                                                                                                   <span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>&gt;</span>B<span style=color:#960050;background-color:#1e0010>�����$�</span><span style=color:#f92672>-</span><span style=color:#960050;background-color:#1e0010>��</span>Y
                                                                                                   
</code></pre></div><p>对应二进制</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> od <span style=color:#f92672>-</span>d data_a.txt
                                                                                          <span style=color:#ae81ff>0000000</span>     <span style=color:#ae81ff>25098</span>   <span style=color:#ae81ff>23355</span>   <span style=color:#ae81ff>20846</span>   <span style=color:#ae81ff>16134</span>    <span style=color:#ae81ff>8602</span>   <span style=color:#ae81ff>32634</span>   <span style=color:#ae81ff>24152</span>   <span style=color:#ae81ff>59757</span>
<span style=color:#ae81ff>0000020</span>     <span style=color:#ae81ff>59416</span>   <span style=color:#ae81ff>57652</span>   <span style=color:#ae81ff>52209</span>   <span style=color:#ae81ff>47060</span>   <span style=color:#ae81ff>19942</span>   <span style=color:#ae81ff>31548</span>   <span style=color:#ae81ff>12668</span>   <span style=color:#ae81ff>16216</span>
<span style=color:#ae81ff>0000040</span>     <span style=color:#ae81ff>19901</span>   <span style=color:#ae81ff>56883</span>   <span style=color:#ae81ff>21582</span>   <span style=color:#ae81ff>50641</span>   <span style=color:#ae81ff>28033</span>   <span style=color:#ae81ff>53186</span>   <span style=color:#ae81ff>23718</span>   <span style=color:#ae81ff>55494</span>
<span style=color:#ae81ff>0000060</span>     <span style=color:#ae81ff>11096</span>   <span style=color:#ae81ff>35644</span>   <span style=color:#ae81ff>61385</span>   <span style=color:#ae81ff>10435</span>   <span style=color:#ae81ff>33612</span>   <span style=color:#ae81ff>54568</span>   <span style=color:#ae81ff>51014</span>   <span style=color:#ae81ff>27841</span>
<span style=color:#ae81ff>0000100</span>     <span style=color:#ae81ff>22837</span>   <span style=color:#ae81ff>44908</span>    <span style=color:#ae81ff>5587</span>   <span style=color:#ae81ff>49486</span>   <span style=color:#ae81ff>61576</span>   <span style=color:#ae81ff>12198</span>   <span style=color:#ae81ff>57967</span>   <span style=color:#ae81ff>64511</span>
<span style=color:#ae81ff>0000120</span>     <span style=color:#ae81ff>60534</span>   <span style=color:#ae81ff>56867</span>   <span style=color:#ae81ff>14088</span>   <span style=color:#ae81ff>38019</span>   <span style=color:#ae81ff>19100</span>   <span style=color:#ae81ff>15968</span>   <span style=color:#ae81ff>16283</span>   <span style=color:#ae81ff>57938</span>
<span style=color:#ae81ff>0000140</span>     <span style=color:#ae81ff>60972</span>   <span style=color:#ae81ff>57071</span>   <span style=color:#ae81ff>15905</span>     <span style=color:#ae81ff>583</span>   <span style=color:#ae81ff>49404</span>   <span style=color:#ae81ff>47506</span>   <span style=color:#ae81ff>61861</span>   <span style=color:#ae81ff>47628</span>
<span style=color:#ae81ff>0000160</span>      <span style=color:#ae81ff>5292</span>   <span style=color:#ae81ff>16958</span>   <span style=color:#ae81ff>38029</span>   <span style=color:#ae81ff>62234</span>   <span style=color:#ae81ff>57799</span>   <span style=color:#ae81ff>39460</span>   <span style=color:#ae81ff>43821</span>   <span style=color:#ae81ff>38391</span>
<span style=color:#ae81ff>0000200</span>
</code></pre></div><p>Bob 收到 Alice 他的公钥，并将协商出来的密钥保存到 data_b.txt 中</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkeyutl <span style=color:#f92672>-</span>derive <span style=color:#f92672>-</span>inkey bkey.pem <span style=color:#f92672>-</span>peerkey akey_pub.pem <span style=color:#f92672>-</span>out data_b.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>
b;[nQ<span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>!</span>z<span style=color:#960050;background-color:#1e0010></span>X<span style=color:#f92672>^</span>m<span style=color:#960050;background-color:#1e0010>��</span><span style=color:#ae81ff>4</span><span style=color:#960050;background-color:#1e0010>���Է�</span>M<span style=color:#f92672>&lt;</span>{<span style=color:#f92672>|</span><span style=color:#ae81ff>1</span>X<span style=color:#f92672>?</span><span style=color:#960050;background-color:#1e0010>�</span>M3<span style=color:#960050;background-color:#1e0010>�</span>NT<span style=color:#960050;background-color:#1e0010>�Ł</span>m<span style=color:#960050;background-color:#1e0010>�Ϧ\��</span>X<span style=color:#f92672>+&lt;</span><span style=color:#960050;background-color:#1e0010>����</span>(L<span style=color:#960050;background-color:#1e0010>�</span>(<span style=color:#960050;background-color:#1e0010>�</span>F<span style=color:#960050;background-color:#1e0010>��</span>l5Yl<span style=color:#960050;background-color:#1e0010>��</span>N<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>/</span>o<span style=color:#960050;background-color:#1e0010>���</span>v<span style=color:#960050;background-color:#1e0010>�#</span><span style=color:#ae81ff>7</span><span style=color:#960050;background-color:#1e0010>���</span>J<span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>�</span><span style=color:#f92672>?</span>R<span style=color:#960050;background-color:#1e0010>�</span>,<span style=color:#960050;background-color:#1e0010>���</span><span style=color:#f92672>!&gt;</span>G<span style=color:#960050;background-color:#1e0010>������</span>
                                                                                                   <span style=color:#960050;background-color:#1e0010>��</span><span style=color:#f92672>&gt;</span>B<span style=color:#960050;background-color:#1e0010>�����$�</span><span style=color:#f92672>-</span><span style=color:#960050;background-color:#1e0010>��</span>Y
</code></pre></div><p>对应二进制</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> od <span style=color:#f92672>-</span>d data_b.txt

<span style=color:#ae81ff>0000000</span>     <span style=color:#ae81ff>25098</span>   <span style=color:#ae81ff>23355</span>   <span style=color:#ae81ff>20846</span>   <span style=color:#ae81ff>16134</span>    <span style=color:#ae81ff>8602</span>   <span style=color:#ae81ff>32634</span>   <span style=color:#ae81ff>24152</span>   <span style=color:#ae81ff>59757</span>
<span style=color:#ae81ff>0000020</span>     <span style=color:#ae81ff>59416</span>   <span style=color:#ae81ff>57652</span>   <span style=color:#ae81ff>52209</span>   <span style=color:#ae81ff>47060</span>   <span style=color:#ae81ff>19942</span>   <span style=color:#ae81ff>31548</span>   <span style=color:#ae81ff>12668</span>   <span style=color:#ae81ff>16216</span>
<span style=color:#ae81ff>0000040</span>     <span style=color:#ae81ff>19901</span>   <span style=color:#ae81ff>56883</span>   <span style=color:#ae81ff>21582</span>   <span style=color:#ae81ff>50641</span>   <span style=color:#ae81ff>28033</span>   <span style=color:#ae81ff>53186</span>   <span style=color:#ae81ff>23718</span>   <span style=color:#ae81ff>55494</span>
<span style=color:#ae81ff>0000060</span>     <span style=color:#ae81ff>11096</span>   <span style=color:#ae81ff>35644</span>   <span style=color:#ae81ff>61385</span>   <span style=color:#ae81ff>10435</span>   <span style=color:#ae81ff>33612</span>   <span style=color:#ae81ff>54568</span>   <span style=color:#ae81ff>51014</span>   <span style=color:#ae81ff>27841</span>
<span style=color:#ae81ff>0000100</span>     <span style=color:#ae81ff>22837</span>   <span style=color:#ae81ff>44908</span>    <span style=color:#ae81ff>5587</span>   <span style=color:#ae81ff>49486</span>   <span style=color:#ae81ff>61576</span>   <span style=color:#ae81ff>12198</span>   <span style=color:#ae81ff>57967</span>   <span style=color:#ae81ff>64511</span>
<span style=color:#ae81ff>0000120</span>     <span style=color:#ae81ff>60534</span>   <span style=color:#ae81ff>56867</span>   <span style=color:#ae81ff>14088</span>   <span style=color:#ae81ff>38019</span>   <span style=color:#ae81ff>19100</span>   <span style=color:#ae81ff>15968</span>   <span style=color:#ae81ff>16283</span>   <span style=color:#ae81ff>57938</span>
<span style=color:#ae81ff>0000140</span>     <span style=color:#ae81ff>60972</span>   <span style=color:#ae81ff>57071</span>   <span style=color:#ae81ff>15905</span>     <span style=color:#ae81ff>583</span>   <span style=color:#ae81ff>49404</span>   <span style=color:#ae81ff>47506</span>   <span style=color:#ae81ff>61861</span>   <span style=color:#ae81ff>47628</span>
<span style=color:#ae81ff>0000160</span>      <span style=color:#ae81ff>5292</span>   <span style=color:#ae81ff>16958</span>   <span style=color:#ae81ff>38029</span>   <span style=color:#ae81ff>62234</span>   <span style=color:#ae81ff>57799</span>   <span style=color:#ae81ff>39460</span>   <span style=color:#ae81ff>43821</span>   <span style=color:#ae81ff>38391</span>
<span style=color:#ae81ff>0000200</span>
</code></pre></div><p>可以发现两者最后协商出来的密钥是完全一致的。</p><h3 id=2-ecc-加密>2. ECC 加密</h3><p>OpenSSL 中支持很多命名的曲线，先来看看支持的曲线有哪些。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>list_curves
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>  secp112r1 : SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>112</span> bit prime field
  secp112r2 : SECG curve over a <span style=color:#ae81ff>112</span> bit prime field
  secp128r1 : SECG curve over a <span style=color:#ae81ff>128</span> bit prime field
  secp128r2 : SECG curve over a <span style=color:#ae81ff>128</span> bit prime field
  secp160k1 : SECG curve over a <span style=color:#ae81ff>160</span> bit prime field
  secp160r1 : SECG curve over a <span style=color:#ae81ff>160</span> bit prime field
  secp160r2 : SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>160</span> bit prime field
  secp192k1 : SECG curve over a <span style=color:#ae81ff>192</span> bit prime field
  secp224k1 : SECG curve over a <span style=color:#ae81ff>224</span> bit prime field
  secp224r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>224</span> bit prime field
  secp256k1 : SECG curve over a <span style=color:#ae81ff>256</span> bit prime field
  secp384r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>384</span> bit prime field
  secp521r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>521</span> bit prime field
  prime192v1: NIST<span style=color:#f92672>/</span>X9<span style=color:#ae81ff>.62</span><span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>192</span> bit prime field
  prime192v2: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>192</span> bit prime field
  prime192v3: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>192</span> bit prime field
  prime239v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit prime field
  prime239v2: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit prime field
  prime239v3: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit prime field
  prime256v1: X9<span style=color:#ae81ff>.62</span><span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>256</span> bit prime field
  sect113r1 : SECG curve over a <span style=color:#ae81ff>113</span> bit binary field
  sect113r2 : SECG curve over a <span style=color:#ae81ff>113</span> bit binary field
  sect131r1 : SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>131</span> bit binary field
  sect131r2 : SECG curve over a <span style=color:#ae81ff>131</span> bit binary field
  sect163k1 : NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>163</span> bit binary field
  sect163r1 : SECG curve over a <span style=color:#ae81ff>163</span> bit binary field
  sect163r2 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>163</span> bit binary field
  sect193r1 : SECG curve over a <span style=color:#ae81ff>193</span> bit binary field
  sect193r2 : SECG curve over a <span style=color:#ae81ff>193</span> bit binary field
  sect233k1 : NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>233</span> bit binary field
  sect233r1 : NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>233</span> bit binary field
  sect239k1 : SECG curve over a <span style=color:#ae81ff>239</span> bit binary field
  sect283k1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>283</span> bit binary field
  sect283r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>283</span> bit binary field
  sect409k1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>409</span> bit binary field
  sect409r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>409</span> bit binary field
  sect571k1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>571</span> bit binary field
  sect571r1 : NIST<span style=color:#f92672>/</span>SECG curve over a <span style=color:#ae81ff>571</span> bit binary field
  c2pnb163v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>163</span> bit binary field
  c2pnb163v2: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>163</span> bit binary field
  c2pnb163v3: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>163</span> bit binary field
  c2pnb176v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>176</span> bit binary field
  c2tnb191v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>191</span> bit binary field
  c2tnb191v2: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>191</span> bit binary field
  c2tnb191v3: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>191</span> bit binary field
  c2pnb208w1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>208</span> bit binary field
  c2tnb239v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit binary field
  c2tnb239v2: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit binary field
  c2tnb239v3: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>239</span> bit binary field
  c2pnb272w1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>272</span> bit binary field
  c2pnb304w1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>304</span> bit binary field
  c2tnb359v1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>359</span> bit binary field
  c2pnb368w1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>368</span> bit binary field
  c2tnb431r1: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>431</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls1: WTLS curve over a <span style=color:#ae81ff>113</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls3: NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>163</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls4: SECG curve over a <span style=color:#ae81ff>113</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls5: X9<span style=color:#ae81ff>.62</span> curve over a <span style=color:#ae81ff>163</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls6: SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>112</span> bit prime field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls7: SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>160</span> bit prime field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls8: WTLS curve over a <span style=color:#ae81ff>112</span> bit prime field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls9: WTLS curve over a <span style=color:#ae81ff>160</span> bit prime field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls10: NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>233</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls11: NIST<span style=color:#f92672>/</span>SECG<span style=color:#f92672>/</span>WTLS curve over a <span style=color:#ae81ff>233</span> bit binary field
  wap<span style=color:#f92672>-</span>wsg<span style=color:#f92672>-</span>idm<span style=color:#f92672>-</span>ecid<span style=color:#f92672>-</span>wtls12: WTLS curve over a <span style=color:#ae81ff>224</span> bit prime field
  Oakley<span style=color:#f92672>-</span>EC2N<span style=color:#f92672>-</span><span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>
	IPSec<span style=color:#f92672>/</span>IKE<span style=color:#f92672>/</span>Oakley curve <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>3</span> over a <span style=color:#ae81ff>155</span> bit binary field.
	Not suitable <span style=color:#66d9ef>for</span> ECDSA.
	Questionable extension field<span style=color:#f92672>!</span>
  Oakley<span style=color:#f92672>-</span>EC2N<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span><span style=color:#f92672>:</span>
	IPSec<span style=color:#f92672>/</span>IKE<span style=color:#f92672>/</span>Oakley curve <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#ae81ff>4</span> over a <span style=color:#ae81ff>185</span> bit binary field.
	Not suitable <span style=color:#66d9ef>for</span> ECDSA.
	Questionable extension field<span style=color:#f92672>!</span>
  brainpoolP160r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>160</span> bit prime field
  brainpoolP160t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>160</span> bit prime field
  brainpoolP192r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>192</span> bit prime field
  brainpoolP192t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>192</span> bit prime field
  brainpoolP224r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>224</span> bit prime field
  brainpoolP224t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>224</span> bit prime field
  brainpoolP256r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>256</span> bit prime field
  brainpoolP256t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>256</span> bit prime field
  brainpoolP320r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>320</span> bit prime field
  brainpoolP320t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>320</span> bit prime field
  brainpoolP384r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>384</span> bit prime field
  brainpoolP384t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>384</span> bit prime field
  brainpoolP512r1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>512</span> bit prime field
  brainpoolP512t1: RFC <span style=color:#ae81ff>5639</span> curve over a <span style=color:#ae81ff>512</span> bit prime field
  SM2       : SM2 curve over a <span style=color:#ae81ff>256</span> bit prime field
</code></pre></div><p>生成一个参数文件，通过 -name 指定命名曲线</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>name secp256k1 <span style=color:#f92672>-</span>out secp256k1.pem

<span style=color:#75715e>// 查看参数文件，下面这句话默认只打印曲线名字
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>in secp256k1.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>ASN1 OID: secp256k1

<span style=color:#f92672>-----</span>BEGIN EC PARAMETERS<span style=color:#f92672>-----</span>
BgUrgQQACg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END EC PARAMETERS<span style=color:#f92672>-----</span>
</code></pre></div><p>显示参数文件内具体参数</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 显示参数文件内具体参数
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>in secp256k1.pem <span style=color:#f92672>-</span>text <span style=color:#f92672>-</span>param_enc explicit <span style=color:#f92672>-</span>noout
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>Field Type: prime<span style=color:#f92672>-</span>field
Prime:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:fe:ff:
    ff:fc:<span style=color:#ae81ff>2f</span>
A:    <span style=color:#ae81ff>0</span>
B:    <span style=color:#ae81ff>7</span> (<span style=color:#ae81ff>0x7</span>)
Generator (uncompressed)<span style=color:#f92672>:</span>
    <span style=color:#ae81ff>04</span><span style=color:#f92672>:</span><span style=color:#ae81ff>79</span><span style=color:#f92672>:</span>be:<span style=color:#ae81ff>66</span><span style=color:#f92672>:</span><span style=color:#ae81ff>7</span>e:f9:dc:bb:ac:<span style=color:#ae81ff>55</span><span style=color:#f92672>:</span>a0:<span style=color:#ae81ff>62</span><span style=color:#f92672>:</span><span style=color:#ae81ff>95</span><span style=color:#f92672>:</span>ce:<span style=color:#ae81ff>87</span><span style=color:#f92672>:</span>
    <span style=color:#ae81ff>0</span>b:<span style=color:#ae81ff>07</span><span style=color:#f92672>:</span><span style=color:#ae81ff>02</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>b:fc:db:<span style=color:#ae81ff>2</span>d:ce:<span style=color:#ae81ff>28</span><span style=color:#f92672>:</span>d9:<span style=color:#ae81ff>59</span><span style=color:#f92672>:</span>f2:<span style=color:#ae81ff>81</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>b:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span>
    f8:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span><span style=color:#ae81ff>98</span><span style=color:#f92672>:</span><span style=color:#ae81ff>48</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>a:da:<span style=color:#ae81ff>77</span><span style=color:#f92672>:</span><span style=color:#ae81ff>26</span><span style=color:#f92672>:</span>a3:c4:<span style=color:#ae81ff>65</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>d:a4:fb:fc:
    <span style=color:#ae81ff>0</span>e:<span style=color:#ae81ff>11</span><span style=color:#f92672>:</span><span style=color:#ae81ff>08</span><span style=color:#f92672>:</span>a8:fd:<span style=color:#ae81ff>17</span><span style=color:#f92672>:</span>b4:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span>a6:<span style=color:#ae81ff>85</span><span style=color:#f92672>:</span><span style=color:#ae81ff>54</span><span style=color:#f92672>:</span><span style=color:#ae81ff>19</span><span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>c:<span style=color:#ae81ff>47</span><span style=color:#f92672>:</span>d0:
    <span style=color:#ae81ff>8f</span><span style=color:#f92672>:</span>fb:<span style=color:#ae81ff>10</span><span style=color:#f92672>:</span>d4:b8
Order:
    <span style=color:#ae81ff>00</span><span style=color:#f92672>:</span>ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:fe:ba:ae:dc:e6:af:<span style=color:#ae81ff>48</span><span style=color:#f92672>:</span>a0:<span style=color:#ae81ff>3</span>b:bf:d2:<span style=color:#ae81ff>5</span>e:<span style=color:#ae81ff>8</span>c:d0:
    <span style=color:#ae81ff>36</span><span style=color:#f92672>:</span><span style=color:#ae81ff>41</span><span style=color:#f92672>:</span><span style=color:#ae81ff>41</span>
Cofactor:  <span style=color:#ae81ff>1</span> (<span style=color:#ae81ff>0x1</span>)
</code></pre></div><p>参数解释：</p><ul><li>A 和 B 是椭圆曲线公式参数</li><li>P 大质数，它把 ECC 所有点的大小都控制在有限域中。几乎所有的 ECC 操作都会对 P 进行取模运算</li><li>Generator 就是基点 G。由 (gx,gy) 组合</li><li>Order 相当于基点的 n。也就是基点的打点次数。大部分的 ECC 操作都不需要这个值，除了 ECDSA 在计算签名的时候会对 Order 取模，而不是对 P 取模</li><li>Cofactor 该值等于椭圆曲线上所有点总数除以 n。</li></ul><blockquote><p>在 ECC 中，k 就是私钥，g 就是基点，kg 基于公式运算最终得到公钥，通过公钥很难计算出私钥 k，其背后有复杂的数学理论，即离散对数问题。</p></blockquote><p>接下来举一个 ECDH 密钥协商的完整例子。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>// 生成参数文件
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>$</span> openssl ecparam <span style=color:#f92672>-</span>name secp256k1 <span style=color:#f92672>-</span>out secp256k1.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN EC PARAMETERS<span style=color:#f92672>-----</span>
BgUrgQQACg<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END EC PARAMETERS<span style=color:#f92672>-----</span>
</code></pre></div><p>Alice 生成 EDCH 私钥对文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>paramfile secp256k1.pem <span style=color:#f92672>-</span>out akey.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PRIVATE KEY<span style=color:#f92672>-----</span>
MIGEAgEAMBAGByqGSM49AgEGBSuBBAAKBG0wawIBAQQgXVTzOp6aEkAeC2ICiPTi
bmAZkr1RYtzprh3Larg4n<span style=color:#f92672>/</span>yhRANCAATbDBxnW<span style=color:#f92672>/</span>pTc6fS1Rk<span style=color:#f92672>/</span>bJEZZLp0fBGfn<span style=color:#f92672>+</span>H8
hYJILjrQu7ZORRlQqe<span style=color:#f92672>+</span>o2le1<span style=color:#f92672>+</span>OV2t<span style=color:#f92672>/</span>l3bEGOYAI8nvHOhT6weN<span style=color:#f92672>/</span>e
<span style=color:#f92672>-----</span>END PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Bob 生成 EDCH 私钥对文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl genpkey <span style=color:#f92672>-</span>paramfile secp256k1.pem <span style=color:#f92672>-</span>out bkey.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PRIVATE KEY<span style=color:#f92672>-----</span>
MIGEAgEAMBAGByqGSM49AgEGBSuBBAAKBG0wawIBAQQgjhUWgm7C3tcXTUcqX9RG
aHCJQ5BqF0OzCBYntGnhJwahRANCAARPI4E54N3VfbHTfcvoUXNGJrIcMHAEhj6t
TkKrpEYMCbPkM0g57C2DWcOIqvb9ImD8OYQ<span style=color:#f92672>+</span>N27LlVNhYt6ncD<span style=color:#f92672>/</span>v
<span style=color:#f92672>-----</span>END PRIVATE KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Alice 分解出公钥，将公钥发送给 Bob</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in akey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out akey_pub.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MFYwEAYHKoZIzj0CAQYFK4EEAAoDQgAE2wwcZ1v6U3On0tUZP2yRGWS6dHwRn5<span style=color:#f92672>/</span>h
<span style=color:#f92672>/</span>IWCSC460Lu2TkUZUKnvqNpXtfjldrf5d2xBjmACPJ7xzoU<span style=color:#f92672>+</span>sHjf3g<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Bob 分解出公钥，将公钥发送给 Alice</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkey <span style=color:#f92672>-</span>in bkey.pem <span style=color:#f92672>-</span>pubout <span style=color:#f92672>-</span>out bkey_pub.pem
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#f92672>-----</span>BEGIN PUBLIC KEY<span style=color:#f92672>-----</span>
MFYwEAYHKoZIzj0CAQYFK4EEAAoDQgAETyOBOeDd1X2x033L6FFzRiayHDBwBIY<span style=color:#f92672>+</span>
rU5Cq6RGDAmz5DNIOewtg1nDiKr2<span style=color:#f92672>/</span>SJg<span style=color:#f92672>/</span>DmEPjduy5VTYWLep3A<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span>w<span style=color:#f92672>==</span>
<span style=color:#f92672>-----</span>END PUBLIC KEY<span style=color:#f92672>-----</span>
</code></pre></div><p>Alice 收到 Bob 他的公钥，并将协商出来的密钥保存到 data_a.txt 中</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkeyutl <span style=color:#f92672>-</span>derive <span style=color:#f92672>-</span>inkey akey.pem <span style=color:#f92672>-</span>peerkey bkey_pub.pem <span style=color:#f92672>-</span>out data_a.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>��</span>tR<span style=color:#960050;background-color:#1e0010>�</span><span style=color:#e6db74>&#34;��g����_������]�Vn�Uɺ</span>
</code></pre></div><p>对应二进制</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> od <span style=color:#f92672>-</span>d data_a.txt

<span style=color:#ae81ff>0000000</span>     <span style=color:#ae81ff>38303</span>   <span style=color:#ae81ff>21108</span>    <span style=color:#ae81ff>8888</span>   <span style=color:#ae81ff>49924</span>   <span style=color:#ae81ff>26595</span>   <span style=color:#ae81ff>54407</span>   <span style=color:#ae81ff>63697</span>   <span style=color:#ae81ff>57439</span>
<span style=color:#ae81ff>0000020</span>     <span style=color:#ae81ff>61643</span>   <span style=color:#ae81ff>63942</span>   <span style=color:#ae81ff>37357</span>   <span style=color:#ae81ff>63837</span>   <span style=color:#ae81ff>28246</span>    <span style=color:#ae81ff>3817</span>    <span style=color:#ae81ff>5973</span>   <span style=color:#ae81ff>47817</span>
<span style=color:#ae81ff>0000040</span>
</code></pre></div><p>Bob 收到 Alice 他的公钥，并将协商出来的密钥保存到 data_b.txt 中</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> openssl pkeyutl <span style=color:#f92672>-</span>derive <span style=color:#f92672>-</span>inkey bkey.pem <span style=color:#f92672>-</span>peerkey akey_pub.pem <span style=color:#f92672>-</span>out data_b.txt
</code></pre></div><p>输出</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>��</span>tR<span style=color:#960050;background-color:#1e0010>�</span><span style=color:#e6db74>&#34;��g����_������]�Vn�Uɺ</span>
</code></pre></div><p>对应二进制</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#960050;background-color:#1e0010>$</span> od <span style=color:#f92672>-</span>d data_a.txt

<span style=color:#ae81ff>0000000</span>     <span style=color:#ae81ff>38303</span>   <span style=color:#ae81ff>21108</span>    <span style=color:#ae81ff>8888</span>   <span style=color:#ae81ff>49924</span>   <span style=color:#ae81ff>26595</span>   <span style=color:#ae81ff>54407</span>   <span style=color:#ae81ff>63697</span>   <span style=color:#ae81ff>57439</span>
<span style=color:#ae81ff>0000020</span>     <span style=color:#ae81ff>61643</span>   <span style=color:#ae81ff>63942</span>   <span style=color:#ae81ff>37357</span>   <span style=color:#ae81ff>63837</span>   <span style=color:#ae81ff>28246</span>    <span style=color:#ae81ff>3817</span>    <span style=color:#ae81ff>5973</span>   <span style=color:#ae81ff>47817</span>
<span style=color:#ae81ff>0000040</span>
</code></pre></div><p>可以发现两者最后协商出来的密钥是完全一致的</p><hr><p>Reference：</p><p>《图解密码技术》<br><a href=http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html>《RSA算法原理（一）》</a><br><a href=http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html>《RSA算法原理（二）》</a></p><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://halfrost.com/asymmetric_encryption/>https://halfrost.com/asymmetric_encryption/</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一引子>一、引子</a></li><li><a href=#二配送密钥问题>二、配送密钥问题</a><ul><li><a href=#1-事先共享密钥>1. 事先共享密钥</a></li><li><a href=#2-密钥分配中心>2. 密钥分配中心</a></li><li><a href=#3-diffie-hellman-密钥交换>3. Diffie-Hellman 密钥交换</a></li><li><a href=#4-公钥密码>4. 公钥密码</a></li></ul></li><li><a href=#三非对称加密>三、非对称加密</a></li><li><a href=#四非对称加密存在的问题>四、非对称加密存在的问题</a></li><li><a href=#五rsa-算法流程>五、RSA 算法流程</a><ul><li><a href=#1-rsa-加密>1. RSA 加密</a></li><li><a href=#2-rsa-解密>2. RSA 解密</a></li><li><a href=#3-生成密钥对>3. 生成密钥对</a></li></ul></li><li><a href=#六直接攻击-rsa>六、直接攻击 RSA</a></li><li><a href=#七间接攻击-rsa>七、间接攻击 RSA</a></li><li><a href=#八椭圆曲线加密算法>八、椭圆曲线加密算法</a><ul><li><a href=#1-椭圆曲线上的运算>1. 椭圆曲线上的运算</a></li><li><a href=#2-椭圆曲线加密实质>2. 椭圆曲线加密实质</a></li><li><a href=#3-椭圆曲线-diffie-hellman-密钥交换-ecdh>3. 椭圆曲线 Diffie-Hellman 密钥交换 (ECDH)</a></li><li><a href=#4-椭圆曲线-dsa-ecdsa>4. 椭圆曲线 DSA (ECDSA)</a></li><li><a href=#5-椭圆曲线-eigamal-密码>5. 椭圆曲线 EIGamal 密码</a></li></ul></li><li><a href=#九其他公钥加密算法>九、其他公钥加密算法</a></li><li><a href=#十混合加密系统>十、混合加密系统</a></li><li><a href=#十一openssl-中的-rsa>十一、OpenSSL 中的 RSA</a></li><li><a href=#十二openssl-中的-ecc>十二、OpenSSL 中的 ECC</a><ul><li><a href=#1-dh-密钥协商>1. DH 密钥协商</a></li><li><a href=#2-ecc-加密>2. ECC 加密</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&text=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&is_video=false&description=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&title=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&name=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95&description=%e4%b8%80%e3%80%81%e5%bc%95%e5%ad%90%20%e5%9c%a8%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%ad%ef%bc%8c%e4%be%8b%e5%a6%82%e4%b8%80%e6%ac%a1%e6%80%a7%e5%af%86%e7%a0%81%e6%9c%ac%ef%bc%8c%e5%b0%b1%e5%ad%98%e5%9c%a8%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%e5%9c%a8%20DES%e3%80%81AES%20%e4%b8%ad%e4%b9%9f%e5%ad%98%e5%9c%a8%e8%bf%99%e4%b8%aa%e9%97%ae%e9%a2%98%e3%80%82%e7%94%b1%e4%ba%8e%e5%8a%a0%e5%af%86%e5%92%8c%e8%a7%a3%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%e6%98%af%e7%9b%b8%e5%90%8c%e7%9a%84%ef%bc%8c%e6%89%80%e4%bb%a5%e5%bf%85%e9%a1%bb%e5%90%91%e6%8e%a5%e6%94%b6%e8%80%85%e9%85%8d%e9%80%81%e5%af%86%e9%92%a5%e3%80%82%e5%a6%82%e6%9e%9c%e4%bd%bf%e7%94%a8%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%ef%bc%8c%e5%88%99%e6%97%a0%e9%9c%80%e5%90%91%e6%8e%a5%e6%94%b6%e8%80%85%e9%85%8d%e9%80%81%e7%94%a8%e4%ba%8e%e8%a7%a3%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e5%8f%af%e4%bb%a5%e8%af%b4%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e6%98%af%e5%af%86%e7%a0%81%e5%ad%a6%e5%8e%86%e5%8f%b2%e4%b8%8a%e6%9c%80%e4%bc%9f%e5%a4%a7%e7%9a%84%e5%8f%91%e6%98%8e%e3%80%82%0a%e4%ba%8c%e3%80%81%e9%85%8d%e9%80%81%e5%af%86%e9%92%a5%e9%97%ae%e9%a2%98%20%e4%b8%ba%e4%ba%86%e9%98%b2%e6%ad%a2%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%88%aa%e8%8e%b7%e5%af%86%e9%92%a5%ef%bc%8c%e5%ae%89%e5%85%a8%e7%9a%84%e6%8a%8a%e5%af%86%e9%92%a5%e4%bc%a0%e9%80%92%e7%bb%99%e9%80%9a%e4%bf%a1%e5%af%b9%e6%96%b9%e3%80%82%e6%9c%89%e4%bb%a5%e4%b8%8b%204%20%e7%a7%8d%e6%96%b9%e5%bc%8f%ef%bc%9a%0a1.%20%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%20%e8%bf%99%e7%a7%8d%e6%96%b9%e6%b3%95%e8%99%bd%e7%84%b6%e6%9c%89%e6%95%88%ef%bc%8c%e4%bd%86%e6%98%af%e5%85%b7%e6%9c%89%e5%b1%80%e9%99%90%e6%80%a7%e3%80%82%e5%9c%a8%e4%b8%80%e6%ac%a1%e6%80%a7%e5%af%86%e7%a0%81%e6%9c%ac%e4%b8%ad%ef%bc%8c%e6%88%91%e4%bb%ac%e8%af%b4%e8%bf%87%ef%bc%8c%e5%a4%a7%e5%9b%bd%e4%b9%8b%e9%97%b4%e7%9a%84%e7%83%ad%e7%ba%bf%e6%98%af%e7%94%a8%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e5%8a%a0%e5%af%86%e7%9a%84%ef%bc%8c%e4%bd%86%e6%98%af%e5%af%86%e9%92%a5%e6%98%af%e9%9d%a0%e7%89%b9%e5%b7%a5%e6%8a%bc%e9%80%81%e8%bf%87%e5%8e%bb%e7%9a%84%e3%80%82%e5%a6%82%e6%9e%9c%e9%80%9a%e8%ae%af%e5%af%b9%e6%96%b9%e5%9c%a8%e9%99%84%e8%bf%91%ef%bc%8c%e6%8f%90%e5%89%8d%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e8%bf%98%e6%af%94%e8%be%83%e6%96%b9%e4%be%bf%e3%80%82%e5%a6%82%e6%9e%9c%e9%80%9a%e8%ae%af%e5%af%b9%e6%96%b9%e5%9c%a8%e4%b8%96%e7%95%8c%e5%90%84%e5%9c%b0%ef%bc%8c%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e4%b9%9f%e5%b0%b1%e5%ad%98%e5%9c%a8%e5%b1%80%e9%99%90%e6%80%a7%e4%ba%86%e3%80%82%0a%e5%8f%a6%e5%a4%96%e9%80%9a%e8%ae%af%e9%87%8f%e5%a2%9e%e5%a4%a7%e4%bb%a5%e5%90%8e%ef%bc%8c%e5%af%86%e9%92%a5%e4%b8%aa%e6%95%b0%e4%b9%9f%e4%bc%9a%e9%99%a1%e5%a2%9e%e3%80%82n%20%e4%b8%aa%e4%ba%ba%e4%b8%a4%e4%b8%a4%e9%80%9a%e8%ae%af%ef%bc%8c%e9%9c%80%e8%a6%81%20n%20%2a%20%28n-1%29%20%2f2%20%e4%b8%aa%e5%af%86%e9%92%a5%e3%80%82%e8%bf%99%e7%82%b9%e6%9d%a5%e7%9c%8b%ef%bc%8c%e4%b9%9f%e4%b8%8d%e7%8e%b0%e5%ae%9e%e3%80%82%0a2.%20%e5%af%86%e9%92%a5%e5%88%86%e9%85%8d%e4%b8%ad%e5%bf%83%20%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e7%9a%84%e5%af%86%e9%92%a5%e5%a2%9e%e5%a4%9a%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%e4%ba%8e%e6%98%af%e6%9c%89%e4%ba%ba%e6%83%b3%e5%87%ba%e4%ba%86%e5%af%86%e9%92%a5%e5%88%86%e9%85%8d%e4%b8%ad%e5%bf%83%28Key%20Distribution%20Center%2c%20KDC%29%e7%9a%84%e5%8a%9e%e6%b3%95%e3%80%82%e6%af%8f%e6%ac%a1%e5%8a%a0%e5%af%86%e7%9a%84%e5%af%86%e9%92%a5%e7%94%b1%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e8%bf%9b%e8%a1%8c%e5%88%86%e9%85%8d%ef%bc%8c%e6%af%8f%e4%b8%aa%e4%ba%ba%e5%8f%aa%e8%a6%81%e5%92%8c%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e4%ba%8b%e5%85%88%e5%85%b1%e4%ba%ab%e5%af%86%e9%92%a5%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%ba%86%e3%80%82%0a%e8%99%bd%e7%84%b6%e8%bf%99%e4%b8%aa%e6%96%b9%e6%b3%95%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e5%a2%9e%e5%a4%9a%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e4%bd%86%e6%98%af%e5%8f%88%e5%b8%a6%e6%9d%a5%e4%ba%86%e6%96%b0%e7%9a%84%e9%97%ae%e9%a2%98%e3%80%82%0a%e5%af%86%e9%92%a5%e4%b8%ad%e5%bf%83%e5%ad%98%e5%82%a8%e5%92%8c%e8%ae%b0%e5%bd%95%e4%ba%86%e6%89%80%e6%9c%89%e7%9a%84%e5%af%86%e9%92%a5%ef%bc%8c%e4%b8%80%e6%97%a6%e5%ae%83%e5%87%ba%e7%8e%b0%e6%95%85%e9%9a%9c%e6%88%96%e8%80%85%e8%a2%ab%e6%94%bb%e5%87%bb%e7%a0%b4%e5%9d%8f%ef%bc%8c%e9%82%a3%e4%b9%88%e6%89%80%e6%9c%89%e7%9a%84%e5%8a%a0%e5%af%86%e9%83%bd%e4%bc%9a%e7%98%ab%e7%97%aa%e3%80%82%e8%bf%99%e4%b9%9f%e6%98%af%e9%9b%86%e4%b8%ad%e5%bc%8f%e7%ae%a1%e7%90%86%e7%9a%84%e7%bc%ba%e7%82%b9%e3%80%82%0a3.%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%20%e4%b8%ba%e4%ba%86%e8%a7%a3%e5%86%b3%e9%9b%86%e4%b8%ad%e5%bc%8f%e7%ae%a1%e7%90%86%e7%9a%84%e7%bc%ba%e7%82%b9%ef%bc%8c%e9%82%a3%e4%b9%88%e5%ba%94%e8%af%a5%e5%af%86%e9%92%a5%e7%9a%84%e9%85%8d%e9%80%81%e8%bf%98%e6%98%af%e4%b8%8d%e8%83%bd%e7%94%a8%e9%9b%86%e4%b8%ad%e5%bc%8f%e3%80%82%e4%ba%8e%e6%98%af%e6%9c%89%e4%ba%ba%e6%83%b3%e5%87%ba%e4%ba%86%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%e7%9a%84%e6%96%b9%e6%b3%95%e3%80%82%0a%e5%9c%a8%20Diffie-Hellman%20%e5%af%86%e9%92%a5%e4%ba%a4%e6%8d%a2%e4%b8%ad%ef%bc%8c%e5%8a%a0%e5%af%86%e9%80%9a%e4%bf%a1%e5%8f%8c%e6%96%b9%e9%9c%80%e8%a6%81%e4%ba%a4%e6%8d%a2%e4%b8%80%e4%ba%9b%e4%bf%a1%e6%81%af%ef%bc%8c%e8%80%8c%e8%bf%99%e4%ba%9b%e4%bf%a1%e6%81%af%e5%8d%b3%e4%be%bf%e8%a2%ab%e7%aa%83%e5%90%ac%e8%80%85%e7%aa%83%e5%90%ac%ef%bc%8c%e4%b9%9f%e4%b8%8d%e4%bc%9a%e6%9c%89%e4%bb%bb%e4%bd%95%e9%97%ae%e9%a2%98%e3%80%82%0a%e6%a0%b9%e6%8d%ae%e4%ba%a4%e6%8d%a2%e7%9a%84%e4%bf%a1%e6%81%af%ef%bc%8c%e5%8f%8c%e6%96%b9%e5%90%84%e8%87%aa%e7%94%9f%e6%88%90%e7%9b%b8%e5%90%8c%e7%9a%84%e5%af%86%e9%92%a5%e3%80%82%e8%80%8c%e7%aa%83%e5%90%ac%e8%80%85%e6%97%a0%e6%b3%95%e7%94%9f%e6%88%90%e7%9b%b8%e5%90%8c%e7%9a%84%e5%af%86%e9%92%a5%e3%80%82%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e5%8f%af%e8%a1%8c%e3%80%82%e4%b8%8d%e8%bf%87%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e4%b8%8d%e7%ae%97%e6%98%af%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%ef%bc%8c%e5%9c%a8%e6%9c%ac%e6%96%87%e4%b8%ad%e4%b8%8d%e8%af%a6%e7%bb%86%e8%ae%a8%e8%ae%ba%e3%80%82%0a4.%20%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%20%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e6%9c%89%e4%b8%80%e4%b8%aa%e5%85%ac%e9%92%a5%e5%92%8c%e4%b8%80%e4%b8%aa%e7%a7%81%e9%92%a5%e3%80%82%e5%85%ac%e9%92%a5%e5%8f%af%e4%bb%a5%e5%9c%a8%e7%bd%91%e4%b8%8a%e4%bc%a0%e6%92%ad%ef%bc%8c%e8%a2%ab%e7%aa%83%e5%90%ac%e8%80%85%e6%8b%bf%e5%88%b0%e4%b9%9f%e6%b2%a1%e6%9c%89%e5%85%b3%e7%b3%bb%ef%bc%8c%e7%94%b1%e4%ba%8e%e6%b2%a1%e6%9c%89%e7%a7%81%e9%92%a5%ef%bc%8c%e4%bb%96%e4%b9%9f%e6%97%a0%e6%b3%95%e8%a7%a3%e5%bc%80%e5%af%86%e6%96%87%e3%80%82%e7%a7%81%e9%92%a5%e5%8f%aa%e8%a6%81%e6%8e%8c%e6%8f%a1%e5%9c%a8%e6%8e%a5%e6%94%b6%e8%80%85%e6%89%8b%e4%b8%8a%e5%b0%b1%e4%b8%8d%e4%bc%9a%e5%af%bc%e8%87%b4%e5%af%86%e6%96%87%e8%a2%ab%e7%aa%83%e5%90%ac%e3%80%82%0a%e4%b8%be%e4%b8%aa%e4%be%8b%e5%ad%90%ef%bc%9a%e8%b6%85%e5%b8%82%e9%87%8c%e9%9d%a2%e7%9a%84%e5%ad%98%e5%8c%85%e5%a4%84%ef%bc%8c%e6%89%80%e6%9c%89%e9%a1%be%e5%ae%a2%e6%9c%89%e7%a1%ac%e5%b8%81%e5%b0%b1%e5%8f%af%e4%bb%a5%e5%ad%98%e5%8c%85%e3%80%82%e7%a1%ac%e5%b8%81%e5%b0%b1%e6%98%af%e2%80%9c%e5%85%ac%e9%92%a5%e2%80%9d%ef%bc%8c%e9%a1%be%e5%ae%a2%e6%8a%8a%e5%8c%85%e6%94%be%e8%bf%9b%e7%ae%b1%e5%ad%90%e9%87%8c%ef%bc%8c%ef%bc%88%e6%98%8e%e6%96%87%e5%8a%a0%e5%af%86%ef%bc%89%ef%bc%8c%e7%ae%b1%e5%ad%90%e9%94%81%e4%b8%8a%e4%bb%a5%e5%90%8e%e5%b0%b1%e6%b2%a1%e4%ba%ba%e8%83%bd%e6%89%93%e5%bc%80%e3%80%82%e8%bf%99%e4%b8%aa%e6%97%b6%e5%80%99%e7%aa%83%e5%90%ac%e8%80%85%e4%b9%9f%e6%8b%bf%e4%b8%8d%e8%b5%b0%e5%ad%98%e8%bf%9b%e5%8e%bb%e7%9a%84%e5%8c%85%e3%80%82%e8%bf%99%e4%b8%aa%e6%98%8e%e6%96%87%ef%bc%88%e5%8c%85%ef%bc%89%ef%bc%8c%e5%8f%aa%e6%9c%89%e7%a7%81%e9%92%a5%e6%89%8d%e8%83%bd%e6%89%93%e5%bc%80%e3%80%82%e5%ae%a2%e6%88%b7%e5%ad%98%e5%ae%8c%e5%8c%85%e4%bb%a5%e5%90%8e%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%b8%aa%e7%a7%81%e9%92%a5%ef%bc%8c%e5%8f%aa%e8%a6%81%e8%bf%99%e4%b8%aa%e9%92%a5%e5%8c%99%e5%9c%a8%e6%89%8b%ef%bc%8c%e5%b0%b1%e5%8f%af%e4%bb%a5%e9%9a%8f%e6%97%b6%e5%bc%80%e7%ae%b1%e6%8b%bf%e5%8c%85%e3%80%82%0a%e4%b8%89%e3%80%81%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%20%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%80%e8%88%ac%e6%8c%87%e7%9a%84%e6%98%af%e5%85%b7%e6%9c%89%e5%85%ac%e9%92%a5%e5%af%86%e9%92%a5%28public-key%20cryptography%29%e7%9a%84%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e3%80%82%e5%af%86%e9%92%a5%e5%88%86%e4%b8%ba%e5%8a%a0%e5%af%86%e5%af%86%e9%92%a5%e5%92%8c%e8%a7%a3%e5%af%86%e5%af%86%e9%92%a5%e4%b8%a4%e7%a7%8d%e3%80%82%e5%8f%91%e9%80%81%e8%80%85%e7%94%a8%e5%8a%a0%e5%af%86%e5%af%86%e9%92%a5%e5%af%b9%e4%bf%a1%e6%81%af%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e6%8e%a5%e6%94%b6%e8%80%85%e7%94%a8%e8%a7%a3%e5%af%86%e5%af%86%e9%92%a5%e5%af%b9%e5%af%86%e6%96%87%e8%bf%9b%e8%a1%8c%e8%a7%a3%e5%af%86%e3%80%82%e5%8f%af%e4%bb%a5%e5%85%ac%e5%bc%80%e5%87%ba%e5%8e%bb%e7%9a%84%e5%8f%ab%e5%85%ac%e9%92%a5%28public%20key%29%ef%bc%8c%e4%bf%9d%e5%ad%98%e5%9c%a8%e8%87%aa%e5%b7%b1%e6%89%8b%e4%b8%8a%e4%b8%8d%e5%85%ac%e5%bc%80%e7%9a%84%e5%8f%ab%e7%a7%81%e9%92%a5%28private%20key%29%e3%80%82%0a%e5%85%ac%e9%92%a5%e5%92%8c%e7%a7%81%e9%92%a5%e6%98%af%e4%b8%80%e4%b8%80%e5%af%b9%e5%ba%94%e7%9a%84%e3%80%82%e4%b8%80%e5%af%b9%e5%85%ac%e9%92%a5%e5%92%8c%e7%a7%81%e9%92%a5%e7%bb%9f%e7%a7%b0%e4%b8%ba%e5%af%86%e9%92%a5%e5%af%b9%28key%20pair%29%e3%80%82%e5%9c%a8%e6%95%b0%e5%ad%a6%e7%9a%84%e5%85%b3%e7%b3%bb%e4%b8%8a%ef%bc%8c%e8%bf%99%e4%b8%a4%e8%80%85%e4%b8%8d%e8%83%bd%e5%8d%95%e7%8b%ac%e7%94%9f%e6%88%90%e3%80%82%0a%e5%9b%9b%e3%80%81%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e5%ad%98%e5%9c%a8%e7%9a%84%e9%97%ae%e9%a2%98%20%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e8%99%bd%e7%84%b6%e8%a7%a3%e5%86%b3%e4%ba%86%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e7%9a%84%e9%97%ae%e9%a2%98%ef%bc%8c%e4%bd%86%e6%98%af%e5%b9%b6%e4%b8%8d%e6%84%8f%e5%91%b3%e7%9d%80%e5%ae%83%e8%a7%a3%e5%86%b3%e4%ba%86%e6%89%80%e6%9c%89%e9%97%ae%e9%a2%98%e3%80%82%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e5%ad%98%e5%9c%a8%e4%bb%a5%e4%b8%8b%e5%87%a0%e4%b8%aa%e9%97%ae%e9%a2%98%ef%bc%9a%0a%20%e5%85%ac%e9%92%a5%e8%ae%a4%e8%af%81%20%e5%a4%84%e7%90%86%e9%80%9f%e5%ba%a6%e4%b8%8d%e5%88%b0%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e7%9a%84%e5%8d%81%e5%88%86%e4%b9%8b%e4%b8%80%20%20%e4%ba%94%e3%80%81RSA%20%e7%ae%97%e6%b3%95%e6%b5%81%e7%a8%8b%20RSA%20%e6%98%af%e4%b8%80%e7%a7%8d%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95%ef%bc%8c%e5%ae%83%e7%9a%84%e5%90%8d%e5%ad%97%e6%98%af%e7%94%b1%e5%ae%83%e7%9a%84%e4%b8%89%e4%bd%8d%e5%bc%80%e5%8f%91%e8%80%85%ef%bc%8c%e5%8d%b3%20Ron%20Rivest%e3%80%81Adi%20Shamir%20%e5%92%8c%20Leonard%20Adleman%20%e7%9a%84%e5%a7%93%e6%b0%8f%e7%9a%84%e9%a6%96%e5%ad%97%e6%af%8d%e7%bb%84%e6%88%90%e7%9a%84%20%28Rivest-Shamir-Adleman%29%e3%80%821983%20%e5%b9%b4%ef%bc%8cRSA%20%e5%85%ac%e5%8f%b8%e4%b8%ba%20RSA%20%e7%ae%97%e6%b3%95%e5%9c%a8%e7%be%8e%e5%9b%bd%e5%8f%96%e5%be%97%e4%ba%86%e6%9d%83%e5%88%a9%ef%bc%8c%e4%bd%86%e6%98%af%e7%8e%b0%e5%9c%a8%e8%af%a5%e4%b8%93%e5%88%a9%e5%b7%b2%e7%bb%8f%e8%bf%87%e6%9c%9f%e4%ba%86%e3%80%82%0aRSA%20%e5%8f%af%e4%bb%a5%e8%a2%ab%e7%94%a8%e4%ba%8e%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e3%80%82"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fasymmetric_encryption%2f&t=%e7%bf%b1%e6%b8%b8%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>