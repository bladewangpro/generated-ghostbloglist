<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=theme-color content="#FFFFFF"><meta http-equiv=x-ua-compatible content="IE=edge"><title>机器学习中的异常检测问题 | prometheus</title><meta name=description content="Explore in every moment of the hard thinking"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="机器学习中的异常检测问题"><meta property="og:description" content="由于 Ghost 博客对 LateX 的识别语法和标准的 LateX 语法有差异，为了更加通用性，所以以下文章中 LateX 公式可能出现乱码，如果出现乱码，不嫌弃的话可以在笔者的 Github 上看这篇无乱码的文章。笔者有空会修复这个乱码问题的。请见谅。
GitHub Repo：Halfrost-Field
Follow: halfrost · GitHub
Source: https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb
 一. Density Estimation 密度估计 假如要更为正式定义异常检测问题，首先我们有一组从 $x^{(1)}$ 到 $x^{(m)}$ m个样本，且这些样本均为正常的。我们将这些样本数据建立一个模型 p(x) ， p(x) 表示为 x 的分布概率。
那么假如我们的测试集 $x_{test}$ 概率 p 低于阈值 $\varepsilon$ ，那么则将其标记为异常。
异常检测的核心就在于找到一个概率模型，帮助我们知道一个样本落入正常样本中的概率，从而帮助我们区分正常和异常样本。高斯分布（Gaussian Distribution）模型就是异常检测算法最常使用的概率分布模型。
1. 高斯分布 假如 x 服从高斯分布，那么我们将表示为： $x\sim N(\mu,\sigma^2)$ 。其分布概率为：
$$p(x;\mu,\sigma^2)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(x-\mu)^2}{2\sigma^2})$$
其中 $\mu$ 为期望值（均值）， $\sigma^2$ 为方差。
其中，期望值 $\mu$ 决定了其轴的位置，标准差 $\sigma$ 决定了分布的幅度宽窄。当 $\mu=0,\sigma=1$ 时的正态分布是标准正态分布。
期望值：$$\mu=\frac{1}{m}\sum_{i=1}^{m}{x^{(i)}}$$
方差： $$\sigma^2=\frac{1}{m}\sum_{i=1}^{m}{(x^{(i)}-\mu)}^2$$
假如我们有一组 m 个无标签训练集，其中每个训练数据又有 n 个特征，那么这个训练集应该是 m 个 n 维向量构成的样本矩阵。"><meta property="og:type" content="article"><meta property="og:url" content="https://new.halfrost.com/anomaly_detection/"><meta property="article:published_time" content="2018-04-01T18:12:00+00:00"><meta property="article:modified_time" content="2018-04-01T18:12:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="机器学习中的异常检测问题"><meta name=twitter:description content="由于 Ghost 博客对 LateX 的识别语法和标准的 LateX 语法有差异，为了更加通用性，所以以下文章中 LateX 公式可能出现乱码，如果出现乱码，不嫌弃的话可以在笔者的 Github 上看这篇无乱码的文章。笔者有空会修复这个乱码问题的。请见谅。
GitHub Repo：Halfrost-Field
Follow: halfrost · GitHub
Source: https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb
 一. Density Estimation 密度估计 假如要更为正式定义异常检测问题，首先我们有一组从 $x^{(1)}$ 到 $x^{(m)}$ m个样本，且这些样本均为正常的。我们将这些样本数据建立一个模型 p(x) ， p(x) 表示为 x 的分布概率。
那么假如我们的测试集 $x_{test}$ 概率 p 低于阈值 $\varepsilon$ ，那么则将其标记为异常。
异常检测的核心就在于找到一个概率模型，帮助我们知道一个样本落入正常样本中的概率，从而帮助我们区分正常和异常样本。高斯分布（Gaussian Distribution）模型就是异常检测算法最常使用的概率分布模型。
1. 高斯分布 假如 x 服从高斯分布，那么我们将表示为： $x\sim N(\mu,\sigma^2)$ 。其分布概率为：
$$p(x;\mu,\sigma^2)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(x-\mu)^2}{2\sigma^2})$$
其中 $\mu$ 为期望值（均值）， $\sigma^2$ 为方差。
其中，期望值 $\mu$ 决定了其轴的位置，标准差 $\sigma$ 决定了分布的幅度宽窄。当 $\mu=0,\sigma=1$ 时的正态分布是标准正态分布。
期望值：$$\mu=\frac{1}{m}\sum_{i=1}^{m}{x^{(i)}}$$
方差： $$\sigma^2=\frac{1}{m}\sum_{i=1}^{m}{(x^{(i)}-\mu)}^2$$
假如我们有一组 m 个无标签训练集，其中每个训练数据又有 n 个特征，那么这个训练集应该是 m 个 n 维向量构成的样本矩阵。"><link rel=stylesheet href=/css/style-white.min.css><link rel=manifest href=/manifest.json><link rel=stylesheet href=/prism.css><link href=/images/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=/images/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=/images/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=/images/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=/images/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=/images/apple-touch-icon-512x512.png rel=apple-touch-icon sizes=512x512><link href=/images/apple-touch-icon-1024x1024.png rel=apple-touch-icon sizes=1024x1024><script async>if('serviceWorker'in navigator){navigator.serviceWorker.register("\/serviceworker-v1.min.a64912b78d282eab1ad3715a0943da21616e5f326f8afea27034784ad445043b.js").then(function(){if(navigator.serviceWorker.controller){console.log('Assets cached by the controlling service worker.');}else{console.log('Please reload this page to allow the service worker to handle network operations.');}}).catch(function(error){console.log('ERROR: '+error);});}else{console.log('Service workers are not supported in the current browser.');}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://new.halfrost.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-82753806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="single-max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://new.halfrost.com/dimensionality_reduction/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://new.halfrost.com/recommender_systems/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&text=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&is_video=false&description=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&name=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98&description=%e7%94%b1%e4%ba%8e%20Ghost%20%e5%8d%9a%e5%ae%a2%e5%af%b9%20LateX%20%e7%9a%84%e8%af%86%e5%88%ab%e8%af%ad%e6%b3%95%e5%92%8c%e6%a0%87%e5%87%86%e7%9a%84%20LateX%20%e8%af%ad%e6%b3%95%e6%9c%89%e5%b7%ae%e5%bc%82%ef%bc%8c%e4%b8%ba%e4%ba%86%e6%9b%b4%e5%8a%a0%e9%80%9a%e7%94%a8%e6%80%a7%ef%bc%8c%e6%89%80%e4%bb%a5%e4%bb%a5%e4%b8%8b%e6%96%87%e7%ab%a0%e4%b8%ad%20LateX%20%e5%85%ac%e5%bc%8f%e5%8f%af%e8%83%bd%e5%87%ba%e7%8e%b0%e4%b9%b1%e7%a0%81%ef%bc%8c%e5%a6%82%e6%9e%9c%e5%87%ba%e7%8e%b0%e4%b9%b1%e7%a0%81%ef%bc%8c%e4%b8%8d%e5%ab%8c%e5%bc%83%e7%9a%84%e8%af%9d%e5%8f%af%e4%bb%a5%e5%9c%a8%e7%ac%94%e8%80%85%e7%9a%84%20Github%20%e4%b8%8a%e7%9c%8b%e8%bf%99%e7%af%87%e6%97%a0%e4%b9%b1%e7%a0%81%e7%9a%84%e6%96%87%e7%ab%a0%e3%80%82%e7%ac%94%e8%80%85%e6%9c%89%e7%a9%ba%e4%bc%9a%e4%bf%ae%e5%a4%8d%e8%bf%99%e4%b8%aa%e4%b9%b1%e7%a0%81%e9%97%ae%e9%a2%98%e7%9a%84%e3%80%82%e8%af%b7%e8%a7%81%e8%b0%85%e3%80%82%0aGitHub%20Repo%ef%bc%9aHalfrost-Field%0aFollow%3a%20halfrost%20%c2%b7%20GitHub%0aSource%3a%20https%3a%2f%2fgithub.com%2fhalfrost%2fHalfrost-Field%2fblob%2fmaster%2fcontents%2fMachine_Learning%2fAnomaly_Detection.ipynb%0a%20%e4%b8%80.%20Density%20Estimation%20%e5%af%86%e5%ba%a6%e4%bc%b0%e8%ae%a1%20%e5%81%87%e5%a6%82%e8%a6%81%e6%9b%b4%e4%b8%ba%e6%ad%a3%e5%bc%8f%e5%ae%9a%e4%b9%89%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98%ef%bc%8c%e9%a6%96%e5%85%88%e6%88%91%e4%bb%ac%e6%9c%89%e4%b8%80%e7%bb%84%e4%bb%8e%20%24x%5e%7b%281%29%7d%24%20%e5%88%b0%20%24x%5e%7b%28m%29%7d%24%20m%e4%b8%aa%e6%a0%b7%e6%9c%ac%ef%bc%8c%e4%b8%94%e8%bf%99%e4%ba%9b%e6%a0%b7%e6%9c%ac%e5%9d%87%e4%b8%ba%e6%ad%a3%e5%b8%b8%e7%9a%84%e3%80%82%e6%88%91%e4%bb%ac%e5%b0%86%e8%bf%99%e4%ba%9b%e6%a0%b7%e6%9c%ac%e6%95%b0%e6%8d%ae%e5%bb%ba%e7%ab%8b%e4%b8%80%e4%b8%aa%e6%a8%a1%e5%9e%8b%20p%28x%29%20%ef%bc%8c%20p%28x%29%20%e8%a1%a8%e7%a4%ba%e4%b8%ba%20x%20%e7%9a%84%e5%88%86%e5%b8%83%e6%a6%82%e7%8e%87%e3%80%82%0a%e9%82%a3%e4%b9%88%e5%81%87%e5%a6%82%e6%88%91%e4%bb%ac%e7%9a%84%e6%b5%8b%e8%af%95%e9%9b%86%20%24x_%7btest%7d%24%20%e6%a6%82%e7%8e%87%20p%20%e4%bd%8e%e4%ba%8e%e9%98%88%e5%80%bc%20%24%5cvarepsilon%24%20%ef%bc%8c%e9%82%a3%e4%b9%88%e5%88%99%e5%b0%86%e5%85%b6%e6%a0%87%e8%ae%b0%e4%b8%ba%e5%bc%82%e5%b8%b8%e3%80%82%0a%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e7%9a%84%e6%a0%b8%e5%bf%83%e5%b0%b1%e5%9c%a8%e4%ba%8e%e6%89%be%e5%88%b0%e4%b8%80%e4%b8%aa%e6%a6%82%e7%8e%87%e6%a8%a1%e5%9e%8b%ef%bc%8c%e5%b8%ae%e5%8a%a9%e6%88%91%e4%bb%ac%e7%9f%a5%e9%81%93%e4%b8%80%e4%b8%aa%e6%a0%b7%e6%9c%ac%e8%90%bd%e5%85%a5%e6%ad%a3%e5%b8%b8%e6%a0%b7%e6%9c%ac%e4%b8%ad%e7%9a%84%e6%a6%82%e7%8e%87%ef%bc%8c%e4%bb%8e%e8%80%8c%e5%b8%ae%e5%8a%a9%e6%88%91%e4%bb%ac%e5%8c%ba%e5%88%86%e6%ad%a3%e5%b8%b8%e5%92%8c%e5%bc%82%e5%b8%b8%e6%a0%b7%e6%9c%ac%e3%80%82%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%ef%bc%88Gaussian%20Distribution%ef%bc%89%e6%a8%a1%e5%9e%8b%e5%b0%b1%e6%98%af%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e7%ae%97%e6%b3%95%e6%9c%80%e5%b8%b8%e4%bd%bf%e7%94%a8%e7%9a%84%e6%a6%82%e7%8e%87%e5%88%86%e5%b8%83%e6%a8%a1%e5%9e%8b%e3%80%82%0a1.%20%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%20%e5%81%87%e5%a6%82%20x%20%e6%9c%8d%e4%bb%8e%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%ef%bc%8c%e9%82%a3%e4%b9%88%e6%88%91%e4%bb%ac%e5%b0%86%e8%a1%a8%e7%a4%ba%e4%b8%ba%ef%bc%9a%20%24x%5csim%20N%28%5cmu%2c%5csigma%5e2%29%24%20%e3%80%82%e5%85%b6%e5%88%86%e5%b8%83%e6%a6%82%e7%8e%87%e4%b8%ba%ef%bc%9a%0a%24%24p%28x%3b%5cmu%2c%5csigma%5e2%29%3d%5cfrac%7b1%7d%7b%5csqrt%7b2%5cpi%7d%5csigma%7dexp%28-%5cfrac%7b%28x-%5cmu%29%5e2%7d%7b2%5csigma%5e2%7d%29%24%24%0a%e5%85%b6%e4%b8%ad%20%24%5cmu%24%20%e4%b8%ba%e6%9c%9f%e6%9c%9b%e5%80%bc%ef%bc%88%e5%9d%87%e5%80%bc%ef%bc%89%ef%bc%8c%20%24%5csigma%5e2%24%20%e4%b8%ba%e6%96%b9%e5%b7%ae%e3%80%82%0a%e5%85%b6%e4%b8%ad%ef%bc%8c%e6%9c%9f%e6%9c%9b%e5%80%bc%20%24%5cmu%24%20%e5%86%b3%e5%ae%9a%e4%ba%86%e5%85%b6%e8%bd%b4%e7%9a%84%e4%bd%8d%e7%bd%ae%ef%bc%8c%e6%a0%87%e5%87%86%e5%b7%ae%20%24%5csigma%24%20%e5%86%b3%e5%ae%9a%e4%ba%86%e5%88%86%e5%b8%83%e7%9a%84%e5%b9%85%e5%ba%a6%e5%ae%bd%e7%aa%84%e3%80%82%e5%bd%93%20%24%5cmu%3d0%2c%5csigma%3d1%24%20%e6%97%b6%e7%9a%84%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e6%98%af%e6%a0%87%e5%87%86%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e3%80%82%0a%e6%9c%9f%e6%9c%9b%e5%80%bc%ef%bc%9a%24%24%5cmu%3d%5cfrac%7b1%7d%7bm%7d%5csum_%7bi%3d1%7d%5e%7bm%7d%7bx%5e%7b%28i%29%7d%7d%24%24%0a%e6%96%b9%e5%b7%ae%ef%bc%9a%20%24%24%5csigma%5e2%3d%5cfrac%7b1%7d%7bm%7d%5csum_%7bi%3d1%7d%5e%7bm%7d%7b%28x%5e%7b%28i%29%7d-%5cmu%29%7d%5e2%24%24%0a%e5%81%87%e5%a6%82%e6%88%91%e4%bb%ac%e6%9c%89%e4%b8%80%e7%bb%84%20m%20%e4%b8%aa%e6%97%a0%e6%a0%87%e7%ad%be%e8%ae%ad%e7%bb%83%e9%9b%86%ef%bc%8c%e5%85%b6%e4%b8%ad%e6%af%8f%e4%b8%aa%e8%ae%ad%e7%bb%83%e6%95%b0%e6%8d%ae%e5%8f%88%e6%9c%89%20n%20%e4%b8%aa%e7%89%b9%e5%be%81%ef%bc%8c%e9%82%a3%e4%b9%88%e8%bf%99%e4%b8%aa%e8%ae%ad%e7%bb%83%e9%9b%86%e5%ba%94%e8%af%a5%e6%98%af%20m%20%e4%b8%aa%20n%20%e7%bb%b4%e5%90%91%e9%87%8f%e6%9e%84%e6%88%90%e7%9a%84%e6%a0%b7%e6%9c%ac%e7%9f%a9%e9%98%b5%e3%80%82"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&t=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#一-density-estimation-密度估计>一. Density Estimation 密度估计</a><ul><li><a href=#1-高斯分布>1. 高斯分布</a></li><li><a href=#2-举例>2. 举例</a></li><li><a href=#3-算法评估>3. 算法评估</a></li></ul></li><li><a href=#二-building-an-anomaly-detection-system>二. Building an Anomaly Detection System</a><ul><li><a href=#1-有监督学习与异常检测>1. 有监督学习与异常检测</a></li></ul></li><li><a href=#三-multivariate-gaussian-distribution-optional>三. Multivariate Gaussian Distribution (Optional)</a><ul><li><a href=#1-多元高斯分布模型>1. 多元高斯分布模型</a></li><li><a href=#2-参数估计>2. 参数估计</a></li><li><a href=#3-算法流程>3. 算法流程</a></li><li><a href=#4-多元高斯分布模型与一般高斯分布模型的差异>4. 多元高斯分布模型与一般高斯分布模型的差异</a></li><li><a href=#模型定义>模型定义</a></li><li><a href=#相关性>相关性</a></li><li><a href=#复杂度>复杂度</a></li><li><a href=#效果>效果</a></li></ul></li><li><a href=#四-anomaly-detection-测试>四. Anomaly Detection 测试</a><ul><li><a href=#1-question-1>1. Question 1</a></li><li><a href=#2-question-2>2. Question 2</a></li><li><a href=#3-question-3>3. Question 3</a></li><li><a href=#4-question-4>4. Question 4</a></li><li><a href=#5-question-5>5. Question 5</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">机器学习中的异常检测问题</h1><div class=meta><div class=postdate><time datetime="2018-04-01 18:12:00 +0000 UTC" itemprop=datePublished>Apr 01</time></div><div class=article-category><i class="fas fa-archive"></i><a class=category-link href=/categories/machine-learning>Machine Learning</a>
,
<a class=category-link href=/categories/ai>AI</a></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/machine-learning rel=tag>Machine Learning</a>
,
<a class=tag-link href=/tags/ai rel=tag>AI</a></div></div></header><div class=content itemprop=articleBody><blockquote><p>由于 Ghost 博客对 LateX 的识别语法和标准的 LateX 语法有差异，为了更加通用性，所以以下文章中 LateX 公式可能出现乱码，如果出现乱码，不嫌弃的话可以在笔者的 <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/contents.md>Github</a> 上看这篇无乱码的文章。笔者有空会修复这个乱码问题的。请见谅。</p><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a><br>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a><br>Source: <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb>https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb</a></p></blockquote><h2 id=一-density-estimation-密度估计>一. Density Estimation 密度估计</h2><p>假如要更为正式定义异常检测问题，首先我们有一组从 $x^{(1)}$ 到 $x^{(m)}$ m个样本，且这些样本均为正常的。我们将这些样本数据建立一个模型 p(x) ， p(x) 表示为 x 的分布概率。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_1.png alt></p><p>那么假如我们的测试集 $x_{test}$ 概率 p 低于阈值 $\varepsilon$ ，那么则将其标记为异常。</p><p>异常检测的核心就在于找到一个概率模型，帮助我们知道一个样本落入正常样本中的概率，从而帮助我们区分正常和异常样本。高斯分布（Gaussian Distribution）模型就是异常检测算法最常使用的概率分布模型。</p><h3 id=1-高斯分布>1. 高斯分布</h3><p>假如 x 服从高斯分布，那么我们将表示为： $x\sim N(\mu,\sigma^2)$ 。其分布概率为：</p><p>$$p(x;\mu,\sigma^2)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(x-\mu)^2}{2\sigma^2})$$</p><p>其中 $\mu$ 为期望值（均值）， $\sigma^2$ 为方差。</p><p>其中，期望值 $\mu$ 决定了其轴的位置，标准差 $\sigma$ 决定了分布的幅度宽窄。当 $\mu=0,\sigma=1$ 时的正态分布是标准正态分布。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_2.png alt></p><p>期望值：$$\mu=\frac{1}{m}\sum_{i=1}^{m}{x^{(i)}}$$</p><p>方差： $$\sigma^2=\frac{1}{m}\sum_{i=1}^{m}{(x^{(i)}-\mu)}^2$$</p><p>假如我们有一组 m 个无标签训练集，其中每个训练数据又有 n 个特征，那么这个训练集应该是 m 个 n 维向量构成的样本矩阵。</p><p>在概率论中，对有限个样本进行参数估计</p><p>$$\mu_j = \frac{1}{m} \sum_{i=1}^{m}x_j^{(i)};;;,;;; \delta^2_j = \frac{1}{m} \sum_{i=1}^{m}(x_j^{(i)}-\mu_j)^2$$</p><p>这里对参数 $\mu$ 和参数 $\delta^2$ 的估计就是二者的极大似然估计。</p><p>假定每一个特征 $x_{1}$ 到 $x_{n}$ 均服从正态分布，则其模型的概率为：</p><p>$$
\begin{align*}
p(x)&=p(x_1;\mu_1,\sigma_1^2)p(x_2;\mu_2,\sigma_2^2) \cdots p(x_n;\mu_n,\sigma_n^2)\<br>&=\prod_{j=1}^{n}p(x_j;\mu_j,\sigma_j^2)\<br>&=\prod_{j=1}^{n} \frac{1}{\sqrt{2\pi}\sigma_{j}}exp(-\frac{(x_{j}-\mu_{j})^2}{2\sigma_{j}^2})
\end{align*}
$$</p><p>当 $p(x)&lt;\varepsilon$时，$x$ 为异常样本。</p><h3 id=2-举例>2. 举例</h3><p>假定我们有两个特征 $x_1$ 、 $x_2$ ，它们都服从于高斯分布，并且通过参数估计，我们知道了分布参数：</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_3.png alt></p><p>则模型 $p(x)$ 能由如下的热力图反映，热力图越热的地方，是正常样本的概率越高，参数 $\varepsilon$ 描述了一个截断高度，当概率落到了截断高度以下（下图紫色区域所示），则为异常样本：</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_4.png alt></p><p>将 $p(x)$ 投影到特征 $x_1$ 、$x_2$ 所在平面，下图紫色曲线就反映了 $\varepsilon$ 的投影，它是一条截断曲线，落在截断曲线以外的样本，都会被认为是异常样本：</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_5.png alt></p><h3 id=3-算法评估>3. 算法评估</h3><p>由于异常样本是非常少的，所以整个数据集是非常偏斜的，我们不能单纯的用预测准确率来评估算法优劣，所以用我们之前的查准率（Precision）和召回率（Recall）计算出 F 值进行衡量异常检测算法了。</p><ul><li>真阳性、假阳性、真阴性、假阴性</li><li>查准率（Precision）与 召回率（Recall）</li><li>F1 Score</li></ul><p>我们还有一个参数 $\varepsilon$ ，这个 $\varepsilon$ 是我们用来决定什么时候把一个样本当做是异常样本的阈值。我们应该试用多个不同的 $\varepsilon$ 值，选取一个使得 F 值最大的那个 $\varepsilon$ 。</p><hr><h2 id=二-building-an-anomaly-detection-system>二. Building an Anomaly Detection System</h2><h3 id=1-有监督学习与异常检测>1. 有监督学习与异常检测</h3><table><thead><tr><th align=center>有监督学习</th><th align=center>异常检测</th></tr></thead><tbody><tr><td align=center>数据分布均匀</td><td align=center>数据非常偏斜，异常样本数目远小于正常样本数目</td></tr><tr><td align=center>可以根据对正样本的拟合来知道正样本的形态，从而预测新来的样本是否是正样本</td><td align=center>异常的类型不一，很难根据对现有的异常样本（即正样本）的拟合来判断出异常样本的形态</td></tr></tbody></table><p>下面的表格则展示了二者的一些应用场景：</p><table><thead><tr><th align=center>有监督学习</th><th align=center>异常检测</th></tr></thead><tbody><tr><td align=center>垃圾邮件检测</td><td align=center>故障检测</td></tr><tr><td align=center>天气预测（预测雨天、晴天、或是多云天气）</td><td align=center>某数据中心对于机器设备的监控</td></tr><tr><td align=center>癌症的分类</td><td align=center>制造业判断一个零部件是否异常</td></tr></tbody></table><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_6.png alt></p><p>假如我们的数据看起来不是很服从高斯分布，可以通过对数、指数、幂等数学变换让其接近于高斯分布。</p><hr><h2 id=三-multivariate-gaussian-distribution-optional>三. Multivariate Gaussian Distribution (Optional)</h2><h3 id=1-多元高斯分布模型>1. 多元高斯分布模型</h3><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_7.png alt></p><p>我们以数据中心的监控计算机为例子。 $x_1$ 是CPU的负载，$x_2$ 是内存的使用量。其正常样本如左图红色点所示。假如我们有一个异常的样本（图中左上角绿色点），在图中看很明显它并不是正常样本所在的范围。但是在计算概率 $p(x)$ 的时候，因为它在 $x_1$ 和 $x_2$ 的高斯分布都属于正常范围，所以该点并不会被判断为异常点。</p><p>这是因为在高斯分布中，它并不能察觉在蓝色椭圆处才是正常样本概率高的范围，其概率是通过圆圈逐渐向外减小。所以在同一个圆圈内，虽然在计算中概率是一样的，但是在实际上却往往有很大偏差。</p><p>所以我们开发了一种改良版的异常检测算法：多元高斯分布。</p><p>我们不将每一个特征值都分开进行高斯分布的计算，而是作为整个模型进行高斯分布的拟合。</p><p>其概率模型为： $$p(x;\mu,\Sigma)=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}exp(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu))$$ （其中 $|\Sigma|$ 是 $\Sigma$ 的行列式，$\mu$ 表示样本均值，$\Sigma$ 表示样本协方差矩阵。）。</p><p>多元高斯分布模型的热力图如下：</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_8.png alt></p><p>$\Sigma$ 是一个协方差矩阵，所以它衡量的是方差。减小 $\Sigma$ 其宽度也随之减少，增大反之。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_9.png alt></p><p>$\Sigma$ 中第一个数字是衡量 $x_1$ 的，假如减少第一个数字，则可从图中观察到 $x_1$ 的范围也随之被压缩，变成了一个椭圆。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_10.png alt></p><p>多元高斯分布还可以给数据的相关性建立模型。假如我们在非主对角线上改变数据（如图中间那副），则其图像会根据 $y=x$ 这条直线上进行高斯分布。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_11.png alt></p><p>反之亦然。</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_12.png alt></p><p>改变 $\mu$ 的值则是改变其中心点的位置。</p><h3 id=2-参数估计>2. 参数估计</h3><p>多元高斯分布模型的参数估计如下：</p><p>$$\mu=\frac{1}{m}\sum_{i=1}^{m}{x^{(i)}}$$</p><p>$$\Sigma=\frac{1}{m}\sum_{i=1}^{m}{(x^{(i)}-\mu)(x^{(i)}-\mu)^T}$$</p><h3 id=3-算法流程>3. 算法流程</h3><p>采用了多元高斯分布的异常检测算法流程如下：</p><ol><li>选择一些足够反映异常样本的特征 $x_j$ 。</li><li>对各个样本进行参数估计：
$$\mu=\frac{1}{m}\sum_{i=1}^{m}{x^{(i)}}$$
$$\Sigma=\frac{1}{m}\sum_{i=1}^{m}{(x^{(i)}-\mu)(x^{(i)}-\mu)^T}$$</li><li>当新的样本 x 到来时，计算 $p(x)$ ：</li></ol><p>$$p(x)=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}exp(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu))$$</p><p>如果 $p(x)&lt;\varepsilon $ ，则认为样本 x 是异常样本。</p><h3 id=4-多元高斯分布模型与一般高斯分布模型的差异>4. 多元高斯分布模型与一般高斯分布模型的差异</h3><p>一般的高斯分布模型只是多元高斯分布模型的一个约束，它将多元高斯分布的等高线约束到了如下所示同轴分布（概率密度的等高线是沿着轴向的）：</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/79_13.png alt></p><p>当： $\Sigma=\left[ \begin{array}{ccc}\sigma_1^2 \ & \sigma_2^2 \ &&…\&&&\sigma_n^2\end{array} \right]$ 的时候，此时的多元高斯分布即是原来的多元高斯分布。（因为只有主对角线方差，并没有其它斜率的变化）</p><p>对比</p><h3 id=模型定义>模型定义</h3><p>一般高斯模型：</p><p>$$
\begin{align*}
p(x)&=p(x_1;\mu_1,\sigma_1^2)p(x_2;\mu_2,\sigma_2^2) \cdots p(x_n;\mu_n,\sigma_n^2)\<br>&=\prod_{j=1}^{n}p(x_j;\mu_j,\sigma_j^2)\<br>&=\prod_{j=1}^{n} \frac{1}{\sqrt{2\pi}\sigma_{j}}exp(-\frac{(x_{j}-\mu_{j})^2}{2\sigma_{j}^2})
\end{align*}
$$</p><p>多元高斯模型：</p><p>$$p(x)=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}exp(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu))$$</p><h3 id=相关性>相关性</h3><p>一般高斯模型：</p><p>需要手动创建一些特征来描述某些特征的相关性</p><p>多元高斯模型：</p><p>利用协方差矩阵$\Sigma$获得了各个特征相关性</p><h3 id=复杂度>复杂度</h3><p>一般高斯模型：</p><p>计算复杂度低，适用于高维特征</p><p>多元高斯模型：</p><p>计算复杂</p><h3 id=效果>效果</h3><p>一般高斯模型：</p><p>在样本数目 m 较小时也工作良好</p><p>多元高斯模型：</p><p>需要 $\Sigma$ 可逆，亦即需要 $m>n$ ，且各个特征不能线性相关，如不能存在 $x_2=3x_1$ 或者 $x_3=x_1+2x_2$</p><p>结论：<strong>基于多元高斯分布模型的异常检测应用十分有限</strong>。</p><hr><h2 id=四-anomaly-detection-测试>四. Anomaly Detection 测试</h2><h3 id=1-question-1>1. Question 1</h3><p>For which of the following problems would anomaly detection be a suitable algorithm?</p><p>A. Given a dataset of credit card transactions, identify unusual transactions to flag them as possibly fraudulent.</p><p>B. Given data from credit card transactions, classify each transaction according to type of purchase (for example: food, transportation, clothing).</p><p>C. Given an image of a face, determine whether or not it is the face of a particular famous individual.</p><p>D. From a large set of primary care patient records, identify individuals who might have unusual health conditions.</p><p>解答：A、D</p><p>A、D 才适合异常检测算法。</p><h3 id=2-question-2>2. Question 2</h3><p>Suppose you have trained an anomaly detection system for fraud detection, and your system that flags anomalies when $p(x)$ is less than ε, and you find on the cross-validation set that it is missing many fradulent transactions (i.e., failing to flag them as anomalies). What should you do?</p><p>A. Decrease $\varepsilon$</p><p>B. Increase $\varepsilon$</p><p>解答：B</p><h3 id=3-question-3>3. Question 3</h3><p>Suppose you are developing an anomaly detection system to catch manufacturing defects in airplane engines. You model uses</p><p>$$p(x) = \prod_{j=1}^{n}p(x_{j};\mu_{j},\sigma_{j}^{2})$$</p><p>You have two features $x_1$ = vibration intensity, and $x_2$ = heat generated. Both $x_1$ and $x_2$ take on values between 0 and 1 (and are strictly greater than 0), and for most &ldquo;normal&rdquo; engines you expect that $x_1 \approx x_2$. One of the suspected anomalies is that a flawed engine may vibrate very intensely even without generating much heat (large $x_1$, small $x_2$), even though the particular values of $x_1$ and $x_2$ may not fall outside their typical ranges of values. What additional feature $x_3$ should you create to capture these types of anomalies:</p><p>A. $x_3 = \frac{x_1}{x_2}$</p><p>B. $x_3 = x_1^2\times x_2^2$</p><p>C. $x_3 = (x_1 + x_2)^2$</p><p>D. $x_3 = x_1 \times x_2^2$</p><p>解答：A</p><p>假如特征量 $x_1$ 和 $x_2$ ，可建立特征量 $x_3=\frac{x_1}{x_2}$ 结合两者。</p><h3 id=4-question-4>4. Question 4</h3><p>Which of the following are true? Check all that apply.</p><p>A. When evaluating an anomaly detection algorithm on the cross validation set (containing some positive and some negative examples), classification accuracy is usually a good evaluation metric to use.</p><p>B. When developing an anomaly detection system, it is often useful to select an appropriate numerical performance metric to evaluate the effectiveness of the learning algorithm.</p><p>C. In a typical anomaly detection setting, we have a large number of anomalous examples, and a relatively small number of normal/non-anomalous examples.</p><p>D. In anomaly detection, we fit a model p(x) to a set of negative (y=0) examples, without using any positive examples we may have collected of previously observed anomalies.</p><p>解答：B、D</p><h3 id=5-question-5>5. Question 5</h3><p>You have a 1-D dataset $\begin{Bmatrix}
x^{(i)},\cdots,x^{(m)}
\end{Bmatrix}$ and you want to detect outliers in the dataset. You first plot the dataset and it looks like this:</p><p><img src=https://img.halfrost.com/Blog/ArticleImage/7X_5.png alt></p><p>Suppose you fit the gaussian distribution parameters $\mu_1$ and $\sigma_1^2$ to this dataset. Which of the following values for $\mu_1$ and $\sigma_1^2$ might you get?</p><p>A. $\mu = -3$,$\sigma_1^2 = 4$</p><p>B. $\mu = -6$,$\sigma_1^2 = 4$</p><p>C. $\mu = -3$,$\sigma_1^2 = 2$</p><p>D. $\mu = -6$,$\sigma_1^2 = 2$</p><p>解答：A</p><p>中心点在-3，在-3周围即（-4，-2）周围仍比较密集，所以 $\sigma_1=2$ 。</p><hr><blockquote><p>GitHub Repo：<a href=https://github.com/halfrost/Halfrost-Field>Halfrost-Field</a></p><p>Follow: <a href=https://github.com/halfrost>halfrost · GitHub</a></p><p>Source: <a href=https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb>https://github.com/halfrost/Halfrost-Field/blob/master/contents/Machine_Learning/Anomaly_Detection.ipynb</a></p></blockquote><img src=https://img.halfrost.com/wechat-qr-code.png></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=https://books.halfrost.com/>Books</a></li><li><a href=https://github.com/halfrost/Halfrost-Field>Github</a></li><li><a href=https://halfrost.me/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#一-density-estimation-密度估计>一. Density Estimation 密度估计</a><ul><li><a href=#1-高斯分布>1. 高斯分布</a></li><li><a href=#2-举例>2. 举例</a></li><li><a href=#3-算法评估>3. 算法评估</a></li></ul></li><li><a href=#二-building-an-anomaly-detection-system>二. Building an Anomaly Detection System</a><ul><li><a href=#1-有监督学习与异常检测>1. 有监督学习与异常检测</a></li></ul></li><li><a href=#三-multivariate-gaussian-distribution-optional>三. Multivariate Gaussian Distribution (Optional)</a><ul><li><a href=#1-多元高斯分布模型>1. 多元高斯分布模型</a></li><li><a href=#2-参数估计>2. 参数估计</a></li><li><a href=#3-算法流程>3. 算法流程</a></li><li><a href=#4-多元高斯分布模型与一般高斯分布模型的差异>4. 多元高斯分布模型与一般高斯分布模型的差异</a></li><li><a href=#模型定义>模型定义</a></li><li><a href=#相关性>相关性</a></li><li><a href=#复杂度>复杂度</a></li><li><a href=#效果>效果</a></li></ul></li><li><a href=#四-anomaly-detection-测试>四. Anomaly Detection 测试</a><ul><li><a href=#1-question-1>1. Question 1</a></li><li><a href=#2-question-2>2. Question 2</a></li><li><a href=#3-question-3>3. Question 3</a></li><li><a href=#4-question-4>4. Question 4</a></li><li><a href=#5-question-5>5. Question 5</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&text=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&is_video=false&description=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98&body=Check out this article: https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&title=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&name=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98&description=%e7%94%b1%e4%ba%8e%20Ghost%20%e5%8d%9a%e5%ae%a2%e5%af%b9%20LateX%20%e7%9a%84%e8%af%86%e5%88%ab%e8%af%ad%e6%b3%95%e5%92%8c%e6%a0%87%e5%87%86%e7%9a%84%20LateX%20%e8%af%ad%e6%b3%95%e6%9c%89%e5%b7%ae%e5%bc%82%ef%bc%8c%e4%b8%ba%e4%ba%86%e6%9b%b4%e5%8a%a0%e9%80%9a%e7%94%a8%e6%80%a7%ef%bc%8c%e6%89%80%e4%bb%a5%e4%bb%a5%e4%b8%8b%e6%96%87%e7%ab%a0%e4%b8%ad%20LateX%20%e5%85%ac%e5%bc%8f%e5%8f%af%e8%83%bd%e5%87%ba%e7%8e%b0%e4%b9%b1%e7%a0%81%ef%bc%8c%e5%a6%82%e6%9e%9c%e5%87%ba%e7%8e%b0%e4%b9%b1%e7%a0%81%ef%bc%8c%e4%b8%8d%e5%ab%8c%e5%bc%83%e7%9a%84%e8%af%9d%e5%8f%af%e4%bb%a5%e5%9c%a8%e7%ac%94%e8%80%85%e7%9a%84%20Github%20%e4%b8%8a%e7%9c%8b%e8%bf%99%e7%af%87%e6%97%a0%e4%b9%b1%e7%a0%81%e7%9a%84%e6%96%87%e7%ab%a0%e3%80%82%e7%ac%94%e8%80%85%e6%9c%89%e7%a9%ba%e4%bc%9a%e4%bf%ae%e5%a4%8d%e8%bf%99%e4%b8%aa%e4%b9%b1%e7%a0%81%e9%97%ae%e9%a2%98%e7%9a%84%e3%80%82%e8%af%b7%e8%a7%81%e8%b0%85%e3%80%82%0aGitHub%20Repo%ef%bc%9aHalfrost-Field%0aFollow%3a%20halfrost%20%c2%b7%20GitHub%0aSource%3a%20https%3a%2f%2fgithub.com%2fhalfrost%2fHalfrost-Field%2fblob%2fmaster%2fcontents%2fMachine_Learning%2fAnomaly_Detection.ipynb%0a%20%e4%b8%80.%20Density%20Estimation%20%e5%af%86%e5%ba%a6%e4%bc%b0%e8%ae%a1%20%e5%81%87%e5%a6%82%e8%a6%81%e6%9b%b4%e4%b8%ba%e6%ad%a3%e5%bc%8f%e5%ae%9a%e4%b9%89%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98%ef%bc%8c%e9%a6%96%e5%85%88%e6%88%91%e4%bb%ac%e6%9c%89%e4%b8%80%e7%bb%84%e4%bb%8e%20%24x%5e%7b%281%29%7d%24%20%e5%88%b0%20%24x%5e%7b%28m%29%7d%24%20m%e4%b8%aa%e6%a0%b7%e6%9c%ac%ef%bc%8c%e4%b8%94%e8%bf%99%e4%ba%9b%e6%a0%b7%e6%9c%ac%e5%9d%87%e4%b8%ba%e6%ad%a3%e5%b8%b8%e7%9a%84%e3%80%82%e6%88%91%e4%bb%ac%e5%b0%86%e8%bf%99%e4%ba%9b%e6%a0%b7%e6%9c%ac%e6%95%b0%e6%8d%ae%e5%bb%ba%e7%ab%8b%e4%b8%80%e4%b8%aa%e6%a8%a1%e5%9e%8b%20p%28x%29%20%ef%bc%8c%20p%28x%29%20%e8%a1%a8%e7%a4%ba%e4%b8%ba%20x%20%e7%9a%84%e5%88%86%e5%b8%83%e6%a6%82%e7%8e%87%e3%80%82%0a%e9%82%a3%e4%b9%88%e5%81%87%e5%a6%82%e6%88%91%e4%bb%ac%e7%9a%84%e6%b5%8b%e8%af%95%e9%9b%86%20%24x_%7btest%7d%24%20%e6%a6%82%e7%8e%87%20p%20%e4%bd%8e%e4%ba%8e%e9%98%88%e5%80%bc%20%24%5cvarepsilon%24%20%ef%bc%8c%e9%82%a3%e4%b9%88%e5%88%99%e5%b0%86%e5%85%b6%e6%a0%87%e8%ae%b0%e4%b8%ba%e5%bc%82%e5%b8%b8%e3%80%82%0a%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e7%9a%84%e6%a0%b8%e5%bf%83%e5%b0%b1%e5%9c%a8%e4%ba%8e%e6%89%be%e5%88%b0%e4%b8%80%e4%b8%aa%e6%a6%82%e7%8e%87%e6%a8%a1%e5%9e%8b%ef%bc%8c%e5%b8%ae%e5%8a%a9%e6%88%91%e4%bb%ac%e7%9f%a5%e9%81%93%e4%b8%80%e4%b8%aa%e6%a0%b7%e6%9c%ac%e8%90%bd%e5%85%a5%e6%ad%a3%e5%b8%b8%e6%a0%b7%e6%9c%ac%e4%b8%ad%e7%9a%84%e6%a6%82%e7%8e%87%ef%bc%8c%e4%bb%8e%e8%80%8c%e5%b8%ae%e5%8a%a9%e6%88%91%e4%bb%ac%e5%8c%ba%e5%88%86%e6%ad%a3%e5%b8%b8%e5%92%8c%e5%bc%82%e5%b8%b8%e6%a0%b7%e6%9c%ac%e3%80%82%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%ef%bc%88Gaussian%20Distribution%ef%bc%89%e6%a8%a1%e5%9e%8b%e5%b0%b1%e6%98%af%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e7%ae%97%e6%b3%95%e6%9c%80%e5%b8%b8%e4%bd%bf%e7%94%a8%e7%9a%84%e6%a6%82%e7%8e%87%e5%88%86%e5%b8%83%e6%a8%a1%e5%9e%8b%e3%80%82%0a1.%20%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%20%e5%81%87%e5%a6%82%20x%20%e6%9c%8d%e4%bb%8e%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83%ef%bc%8c%e9%82%a3%e4%b9%88%e6%88%91%e4%bb%ac%e5%b0%86%e8%a1%a8%e7%a4%ba%e4%b8%ba%ef%bc%9a%20%24x%5csim%20N%28%5cmu%2c%5csigma%5e2%29%24%20%e3%80%82%e5%85%b6%e5%88%86%e5%b8%83%e6%a6%82%e7%8e%87%e4%b8%ba%ef%bc%9a%0a%24%24p%28x%3b%5cmu%2c%5csigma%5e2%29%3d%5cfrac%7b1%7d%7b%5csqrt%7b2%5cpi%7d%5csigma%7dexp%28-%5cfrac%7b%28x-%5cmu%29%5e2%7d%7b2%5csigma%5e2%7d%29%24%24%0a%e5%85%b6%e4%b8%ad%20%24%5cmu%24%20%e4%b8%ba%e6%9c%9f%e6%9c%9b%e5%80%bc%ef%bc%88%e5%9d%87%e5%80%bc%ef%bc%89%ef%bc%8c%20%24%5csigma%5e2%24%20%e4%b8%ba%e6%96%b9%e5%b7%ae%e3%80%82%0a%e5%85%b6%e4%b8%ad%ef%bc%8c%e6%9c%9f%e6%9c%9b%e5%80%bc%20%24%5cmu%24%20%e5%86%b3%e5%ae%9a%e4%ba%86%e5%85%b6%e8%bd%b4%e7%9a%84%e4%bd%8d%e7%bd%ae%ef%bc%8c%e6%a0%87%e5%87%86%e5%b7%ae%20%24%5csigma%24%20%e5%86%b3%e5%ae%9a%e4%ba%86%e5%88%86%e5%b8%83%e7%9a%84%e5%b9%85%e5%ba%a6%e5%ae%bd%e7%aa%84%e3%80%82%e5%bd%93%20%24%5cmu%3d0%2c%5csigma%3d1%24%20%e6%97%b6%e7%9a%84%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e6%98%af%e6%a0%87%e5%87%86%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e3%80%82%0a%e6%9c%9f%e6%9c%9b%e5%80%bc%ef%bc%9a%24%24%5cmu%3d%5cfrac%7b1%7d%7bm%7d%5csum_%7bi%3d1%7d%5e%7bm%7d%7bx%5e%7b%28i%29%7d%7d%24%24%0a%e6%96%b9%e5%b7%ae%ef%bc%9a%20%24%24%5csigma%5e2%3d%5cfrac%7b1%7d%7bm%7d%5csum_%7bi%3d1%7d%5e%7bm%7d%7b%28x%5e%7b%28i%29%7d-%5cmu%29%7d%5e2%24%24%0a%e5%81%87%e5%a6%82%e6%88%91%e4%bb%ac%e6%9c%89%e4%b8%80%e7%bb%84%20m%20%e4%b8%aa%e6%97%a0%e6%a0%87%e7%ad%be%e8%ae%ad%e7%bb%83%e9%9b%86%ef%bc%8c%e5%85%b6%e4%b8%ad%e6%af%8f%e4%b8%aa%e8%ae%ad%e7%bb%83%e6%95%b0%e6%8d%ae%e5%8f%88%e6%9c%89%20n%20%e4%b8%aa%e7%89%b9%e5%be%81%ef%bc%8c%e9%82%a3%e4%b9%88%e8%bf%99%e4%b8%aa%e8%ae%ad%e7%bb%83%e9%9b%86%e5%ba%94%e8%af%a5%e6%98%af%20m%20%e4%b8%aa%20n%20%e7%bb%b4%e5%90%91%e9%87%8f%e6%9e%84%e6%88%90%e7%9a%84%e6%a0%b7%e6%9c%ac%e7%9f%a9%e9%98%b5%e3%80%82"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnew.halfrost.com%2fanomaly_detection%2f&t=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e5%bc%82%e5%b8%b8%e6%a3%80%e6%b5%8b%e9%97%ae%e9%a2%98"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left><p class=copyright style=float:left;margin-bottom:0><a href=https://github.com/halfrost/Halfrost-Field class=github-repo style=height:18px><span class=gadget-github></span>Star</a>
Copyright &copy;halfrost 2016 - 2021
<a href=http://www.miit.gov.cn/>鄂ICP备16014744号</a></p><br><p class="copyright statistics" style=margin-bottom:20px><span id=busuanzi_container_site_pv>Cumulative Page Views <span id=busuanzi_value_site_pv></span>| Unique Visitors <span id=busuanzi_value_site_uv></span></span></p></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/main.min.f870a4d110314b9e50e65f8ac982dc1c9c376c8f1a5083d39c62cfc49073f011.js></script><script async src=/prism.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>